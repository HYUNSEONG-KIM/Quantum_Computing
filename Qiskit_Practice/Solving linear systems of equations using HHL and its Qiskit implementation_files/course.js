/* (c) Mathigon, generated by Mathigon Studio */
(()=>{var Ho=Object.defineProperty;var Wo=Object.getOwnPropertyDescriptor;var E=(t,e,i,s)=>{for(var n=s>1?void 0:s?Wo(e,i):e,r=t.length-1,o;r>=0;r--)(o=t[r])&&(n=(s?o(e,i,n):o(n))||n);return s&&n&&Ho(e,i,n),n};var Y=(t,e,i)=>new Promise((s,n)=>{var r=h=>{try{a(i.next(h))}catch(c){n(c)}},o=h=>{try{a(i.throw(h))}catch(c){n(c)}},a=h=>h.done?s(h.value):Promise.resolve(h.value).then(r,o);a((i=i.apply(t,e)).next())});function Ys(t=10){return Math.random().toString(36).substr(2,t)}function D(t,...e){return e.includes(t)}var Uo=(t,e)=>t.concat(e);function wi(t,e,i=Uo){for(let s of Object.keys(e))s in t&&Array.isArray(t[s])&&Array.isArray(e[s])?t[s]=i(t[s],e[s]):s in t&&t[s]instanceof Object&&e[s]instanceof Object?wi(t[s],e[s]):t[s]=e[s]}function $t(t,e=0){return e?+setTimeout(t,e):(t(),0)}function Js(t){return new Promise(e=>setTimeout(e,t))}function Rt(){let t=()=>{},e=()=>{},i=new Promise((s,n)=>{t=s,e=n});return i.catch(s=>s),{promise:i,resolve:t,reject:e}}function Dt(t,e=0,i=!1){let s=!1,n=!1;return(...r)=>{s?n=!0:(i?n=!0:t(...r),s=!0,setTimeout(()=>{n&&t(...r),s=n=!1},e))}}function zo(t){return function(e,i){if(!e||Array.isArray(this)||t.includes(e))return i}}function yi(t,e,i){if(!t)return e;try{return JSON.parse(t,i?zo(i):void 0)||e}catch(s){return e}}function bi(t,e){return new Array(e).fill(t)}function Zs(t,e,i){let s=[];for(let n=0;n<e;++n)s.push(bi(t,i));return s}function ae(t,e){let i=[];for(let s=0;s<e;++s)i.push(t(s));return i}function Qs(t,e,i){let s=[];for(let n=0;n<e;++n){let r=[];for(let o=0;o<i;++o)r.push(t(n,o));s.push(r)}return s}function ke(t,e,i=1){let s=[];if(e===void 0&&t>=0)for(let n=0;n<t;n+=i)s.push(n);else if(e===void 0)for(let n=0;n>t;n-=i)s.push(n);else if(t<=e)for(let n=t;n<=e;n+=i)s.push(n);else for(let n=t;n>=e;n-=i)s.push(n);return s}function z(t,e=0){return t[t.length-1-e]}function H(t){return t.reduce((e,i)=>e+i,0)}function tn(t,e,i=!1){return t.slice(0).sort((s,n)=>{let r=e(s),o=e(n);return r<o?i?1:-1:r>o?i?-1:1:0})}function Mt(t){let e=0;return()=>t[e++%t.length]}function xi(t){return t.filter((e,i)=>t.indexOf(e)===i)}function $i(t){return t.reduce((e,i)=>e.concat(Array.isArray(i)?$i(i):i),[])}function en(t){let e=0;return t.map(i=>e+=i)}function Mi(t,e){let i=[];for(let s=0;s<t.length;s+=e)i.push(t.slice(s,s+e));return i}function V(t,e=/\s+/){return t?t.trim().split(e):[]}function Ae(t){return t.toLowerCase().replace(/^-/,"").replace(/-(.)/g,(e,i)=>i.toUpperCase())}var Ct=class{constructor(){this.events=new Map}on(t,e){for(let i of V(t))this.events.has(i)||this.events.set(i,[]),this.events.get(i).push(e)}one(t,e){let i=s=>{this.off(t,i),e(s)};this.on(t,i)}off(t,e){for(let i of V(t))this.events.has(i)&&this.events.set(i,this.events.get(i).filter(s=>s!==e))}trigger(t,e){for(let i of V(t))if(this.events.has(i))for(let s of this.events.get(i))s(e)}};var Te=class{constructor(...t){this.values=t}map(t){let e=this.values;return new Te(function*(){let i=0;for(let s of e)for(let n of s)yield t(n,i),i+=1}())}every(t){let e=0;for(let i of this.values)for(let s of i){if(!t(s,e))return!1;e+=1}return!0}some(t){let e=0;for(let i of this.values)for(let s of i){if(t(s,e))return!0;e+=1}return!1}slice(t,e){let i=this.values;return new Te(function*(){let s=0;for(let n of i)for(let r of n)s<t||e!==void 0&&s>t+e||(yield r,s+=1)}())}filter(t){let e=this.values;return new Te(function*(){let i=0;for(let s of e)for(let n of s)t(n,i)&&(yield n),i+=1}())}concat(t){this.values.push(t)}[Symbol.iterator](){let t=this.values;return function*(){for(let e of t)for(let i of e)yield i}()}static make(t,e){return new Te(function*(){let i=0;for(;e===void 0||i<e;)yield t(i),i+=1}())}};var jo=Object.defineProperty,Ci=(t,e)=>{for(var i in e)jo(t,i,{get:e[i],enumerable:!0})},sn=1e-6;function k(t,e,i=sn){return isNaN(t)||isNaN(e)?!1:Math.abs(t-e)<i}function B(t,e,i,s=sn){return e>i&&([e,i]=[i,e]),t>e+s&&t<i-s}var Xo=/^-?0,[0-9]+$/,Go=/^-?([0-9]+(,[0-9]{3})*)?\.?[0-9]*$/,Ko=/^-?[0-9]+(\.[0-9]{3})*,?[0-9]*$/;function nn(t){return t=t.replace(/^â€“/,"-").trim(),!t||t.match(/[^0-9.,-]/)?NaN:Xo.test(t)?parseFloat(t.replace(/,/,".")):Go.test(t)?parseFloat(t.replace(/,/g,"")):Ko.test(t)?parseFloat(t.replace(/\./g,"").replace(/,/,".")):NaN}var Ei=["","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen"],rn=["","","twenty","thirty","forty","fifty","sixty","seventy","eighty","ninety"],Yo=[""," thousand"," million"," billion"," trillion"," quadrillion"," quintillion"," sextillion"];function Jo(t){let[e,i,s]=t.split(""),n=e==="0"?"":` ${Ei[+e]} hundred`;return i+s==="00"?n:+i<2?`${n} ${Ei[+(i+s)]}`:s==="0"?`${n} ${rn[+i]}`:`${n} ${rn[+i]}-${Ei[+s]}`}function Si(t){if(t===0)return"zero";let e=Math.round(Math.abs(t)).toString(),i=Math.ceil(e.length/3),s=e.padStart(3*i,"0"),n="";for(let r=0;r<i;r+=1){let o=s.substr(r*3,3);o!=="000"&&(n+=Jo(o)+Yo[i-1-r])}return n.trim()}function ki(t,e=0){let i=Math.pow(10,e);return Math.round(t*i)/i}function ft(t,e=1){return Math.round(t/e)*e}function q(t,e=-Infinity,i=Infinity){return Math.min(i,Math.max(e,t))}function Ai(t,e,i=.5){return t+(e-t)*i}function W(t){return t*t}function on(t,e){return(t%e+e)%e}function hn(t,e=0){let i=t.slice(0),s=an(i);return e?s.filter(n=>n.length===e):s}function an(t){if(t.length===1)return[[],t];let e=t.pop(),i=an(t),s=[];for(let n of i)s.push(n,[...n,e]);return s}var Zo={};Ci(Zo,{determinant:()=>sa,fill:()=>cn,identity:()=>ln,inverse:()=>dn,product:()=>_e,reflection:()=>ea,rotation:()=>Qo,scalarProduct:()=>ia,shear:()=>ta,sum:()=>un,transpose:()=>fn});function cn(t,e,i){return Zs(t,e,i)}function ln(t=2){let e=cn(0,t,t);for(let i=0;i<t;++i)e[i][i]=1;return e}function Qo(t){let e=Math.sin(t),i=Math.cos(t);return[[i,-e],[e,i]]}function ta(t){return[[1,t],[0,1]]}function ea(t){let e=Math.sin(2*t),i=Math.cos(2*t);return[[i,e],[e,-i]]}function un(...t){let[e,...i]=t,s=i.length>1?un(...i):i[0];if(e.length!==s.length||e[0].length!==s[0].length)throw new Error("Matrix sizes don\u2019t match");let n=[];for(let r=0;r<e.length;++r){let o=[];for(let a=0;a<e[r].length;++a)o.push(e[r][a]+s[r][a]);n.push(o)}return n}function ia(t,e){return t.map(i=>i.map(s=>s*e))}function _e(...t){let[e,...i]=t,s=i.length>1?_e(...i):i[0];if(e[0].length!==s.length)throw new Error("Matrix sizes don\u2019t match.");let n=[];for(let r=0;r<e.length;++r){let o=[];for(let a=0;a<s[0].length;++a){let h=0;for(let c=0;c<s.length;++c)h+=e[r][c]*s[c][a];o.push(h)}n.push(o)}return n}function fn(t){let e=[];for(let i=0;i<t[0].length;++i){let s=[];for(let n=0;n<t.length;++n)s.push(t[n][i]);e.push(s)}return e}function sa(t){if(t.length!==t[0].length)throw new Error("Not a square matrix.");let e=t.length;if(e===1)return t[0][0];if(e===2)return t[0][0]*t[1][1]-t[0][1]*t[1][0];let i=0;for(let s=0;s<e;++s){let n=t[0][s],r=t[0][s];for(let o=1;o<e;++o)r*=t[o][(s+o)%e],n*=t[o][(s-o+e)%e];i+=r-n}return i}function dn(t){let e=t.length;if(e!==t[0].length)throw new Error("Not a square matrix.");let i=ln(e),s=Qs((n,r)=>t[n][r],e,e);for(let n=0;n<e;++n){let r=s[n][n];if(k(r,0)){for(let o=n+1;o<e;++o)if(s[o][n]!==0){for(let a=0;a<e;++a)[s[o][a],s[n][a]]=[s[n][a],s[o][a]],[i[o][a],i[n][a]]=[i[n][a],i[o][a]];break}if(r=s[n][n],k(r,0))throw new Error("Matrix not invertible.")}for(let o=0;o<e;++o)s[n][o]=s[n][o]/r,i[n][o]=i[n][o]/r;for(let o=0;o<e;++o){if(o===n)continue;let a=s[o][n];for(let h=0;h<e;++h)s[o][h]-=a*s[n][h],i[o][h]-=a*i[n][h]}}return i}var j={};Ci(j,{bernoulli:()=>mn,binomial:()=>ha,cauchy:()=>pa,chiCDF:()=>ga,exponential:()=>fa,find:()=>oa,geometric:()=>da,integer:()=>ra,integrate:()=>gn,normal:()=>ua,normalPDF:()=>ma,poisson:()=>ca,shuffle:()=>na,smart:()=>aa,uniform:()=>la,weighted:()=>pn});function na(t){t=t.slice(0);for(let e=t.length-1;e>0;--e){let i=Math.floor(Math.random()*(e+1));[t[e],t[i]]=[t[i],t[e]]}return t}function ra(t,e){let i=e===void 0?0:t,s=e===void 0?t:e-t+1;return i+Math.floor(s*Math.random())}function pn(t){let e=Math.random()*H(t),i=0;return t.findIndex(s=>(i+=s)>=e)}function oa(t){return t[Math.floor(t.length*Math.random())]}var Pe=new Map;function aa(t,e){e||(e=Ys()),Pe.has(e)||Pe.set(e,bi(1,t));let i=Pe.get(e),s=pn(i.map(n=>n*n));return i[s]-=1,i[s]<=0&&Pe.set(e,i.map(n=>n+1)),s}function mn(t=.5){return Math.random()<t?1:0}function ha(t=1,e=.5){let i=0;for(let s=0;s<t;++s)i+=mn(e);return i}function ca(t=1){if(t<=0)return 0;let e=Math.exp(-t),i=1,s=0;for(;i>e;++s)i*=Math.random();return s-1}function la(t=0,e=1){return t+(e-t)*Math.random()}function ua(t=0,e=1){let i=Math.random(),s=Math.random();return Math.sqrt(-2*Math.log(i))*Math.cos(2*Math.PI*s)*Math.sqrt(e)+t}function fa(t=1){return t<=0?0:-Math.log(Math.random())/t}function da(t=.5){if(!(t<=0||t>1))return Math.floor(Math.log(Math.random())/Math.log(1-t))}function pa(){let t,e,i;do e=2*Math.random()-1,i=2*Math.random()-1,t=e*e+i*i;while(t>=1);return e/i}function ma(t,e=1,i=0){return Math.exp(-((t-e)**2)/(2*i))/Math.sqrt(2*Math.PI*i)}var vn=7,wn=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23];function yn(t){if(t<.5)return Math.PI/(Math.sin(Math.PI*t)*yn(1-t));t-=1;let e=wn[0];for(let s=1;s<vn+2;s++)e+=wn[s]/(t+s);let i=t+vn+.5;return Math.sqrt(2*Math.PI)*Math.pow(i,t+.5)*Math.exp(-i)*e}function gn(t,e,i,s=1){let n=0;for(let r=e;r<i;r+=s)n+=t(r)*s||0;return n}function ga(t,e){let i=gn(s=>Math.pow(s,(e-2)/2)*Math.exp(-s/2),0,t);return 1-i/Math.pow(2,e/2)/yn(e/2)}var va={};Ci(va,{bestPolynomial:()=>$a,coefficient:()=>xn,exponential:()=>ya,linear:()=>wa,logarithmic:()=>ba,polynomial:()=>bn,power:()=>xa});function Ma(t,e){let i=1,s=t[0];for(let n=1;n<t.length;++n)i*=e,s+=i*t[n];return s}function wa(t,e=!1){let i=0,s=0,n=0,r=0,o=t.length;for(let c=0;c<o;c++)i+=t[c][0],s+=t[c][1],n+=t[c][0]*t[c][0],r+=t[c][0]*t[c][1];if(e){let c=r/n;return[0,c]}let a=(o*r-i*s)/(o*n-i*i);return[s/o-a*i/o,a]}function ya(t){let e=[0,0,0,0,0,0];for(let r of t)e[0]+=r[0],e[1]+=r[1],e[2]+=r[0]*r[0]*r[1],e[3]+=r[1]*Math.log(r[1]),e[4]+=r[0]*r[1]*Math.log(r[1]),e[5]+=r[0]*r[1];let i=e[1]*e[2]-e[5]*e[5],s=Math.exp((e[2]*e[3]-e[5]*e[4])/i),n=(e[1]*e[4]-e[5]*e[3])/i;return[s,n]}function ba(t){let e=[0,0,0,0],i=t.length;for(let r of t)e[0]+=Math.log(r[0]),e[1]+=r[1]*Math.log(r[0]),e[2]+=r[1],e[3]+=Math.pow(Math.log(r[0]),2);let s=(i*e[1]-e[2]*e[0])/(i*e[3]-e[0]*e[0]);return[(e[2]-s*e[0])/i,s]}function xa(t){let e=[0,0,0,0],i=t.length;for(let r of t)e[0]+=Math.log(r[0]),e[1]+=Math.log(r[1])*Math.log(r[0]),e[2]+=Math.log(r[1]),e[3]+=Math.pow(Math.log(r[0]),2);let s=(i*e[1]-e[2]*e[0])/(i*e[3]-e[0]*e[0]);return[Math.exp((e[2]-s*e[0])/i),s]}function bn(t,e=2){let i=t.map(h=>ke(e+1).map(c=>Math.pow(h[0],c))),s=fn(i),n=t.map(h=>[h[1]]),r=_e(s,i),o=dn(r);return _e(o,s,n).map(h=>h[0])}function xn(t,e){let s=t.reduce((o,a)=>o+a[1],0)/t.length,n=t.reduce((o,a)=>o+(a[1]-s)**2,0),r=t.reduce((o,a)=>o+(a[1]-e(a[0]))**2,0);return 1-r/n}function $a(t,e=.85,i=8){if(!(t.length<=1))for(let s=1;s<i;++s){let n=bn(t,s),r=a=>Ma(n,a);if(xn(t,r)>=e)return{order:s,coefficients:n,fn:r}}}var Ie=2*Math.PI;function $n(t,e){let i=Math.atan2(t.y-(e?e.y:0),t.x-(e?e.x:0));return on(i,Ie)}function Mn(t,e){let i,s=Infinity,n=-1;for(let[r,o]of e.entries()){let a=o.project(t),h=u.distance(t,a);h<s&&(i=a,s=h,n=r)}return i?[i,n]:void 0}var u=class{constructor(t=0,e=0){this.x=t,this.y=e,this.type="point"}get unitVector(){return k(this.length,0)?new u(1,0):this.scale(1/this.length)}get length(){return Math.sqrt(this.x**2+this.y**2)}get inverse(){return new u(-this.x,-this.y)}get flip(){return new u(this.y,this.x)}get perpendicular(){return new u(-this.y,this.x)}get array(){return[this.x,this.y]}distanceFromLine(t){return u.distance(this,t.project(this))}clamp(t,e=0){let i=q(this.x,t.xMin+e,t.xMax-e),s=q(this.y,t.yMin+e,t.yMax-e);return new u(i,s)}changeCoordinates(t,e){let i=e.xMin+(this.x-t.xMin)/t.dx*e.dx,s=e.yMin+(this.y-t.yMin)/t.dy*e.dy;return new u(i,s)}add(t){return u.sum(this,t)}subtract(t){return u.difference(this,t)}round(t=1){return new u(ft(this.x,t),ft(this.y,t))}floor(){return new u(Math.floor(this.x),Math.floor(this.y))}mod(t,e=t){return new u(this.x%t,this.y%e)}angle(t=Ft){return $n(this,t)}snap(t,e=5){return k(this.x,t.x,e)?new u(t.x,this.y):k(this.y,t.y,e)?new u(this.x,t.y):this}static average(...t){let e=H(t.map(s=>s.x))/t.length,i=H(t.map(s=>s.y))/t.length;return new u(e,i)}static dot(t,e){return t.x*e.x+t.y*e.y}static sum(t,e){return new u(t.x+e.x,t.y+e.y)}static difference(t,e){return new u(t.x-e.x,t.y-e.y)}static distance(t,e){return Math.sqrt(W(t.x-e.x)+W(t.y-e.y))}static manhattan(t,e){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)}static interpolate(t,e,i=.5){return new u(Ai(t.x,e.x,i),Ai(t.y,e.y,i))}static interpolateList(t,e=.5){let i=t.length-1,s=Math.floor(q(e,0,1)*i);return u.interpolate(t[s],t[s+1],i*e-s)}static fromPolar(t,e=1){return new u(e*Math.cos(t),e*Math.sin(t))}static random(t){let e=j.uniform(t.xMin,t.xMax),i=j.uniform(t.yMin,t.yMax);return new u(e,i)}static equals(t,e,i){return k(t.x,e.x,i)&&k(t.y,e.y,i)}static colinear(t,e,i,s){let n=t.x-e.x,r=t.y-e.y,o=e.x-i.x,a=e.y-i.y;return k(n*a,o*r,s)}transform(t){let e=t[0][0]*this.x+t[0][1]*this.y+t[0][2],i=t[1][0]*this.x+t[1][1]*this.y+t[1][2];return new u(e,i)}rotate(t,e=Ft){if(k(t,0))return this;let i=this.x-e.x,s=this.y-e.y,n=Math.cos(t),r=Math.sin(t),o=i*n-s*r+e.x,a=i*r+s*n+e.y;return new u(o,a)}reflect(t){let e=t.p2.x-t.p1.x,i=t.p2.y-t.p1.y,s=this.x-t.p1.x,n=this.y-t.p1.y,r=(e*n-i*s)/(e*e+i*i),o=this.x+2*r*i,a=this.y-2*r*e;return new u(o,a)}scale(t,e=t){return new u(this.x*t,this.y*e)}shift(t,e=t){return new u(this.x+t,this.y+e)}translate(t){return this.shift(t.x,t.y)}equals(t,e){return u.equals(this,t,e)}toString(){return`point(${this.x},${this.y})`}},Ft=new u(0,0),dt=class{constructor(t,e){this.p1=t,this.p2=e,this.type="line"}make(t,e){return new dt(t,e)}get length(){return u.distance(this.p1,this.p2)}get lengthSquared(){return(this.p1.x-this.p2.x)**2+(this.p1.y-this.p2.y)**2}get midpoint(){return u.average(this.p1,this.p2)}get slope(){return(this.p2.y-this.p1.y)/(this.p2.x-this.p1.x)}get intercept(){return this.p1.y-this.slope*this.p1.x}get angle(){return $n(this.p2,this.p1)}get unitVector(){return this.p2.subtract(this.p1).unitVector}get perpendicularVector(){return new u(this.p2.y-this.p1.y,this.p1.x-this.p2.x).unitVector}parallel(t){let e=u.sum(t,u.difference(this.p2,this.p1));return new dt(t,e)}perpendicular(t){return new dt(t,u.sum(t,this.perpendicularVector))}get perpendicularBisector(){return this.perpendicular(this.midpoint)}distanceSquared(t){let e=this.project(t);return(t.x-e.x)**2+(t.y-e.y)**2}offset(t){let e=u.difference(this.p2,this.p1),i=u.difference(t,this.p1);return u.dot(e,i)/this.lengthSquared}project(t){return this.at(this.offset(t))}side(t,e){let i=u.difference(this.p2,this.p1),s=u.difference(t,this.p1),n=s.x*i.y-s.y*i.x;return k(n,0,e)?0:Math.sign(n)}contains(t,e){return this.side(t,e)===0}at(t){return u.interpolate(this.p1,this.p2,t)}transform(t){return new this.constructor(this.p1.transform(t),this.p2.transform(t))}rotate(t,e=Ft){return k(t,0)?this:new this.constructor(this.p1.rotate(t,e),this.p2.rotate(t,e))}reflect(t){return new this.constructor(this.p1.reflect(t),this.p2.reflect(t))}scale(t,e=t){return this.make(this.p1.scale(t,e),this.p2.scale(t,e))}shift(t,e=t){return this.make(this.p1.shift(t,e),this.p2.shift(t,e))}translate(t){return this.shift(t.x,t.y)}equals(t,e){return this.contains(t.p1,e)&&this.contains(t.p2,e)}toString(){return`line(${this.p1},${this.p2})`}};var he=class extends dt{constructor(){super(...arguments);this.type="segment"}contains(t,e){return dt.prototype.contains.call(this,t,e)?this.p1.equals(t,e)||this.p2.equals(t,e)?!0:k(this.p1.x,this.p2.x,e)?B(t.y,this.p1.y,this.p2.y):B(t.x,this.p1.x,this.p2.x):!1}make(t,e){return new he(t,e)}project(t){let e=u.difference(this.p2,this.p1),i=u.difference(t,this.p1),s=q(u.dot(e,i)/this.lengthSquared,0,1);return u.sum(this.p1,e.scale(s))}contract(t){return new he(this.at(t),this.at(1-t))}equals(t,e,i=!1){return t.type!=="segment"?!1:this.p1.equals(t.p1,e)&&this.p2.equals(t.p2,e)||!i&&this.p1.equals(t.p2,e)&&this.p2.equals(t.p1,e)}toString(){return`segment(${this.p1},${this.p2})`}};var Et=1e-6;function Ti(t,e,i){let s=(i.x-e.x)*(t.y-e.y),n=(i.y-e.y)*(t.x-e.x);return s-n>=-Et}function Cn(t,e,i){let s=t.y-e.y,n=i.x-e.x,r=t.x-e.x,o=i.y-e.y,a=r*n+s*o;if(a<Et)return!1;let h=n*n+o*o;return a-h<=-Et}function En(t,e){return k(t.x,e.x)?k(t.y,e.y)?0:t.y<e.y?-1:1:t.x<e.x?-1:1}function Sn(t){return t<=-Et?-2:t<Et?-1:t-1<=-Et?0:t-1<Et?1:2}function Ca(t,e,i,s){let n=e.x-t.x,r=e.y-t.y,o=s.x-i.x,a=s.y-i.y,h=n*a-r*o;if(k(h,0))return!1;let c=t.x-i.x,p=t.y-i.y,f=(o*p-a*c)/h,d=(n*p-r*c)/h,x=new u(t.x+f*n,t.y+f*r);return{alongA:Sn(f),alongB:Sn(d),pt:x}}var Ht=class{constructor(){this.root={root:!0,next:void 0}}exists(t){return t!==void 0&&t!==this.root}get head(){return this.root.next}insertBefore(t,e){let i=this.root,s=this.root.next;for(;s;){if(e(s)){t.prev=s.prev,t.next=s,s.prev.next=t,s.prev=t;return}i=s,s=s.next}i.next=t,t.prev=i,t.next=void 0}findTransition(t){let e=this.root,i=this.root.next;for(;i&&!t(i);)e=i,i=i.next;return{before:e===this.root?void 0:e,after:i,insert:s=>(s.prev=e,s.next=i,e.next=s,i&&(i.prev=s),s)}}static node(t){let e=t;return e.remove=()=>{e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e.prev=e.next=void 0},e}};function _i(t,e,i){let s={above:i.myFill.above,below:i.myFill.below};return{start:t,end:e,myFill:s}}function Ea(t,e,i,s,n,r){let o=En(e,n);return o!==0?o:u.equals(i,r)?0:t!==s?t?1:-1:Ti(i,s?n:r,s?r:n)?1:-1}function Pi(t,e,i){t.insertBefore(e,s=>Ea(!!e.isStart,e.pt,i,!!s.isStart,s.pt,s.other.pt)<0)}function Sa(t,e,i){let s=Ht.node({isStart:!0,pt:e.start,seg:e,primary:i});return Pi(t,s,e.end),s}function ka(t,e,i,s){let n=Ht.node({pt:i.end,seg:i,primary:s,other:e});e.other=n,Pi(t,n,e.pt)}function Oe(t,e,i){let s=Sa(t,e,i);return ka(t,s,e,i),s}function Aa(t,e,i){e.other.remove(),e.seg.end=i,e.other.pt=i,Pi(t,e.other,e.pt)}function J(t,e,i){let s=_i(i,e.seg.end,e.seg);return Aa(t,e,i),Oe(t,s,!!e.primary)}function Ta(t,e){let i=t.seg.start,s=t.seg.end,n=e.seg.start,r=e.seg.end;return u.colinear(i,n,r)?u.colinear(s,n,r)||Ti(s,n,r)?1:-1:Ti(i,n,r)?1:-1}function Ii(t,e,i){let s=e.seg,n=i.seg,r=s.start,o=s.end,a=n.start,h=n.end,c=Ca(r,o,a,h);if(c===!1){if(!u.colinear(r,o,a)||u.equals(r,h)||u.equals(o,a))return!1;let p=u.equals(r,a),f=u.equals(o,h);if(p&&f)return i;let d=!p&&Cn(r,a,h),x=!f&&Cn(o,a,h);if(p)return x?J(t,i,o):J(t,e,h),i;d&&(f||(x?J(t,i,o):J(t,e,h)),J(t,i,r))}else c.alongA===0&&(c.alongB===-1?J(t,e,a):c.alongB===0?J(t,e,c.pt):c.alongB===1&&J(t,e,h)),c.alongB===0&&(c.alongA===-1?J(t,i,r):c.alongA===0?J(t,i,c.pt):c.alongA===1&&J(t,i,o));return!1}function kn(t,e){var i,s;let n=new Ht,r=[];for(;t.head;){let o=t.head;if(o.isStart){let a=function(){if(c){let d=Ii(t,o,c);if(d)return d}return p?Ii(t,o,p):!1},h=n.findTransition(d=>Ta(o,d.ev)>0),c=(i=h.before)==null?void 0:i.ev,p=(s=h.after)==null?void 0:s.ev,f=a();if(f&&(e?(o.seg.myFill.below?o.seg.myFill.above!==o.seg.myFill.below:!0)&&(f.seg.myFill.above=!f.seg.myFill.above):f.seg.otherFill=o.seg.myFill,o.other.remove(),o.remove()),t.head!==o)continue;if(e){let d=o.seg.myFill.below?o.seg.myFill.above!==o.seg.myFill.below:!0;o.seg.myFill.below=p?p.seg.myFill.above:!1,o.seg.myFill.above=d?!o.seg.myFill.below:o.seg.myFill.below}else if(o.seg.otherFill===void 0){let d=p?o.primary===p.primary?p.seg.otherFill.above:p.seg.myFill.above:!1;o.seg.otherFill={above:d,below:d}}o.other.status=h.insert(Ht.node({ev:o}))}else{let a=o.status;if(a===void 0)throw new Error("[Euclid.js] Zero-length segment detected!");if(n.exists(a.prev)&&n.exists(a.next)&&Ii(t,a.prev.ev,a.next.ev),a.remove(),!o.primary){let h=o.seg.myFill;o.seg.myFill=o.seg.otherFill,o.seg.otherFill=h}r.push(o.seg)}t.head.remove()}return r}function _a(t){let e=[],i=[];return t.forEach(s=>{let n=s.start,r=s.end;if(u.equals(n,r))return;let o={index:0,matchesHead:!1,matchesPt1:!1},a={index:0,matchesHead:!1,matchesPt1:!1},h=o;function c(l,g,w){h.index=l,h.matchesHead=g,h.matchesPt1=w;let y=h===o;return h=y?a:void 0,!y}for(let l=0;l<e.length;l++){let g=e[l],w=g[0],y=z(g);if(u.equals(w,n)){if(c(l,!0,!0))break}else if(u.equals(w,r)){if(c(l,!0,!1))break}else if(u.equals(y,n)){if(c(l,!1,!0))break}else if(u.equals(y,r)&&c(l,!1,!1))break}if(h===o){e.push([n,r]);return}if(h===a){let l=o.index,g=o.matchesPt1?r:n,w=o.matchesHead,y=e[l],v=w?y[0]:y[y.length-1],b=w?y[1]:y[y.length-2],L=w?y[y.length-1]:y[0],K=w?y[y.length-2]:y[1];if(u.colinear(b,v,g)&&(w?y.shift():y.pop(),v=b),u.equals(L,g)){e.splice(l,1),u.colinear(K,L,v)&&(w?y.pop():y.shift()),i.push(y);return}w?y.unshift(g):y.push(g);return}function p(l){e[l].reverse()}function f(l,g){let w=e[l],y=e[g],v=w[w.length-1],b=w[w.length-2],L=y[0],K=y[1];u.colinear(b,v,L)&&(w.pop(),v=b),u.colinear(v,L,K)&&y.shift(),e[l]=w.concat(y),e.splice(g,1)}let d=o.index,x=a.index,A=e[d].length<e[x].length;o.matchesHead?a.matchesHead?A?(p(d),f(d,x)):(p(x),f(x,d)):f(x,d):a.matchesHead?f(d,x):A?(p(d),f(x,d)):(p(x),f(d,x))}),i}function Pa(t,e){let i=[];for(let s of t){let n=(s.myFill.above?8:0)+(s.myFill.below?4:0)+(s.otherFill&&s.otherFill.above?2:0)+(s.otherFill&&s.otherFill.below?1:0);e[n]!==0&&i.push({start:s.start,end:s.end,myFill:{above:e[n]===1,below:e[n]===2}})}return i}function An(t){let e=new Ht;for(let i of t)for(let s=0;s<i.length;s++){let n=s?i[s-1]:z(i),r=i[s],o=En(n,r);if(o===0)continue;let a=o<0?n:r,h=o<0?r:n;Oe(e,{start:a,end:h,myFill:{}},!0)}return kn(e,!0)}function Oi(t,e,i){let s=new Ht;for(let r of An(t))Oe(s,_i(r.start,r.end,r),!0);for(let r of An(e))Oe(s,_i(r.start,r.end,r),!1);let n=Pa(kn(s,!1),i);return _a(n)}var Ia=[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],Oa=[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],La=[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],Va=(t,e)=>Oi(t,e,Ia),Na=(t,e)=>Oi(t,e,Oa),Ba=(t,e)=>Oi(t,e,La);function Li(t){return["polygon","polyline","rectangle","triangle"].includes(t.type)}function qa(t){return["polygon","triangle"].includes(t.type)}function Tn(t){return t.type==="polyline"}function Ra(t){return t.type==="rectangle"}function ce(t){return["line","ray","segment"].includes(t.type)}function Da(t){return t.type==="line"}function _n(t){return t.type==="ray"}function Vi(t){return t.type==="segment"}function Wt(t){return t.type==="circle"}function Fa(t){return t.type==="ellipse"}function Le(t){return t.type==="arc"}function Ha(t){return t.type==="sector"}function Ve(t){return t.type==="angle"}function Wa(t,e){return k(t.p1.x,t.p2.x)?B(e.y,t.p1.y,t.p2.y):B(e.x,t.p1.x,t.p2.x)}function Ua(t,e){return k(t.p1.x,t.p2.x)?(e.y-t.p1.y)/(t.p2.y-t.p1.y)>0:(e.x-t.p1.x)/(t.p2.x-t.p1.x)>0}function za(t,e){return B(t.offset(e),0,1)}function ja(t,e){let i=t.p1.x-t.p2.x,s=t.p1.y-t.p2.y,n=e.p1.x-e.p2.x,r=e.p1.y-e.p2.y,o=i*r-s*n;if(k(o,0))return[];let a=t.p1.x*t.p2.y-t.p1.y*t.p2.x,h=e.p1.x*e.p2.y-e.p1.y*e.p2.x,c=a*n-i*h,p=a*r-s*h;return[new u(c/o,p/o)]}function Xa(t,e){let i=u.distance(t.c,e.c);if(i>t.r+e.r)return[];if(i<Math.abs(t.r-e.r))return[];if(k(i,0)&&k(t.r,e.r))return[];if(k(i,t.r+e.r))return[new dt(t.c,e.c).midpoint];let s=(W(t.r)-W(e.r)+W(i))/(2*i),n=Math.sqrt(W(t.r)-W(s)),r=(e.c.x-t.c.x)*s/i+(e.c.y-t.c.y)*n/i+t.c.x,o=(e.c.y-t.c.y)*s/i-(e.c.x-t.c.x)*n/i+t.c.y,a=(e.c.x-t.c.x)*s/i-(e.c.y-t.c.y)*n/i+t.c.x,h=(e.c.y-t.c.y)*s/i+(e.c.x-t.c.x)*n/i+t.c.y;return[new u(r,o),new u(a,h)]}function Pn(t,e){let i=t.p2.x-t.p1.x,s=t.p2.y-t.p1.y,n=W(i)+W(s),r=e.c.x,o=e.c.y,a=(t.p1.x-r)*(t.p2.y-o)-(t.p2.x-r)*(t.p1.y-o),h=W(e.r)*n-W(a);if(h<0)return[];let c=a*s/n,p=-a*i/n;if(k(h,0))return[e.c.shift(c,p)];let f=i*(s<0?-1:1)*Math.sqrt(h)/n,d=Math.abs(s)*Math.sqrt(h)/n;return[e.c.shift(c+f,p+d),e.c.shift(c-f,p-d)]}function Ga(t,e){let i=[],s=Le(t)?t.circle:t,n=Le(e)?e.circle:e;ce(t)&&ce(e)?i=ja(t,e):ce(s)&&Wt(n)?i=Pn(s,n):Wt(s)&&ce(n)?i=Pn(n,s):Wt(s)&&Wt(n)&&(i=Xa(s,n));for(let r of[t,e])Vi(r)&&(i=i.filter(o=>Wa(r,o))),_n(r)&&(i=i.filter(o=>Ua(r,o))),Le(r)&&(i=i.filter(o=>za(r,o)));return i}function pt(...t){if(t.length<2)return[];if(t.length>2)return $i(hn(t,2).map(s=>pt(...s)));let[e,i]=t;if(Ve(e)&&(e=e.shape(!0)),Ve(i)&&(i=i.shape(!0)),Li(i)&&([e,i]=[i,e]),Li(e)){let s=ce(i)?e.points.filter(n=>i.contains(n)):[];for(let n of e.edges)s.push(...pt(n,i));return s}return Ga(e,i)}var mt=class{constructor(...t){this.type="polygon",this.points=t}get circumference(){if(this.points.length<=1)return 0;let t=u.distance(this.points[0],z(this.points));for(let e=1;e<this.points.length;++e)t+=u.distance(this.points[e-1],this.points[e]);return t}get signedArea(){let t=this.points,e=t.length,i=t[e-1].x*t[0].y-t[0].x*t[e-1].y;for(let s=1;s<e;++s)i+=t[s-1].x*t[s].y-t[s].x*t[s-1].y;return i/2}get area(){return Math.abs(this.signedArea)}get centroid(){let t=this.points,e=t.length,i=0;for(let n=0;n<e;++n)i+=t[n].x;let s=0;for(let n=0;n<e;++n)s+=t[n].y;return new u(i/e,s/e)}get edges(){let t=this.points.length,e=[];for(let i=0;i<t;++i)e.push(new he(this.points[i],this.points[(i+1)%t]));return e}get radius(){let t=this.centroid,e=this.points.map(i=>u.distance(i,t));return Math.max(...e)}get oriented(){if(this.signedArea>=0)return this;let t=[...this.points].reverse();return new this.constructor(...t)}cut(t){let e=this.radius/t.length*10,i=t.at(-e),s=t.at(e),n=t.perpendicularVector.scale(t.length*e),r=[i,s,s.add(n),i.add(n)],o=Na([this.points],[r]),a=Ba([this.points],[r]);return[...o,...a].map(h=>new mt(...h))}static collision(t,e){if(t.points.some(i=>e.contains(i))||e.points.some(i=>t.contains(i)))return!0;for(let i of t.edges)for(let s of e.edges)if(pt(i,s)[0])return!0;return!1}static union(...t){let[e,...i]=t;if(!i.length)return[e];let s=[e.points],n=i.length>1?mt.union(...i).map(r=>r.points):[t[1].points];return Va(s,n).map(r=>new mt(...r))}static regular(t,e=1){let i=Ie/t,s=Math.PI/2-i/2,n=ae(r=>u.fromPolar(s+i*r,e),t);return new mt(...n)}static interpolate(t,e,i=.5){let s=t.points.map((n,r)=>u.interpolate(n,e.points[r],i));return new mt(...s)}static convexHull(...t){if(t.length<=3)return new mt(...t);let e=t.sort((r,o)=>r.x!==o.x?r.x-o.x:r.y-o.y),i=e.slice(0).reverse(),s=[],n=[];for(let[r,o]of[[e,s],[i,n]]){for(let a of r){for(;o.length>=2;){let h=o[o.length-1],c=o[o.length-2];if((h.x-c.x)*(a.y-c.y)>=(a.x-c.x)*(h.y-c.y))o.pop();else break}o.push(a)}o.pop()}return new mt(...s.concat(n))}contains(t){let e=!1;for(let i of this.edges){if(i.p1.equals(t)||i.contains(t))return!1;if(i.p1.y>t.y==i.p2.y>t.y)continue;let s=(i.p2.x-i.p1.x)/(i.p2.y-i.p1.y);t.x<s*(t.y-i.p1.y)+i.p1.x&&(e=!e)}return e}at(t){t<0&&(t+=Math.floor(t));let e=t*this.circumference,i=0;for(let s of this.edges){let n=s.length;if(i+n>e)return s.at((e-i)/n);i+=n}return this.points[0]}offset(t){let e=this.edges,i=Mn(t,this.edges)||[this.points[0],0],s=0;for(let n=0;n<i[1];++n)s+=e[n].length;return s+=e[i[1]].offset(t)*e[i[1]].length,s/this.circumference}project(t){let e=Mn(t,this.edges);return e?e[0]:this.points[0]}centerAt(t=Ft){return this.translate(t.subtract(this.centroid))}transform(t){return new this.constructor(...this.points.map(e=>e.transform(t)))}rotate(t,e=Ft){if(k(t,0))return this;let i=this.points.map(s=>s.rotate(t,e));return new this.constructor(...i)}reflect(t){let e=this.points.map(i=>i.reflect(t));return new this.constructor(...e)}scale(t,e=t){let i=this.points.map(s=>s.scale(t,e));return new this.constructor(...i)}shift(t,e=t){let i=this.points.map(s=>s.shift(t,e));return new this.constructor(...i)}translate(t){return this.shift(t.x,t.y)}equals(t,e,i){let s=this.points.length;if(s!==t.points.length)return!1;let n=i?this:this.oriented,r=i?t:t.oriented;for(let o=0;o<s;++o)if(n.points.every((a,h)=>a.equals(r.points[(h+o)%s],e)))return!0;return!1}toString(){return`polygon(${this.points.join(",")})`}};var hu=180/Math.PI,cu=Math.PI/180;var et=class{constructor(t,e=1,i=e){this.p=t,this.w=e,this.h=i,this.type="rectangle"}static aroundPoints(t){let e=Infinity,i=-Infinity,s=Infinity,n=-Infinity;for(let r of t)e=e<r.x?e:r.x,i=i>r.x?i:r.x,s=s<r.y?s:r.y,n=n>r.y?n:r.y;return new et(new u(e,s),i-e,n-s)}get center(){return new u(this.p.x+this.w/2,this.p.y+this.h/2)}get centroid(){return this.center}get circumference(){return 2*Math.abs(this.w)+2*Math.abs(this.h)}get area(){return Math.abs(this.w*this.h)}get edges(){return this.polygon.edges}get points(){return this.polygon.points}get polygon(){let t=new u(this.p.x+this.w,this.p.y),e=new u(this.p.x+this.w,this.p.y+this.h),i=new u(this.p.x,this.p.y+this.h);return new mt(this.p,t,e,i)}collision(t){return this.p.x<t.p.x+t.w&&this.p.x+this.w>t.p.x&&this.p.y<t.p.y+t.h&&this.p.y+this.h>t.p.y}padding(t,e,i,s){return new et(this.p.shift(-s,-t),this.w+s+e,this.h+t+i)}contains(t,e){return B(t.x,this.p.x,this.p.x+this.w,e)&&B(t.y,this.p.y,this.p.y+this.h,e)}project(t){let e;for(let i of this.edges){let s=i.project(t);(!e||u.distance(t,s)<u.distance(t,e))&&(e=s)}return e}at(t){return this.polygon.at(t)}offset(t){return this.polygon.offset(t)}transform(t){return this.polygon.transform(t)}rotate(t,e=Ft){return k(t,0)?this:this.polygon.rotate(t,e)}reflect(t){return this.polygon.reflect(t)}scale(t,e=t){return new et(this.p.scale(t,e),this.w*t,this.h*e)}shift(t,e=t){return new et(this.p.shift(t,e),this.w,this.h)}translate(t){return this.shift(t.x,t.y)}equals(t){return!1}toString(){return`rectangle(${this.p},${this.w},${this.h})`}},Ut=class{constructor(t,e,i,s){this.xMin=t,this.xMax=e,this.yMin=i,this.yMax=s}contains(t){return this.containsX(t)&&this.containsY(t)}containsX(t){return B(t.x,this.xMin,this.xMax)}containsY(t){return B(t.y,this.yMin,this.yMax)}resize(t,e){return new Ut(this.xMin,this.xMax+t,this.yMin,this.yMax+e)}get dx(){return this.xMax-this.xMin}get dy(){return this.yMax-this.yMin}get xRange(){return[this.xMin,this.xMax]}get yRange(){return[this.yMin,this.yMax]}get rect(){return new et(new u(this.xMin,this.yMin),this.dx,this.dy)}get center(){return new u(this.xMin+this.dx/2,this.yMin+this.dy/2)}get flip(){return new Ut(this.yMin,this.yMax,this.xMin,this.xMax)}};function Ni(t,e,i={}){if(Ve(e))return Ni(t,e.shape(!!i.fill),i);if(i.fill&&(t.fillStyle=i.fill),i.opacity&&(t.globalAlpha=i.opacity),i.stroke&&(t.strokeStyle=i.stroke,t.lineWidth=i.strokeWidth||1,i.lineCap&&(t.lineCap=i.lineCap),i.lineJoin&&(t.lineJoin=i.lineJoin)),t.beginPath(),Vi(e))t.moveTo(e.p1.x,e.p1.y),t.lineTo(e.p2.x,e.p2.y);else if(Wt(e))t.arc(e.c.x,e.c.y,e.r,0,Ie);else if(Li(e)){let s=e.points;t.moveTo(s[0].x,s[0].y);for(let n of s.slice(1))t.lineTo(n.x,n.y);t.closePath()}else if(Tn(e)){t.moveTo(e.points[0].x,e.points[0].y);for(let s of e.points.slice(1))t.lineTo(s.x,s.y)}else Fa(e)&&t.ellipse(e.c.x,e.c.y,e.a,e.b,e.angle,0,Ie);i.fill&&t.fill(),i.stroke&&t.stroke()}function In(t,e,i){let n=e.x*(i.y-t.y)+t.x*(e.y-i.y)+i.x*(t.y-e.y)>0?1:0,r=u.distance(e,t);return[t.x,`${t.y}A${r}`,r,0,n,1,i.x,i.y].join(",")}function U(...t){return`M${t.map(e=>`${e.x},${e.y}`).join("L")}`}function On(t,e){let i=t.perpendicularVector.scale(6),s=t.unitVector.scale(3),n=t.midpoint;switch(e){case"bar":return U(n.add(i),n.add(i.inverse));case"bar2":return U(n.add(s).add(i),n.add(s).add(i.inverse))+U(n.add(s.inverse).add(i),n.add(s.inverse).add(i.inverse));case"arrow":return U(n.add(s.inverse).add(i),n.add(s),n.add(s.inverse).add(i.inverse));case"arrow2":return U(n.add(s.scale(-2)).add(i),n,n.add(s.scale(-2)).add(i.inverse))+U(n.add(i),n.add(s.scale(2)),n.add(i.inverse));default:return""}}function Ne(t,e){if(!t||!e)return"";let i=e.perpendicular,s=t.add(e.scale(9)).add(i.scale(9)),n=t.add(e.scale(9)).add(i.scale(-9));return U(s,t,n)}function Ka(t,e){let i="";return D(e,"start","both")&&(i+=Ne(t.p1,t.unitVector)),D(e,"end","both")&&(i+=Ne(t.p2,t.unitVector.inverse)),i}function Ya(t,e){let i="";if(D(e,"start","both")){let s=new dt(t.c,t.start).perpendicularVector.inverse;i+=Ne(t.start,s)}if(D(e,"end","both")){let s=new dt(t.c,t.end).perpendicularVector;i+=Ne(t.end,s)}return i}function Be(t,e={}){if(Ve(t)){let i=t.shape(!!e.fill,e.size,e.round);return Be(i,e)}if(Vi(t)){if(t.p1.equals(t.p2))return"";let i=U(t.p1,t.p2);return e.mark&&(i+=On(t,e.mark)),e.arrows&&(i+=Ka(t,e.arrows)),i}if(_n(t)){if(!e.box)return"";let i=pt(t,e.box)[0];return i?U(t.p1,i):""}if(Da(t)){if(!e.box)return"";let i=pt(t,e.box);if(i.length<2)return"";let s=U(i[0],i[1]);return e.mark&&(s+=On(t,e.mark)),s}if(Wt(t))return`M ${t.c.x-t.r} ${t.c.y} a ${t.r},${t.r} 0 1 0 ${2*t.r} 0 a ${t.r} ${t.r} 0 1 0 ${-2*t.r} 0`;if(Le(t)){let i=`M${In(t.start,t.c,t.end)}`;return e.arrows&&(i+=Ya(t,e.arrows)),i}return Ha(t)?`M ${t.c.x} ${t.c.y} L ${In(t.start,t.c,t.end)} Z`:Tn(t)?U(...t.points):qa(t)?`${U(...t.points)}Z`:Ra(t)?`${U(...t.polygon.points)}Z`:""}var Z=(t,e,i)=>new Promise((s,n)=>{var r=h=>{try{a(i.next(h))}catch(c){n(c)}},o=h=>{try{a(i.throw(h))}catch(c){n(c)}},a=h=>h.done?s(h.value):Promise.resolve(h.value).then(r,o);a((i=i.apply(t,e)).next())});function Ja(t){let e=[];for(let i of Object.keys(t)){let s=t[i];if(i=encodeURIComponent(i),s==null){e.push(i);continue}s=Array.isArray(s)?s.join(","):`${s}`,s=s.replace(/(\r)?\n/g,`\r
`),s=encodeURIComponent(s),s=s.replace(/%20/g,"+"),e.push(`${i}=${s}`)}return e.join("&")}function le(t,e){return Z(this,null,function*(){let i=e instanceof FormData,s={method:"POST",body:i?e:e?Ja(e):void 0,headers:{"X-CSRF-Token":window.csrfToken||""}};i||(s.headers["Content-Type"]="application/x-www-form-urlencoded");let n=t.includes("?")?"&xhr=1":"?xhr=1",r=yield fetch(t+n,s);if(!r.ok)throw new Error(`Fetch error ${r.status}: ${t}`);return r.text()})}function Ln(t,e=!1){return new Promise(i=>{let s=new Image;e||(s.crossOrigin="Anonymous"),s.onload=()=>i(s),s.src=t})}var ue=new Map;function Vn(t,e){ue.has(t)?wi(ue.get(t),e,(i,s)=>xi(i.concat(s))):ue.set(t,e)}function Nn(){if(!!window.navigator.onLine)for(let[t,e]of ue)ue.delete(t),le(t,{data:JSON.stringify(e)}).catch(i=>{console.error("Failed to send POST request:",i),Vn(t,e)})}var Bn=Dt(Nn,5e3);window.addEventListener("online",Bn);window.onbeforeunload=Nn;function qn(t,e){Vn(t,e),Bn()}var Rn={"===":(t,e)=>t===e,"!==":(t,e)=>t!==e,"||":(t,e)=>t||e,"&&":(t,e)=>t&&e,"==":(t,e)=>t==e,"!=":(t,e)=>t!=e,"<=":(t,e)=>t<=e,">=":(t,e)=>t>=e,"**":(t,e)=>t**e,"<":(t,e)=>t<e,">":(t,e)=>t>e,"+":(t,e)=>t+e,"-":(t,e)=>t-e,"*":(t,e)=>t*e,"/":(t,e)=>t/e,"%":(t,e)=>t%e},Dn={"-":t=>-t,"+":t=>+t,"!":t=>!t},Fn={"||":1,"&&":2,"==":3,"!=":3,"===":3,"!==":3,"<":4,">":4,"<=":4,">=":4,"+":5,"-":5,"*":6,"/":6,"%":6,"**":7},Hn={true:!0,false:!1,undefined:void 0},Za=/\s/,Bi=/[0-9]/,qi=/[a-zA-ZÎ±-Ï‰Î‘-Î©$_]/,Qa=/[0-9a-zA-ZÎ±-Ï‰Î‘-Î©$_]/;function th(t){let e=t.length,i=0;function s(l){throw new Error(`${l} at character ${i} of "${t}"`)}function n(){for(;Za.test(t[i]);)i+=1}function r(){let l="";for(;Bi.test(t[i]);)l+=t[i++];if(t[i]===".")for(l+=t[i++];Bi.test(t[i]);)l+=t[i++];let g=t[i];if(g&&qi.test(g)){let w=l+t[i];s(`Variable names cannot start with a number (${w})`)}else g==="."&&s("Unexpected period");return{type:5,value:parseFloat(l)}}function o(){let l=t[i];i+=1;let g=!1,w="";for(;i<e;){let y=t[i++];if(y===l){g=!0;break}w+=y}return g||s(`Unclosed quote after "${w}"`),{type:5,value:w}}function a(){let l=t[i];for(qi.test(t[i])||s(`Unexpected ${l}`),i+=1;i<e&&Qa.test(t[i]);)l+=t[i++];return l in Hn?{type:5,value:Hn[l]}:{type:4,name:l}}function h(l){let g=[],w=!1,y;for(;i<e;)if(t[i]===l){y&&g.push(y),w=!0,i+=1;break}else t[i]===","?(g.push(y||{type:5,value:void 0}),i+=1):y=x();return w||s(`Expected ${l}`),g}function c(){let l;if(t[i]==="("){if(i+=1,l=x(),n(),t[i]===")")return i+=1,l;s("Unclosed (")}else l=a();for(n();".[(".includes(t[i]);)t[i]==="."?(i++,n(),l={type:6,object:l,computed:!1,property:a()}):t[i]==="["?(i++,l={type:6,object:l,computed:!0,property:x()},n(),t[i]!=="]"&&s("Unclosed ["),i++):t[i]==="("&&(i++,l={type:2,args:h(")"),callee:l}),n();return l}function p(){n();for(let l of[3,2,1]){let g=t.substr(i,l);if(g in Rn)return i+=l,g}}function f(){n();let l=t[i];if(Bi.test(l)||l===".")return r();if(l==="'"||l==='"')return o();if(l==="[")return i+=1,{type:0,elements:h("]")};if(l in Dn)return i+=1,{type:7,operator:l,argument:f()};if(qi.test(l)||l==="(")return c();s("Expression parsing error")}function d(){let l=f(),g=p();if(!g)return l;let w=f();w||s(`Expected expression after ${g}`);let y,v=[l,g,w];for(;g=p();){let L=Fn[g],K=g;for(;v.length>2&&L<=Fn[v[v.length-2]];)w=v.pop(),g=v.pop(),l=v.pop(),y={type:1,operator:g,left:l,right:w},v.push(y);y=f(),y||s(`Expected expression after ${K}`),v.push(K,y)}let b=v.length-1;for(y=v[b];b>1;)y={type:1,operator:v[b-1],left:v[b-2],right:y},b-=2;return y}function x(){let l=d();if(n(),l&&t[i]==="?"){i+=1;let g=x();if(g||s("Expected expression"),n(),t[i]===":"){i++;let w=x();return w||s("Expected expression"),{type:3,test:l,consequent:g,alternate:w}}else s("Expected :")}else return l}let A=x();return i<t.length&&s(`Unexpected "${t[i]}"`),A}var qe=[void 0,void 0];function X(t,e,i){switch(t.type){case 0:let s=t.elements.map(A=>X(A,e,i)[0]);return s.some(A=>A===void 0)?qe:[s,void 0];case 1:let n=X(t.left,e,i)[0],r=X(t.right,e,i)[0];return"+-**/%".includes(t.operator)&&(n===void 0||r===void 0)?qe:[Rn[t.operator](n,r),void 0];case 2:let[o,a]=X(t.callee,e,i),h=t.args.map(A=>X(A,e,i)[0]);return h.some(A=>A===void 0)||typeof o!="function"?qe:[o.apply(a,h),void 0];case 3:let c=X(t.consequent,e,i),p=X(t.alternate,e,i);return X(t.test,e,i)[0]?c:p;case 4:return[i[t.name]||e[t.name],void 0];case 5:return[t.value,void 0];case 6:let f=X(t.object,e,i)[0],d=t.computed?X(t.property,e,i)[0]:t.property.name;return f?[f[d],f]:[void 0,void 0];case 7:let x=X(t.argument,e,i)[0];return x===void 0&&t.operator!=="!"?qe:[Dn[t.operator](x),void 0]}}function at(t){let e=th(t);return e?(i={},s={})=>X(e,i,s)[0]:(i={})=>{}}var eh=/\${([^}]+)}/g;function Wn(t){let e=t.split(eh),i=e.map((s,n)=>n%2?at(s.replace(/Ã—/g,"*")):void 0);return s=>e.map((n,r)=>{if(!(r%2))return n;let o=i[r](s);return typeof o=="number"&&o<0?`\u2013${-o}`:o}).join("")}var fe="ontouchstart"in window,zt="onpointerdown"in window;function St(t){if(t.touches){let e=t.targetTouches.length?t.targetTouches:t.changedTouches;return new u(e[0].clientX,e[0].clientY)}else return new u(t.clientX||0,t.clientY||0)}function ih(t){return t.touches||[]}function sh(t,e){return St(t).transform(e.inverseTransformMatrix)}function nh(t,e){let i=St(t),s=e.bounds,n=(i.x-s.left)*e.canvasWidth/s.width,r=(i.y-s.top)*e.canvasHeight/s.height;return new u(n,r)}function rh(t){if(t instanceof PointerEvent&&t.pointerType==="mouse")return C(t.target);let e=St(t);return C(document.elementFromPoint(e.x,e.y)||void 0)}function oh(t){if(t._data.tapEvent)return;t._data.tapEvent=!0;let e;t.on("pointerdown",i=>e=St(i)),t.on("pointerup",i=>{if(!e)return;let s=St(i);u.distance(e,s)<6&&t.trigger("tap",i),e=void 0}),t.on("pointercancel",()=>e=void 0)}function ah(t){t._data.clickOutsideEvent||(t._data.clickOutsideEvent=!0,P.on("pointerdown",e=>{var i,s;let n=e.target,r=(s=(i=t._el).getRootNode)==null?void 0:s.call(i),o=St(e);(r==null?void 0:r.host)&&(n=r.elementFromPoint(o.x,o.y)),!(!n||t._el===n||t._el.contains(n))&&t.trigger("clickOutside",e)}))}function de(t,e){let i=e.$box||t,s=St;i.type==="svg"?s=d=>sh(d,i.$ownerSVG):i.type==="canvas"&&(s=d=>nh(d,i));let n=e.justInside?t:P,r,o,a=!1,h=0;t.css("touch-action")==="auto"&&t.css("touch-action","none"),t.addClass("noselect");function c(d){d.handled||ih(d).length>1||(d.preventDefault(),a=!1,h=d.pointerId||0,n.on("pointermove",p),n.on("pointerstop",f),r=o=s(d),e.down&&e.down(r))}function p(d){if(!r||h&&d.pointerId!==h)return;d.preventDefault();let x=s(d);u.distance(x,o)<.5||(!a&&e.start&&e.start(r),e.move&&e.move(x,r,o),o=x,a=!0)}function f(d,x=!1){!r||h&&d.pointerId!==h||(d.preventDefault(),n.off("pointermove",p),n.off("pointerstop",f),e.up&&e.up(o,r),a&&e.end&&e.end(o,r),!a&&e.click&&!x&&e.click(r),r=void 0)}m.onKey("escape",()=>{if(!r)return;a&&e.move&&e.move(r,r,o),o=r;let d=document.createEvent("MouseEvent");d.pointerId=h,f(d,!0)}),t.on("pointerdown",c),e.justInside&&t.on("mouseleave",f),e.accessible&&(t.setAttr("tabindex","0"),document.addEventListener("keydown",d=>{if(![37,38,39,40].includes(d.keyCode)||t!==m.getActiveInput())return;let x=t.boxCenter,A=s({clientX:x.x,clientY:x.y}),l=d.keyCode===37?-25:d.keyCode===39?25:0,g=d.keyCode===38?-25:d.keyCode===40?25:0,w=A.shift(l,g);e.down&&e.down(A),e.start&&e.start(A),e.move&&e.move(w,A,A),e.end&&e.end(w,A)}))}function hh(t){if(t._data.scrollEvents)return;t._data.scrollEvents=!0;let e=!1,i;function s(){let h=t.scrollTop;if(h===i){e=!1;return}i=h,t.trigger("scroll",{top:i}),window.requestAnimationFrame(s)}function n(){e||window.requestAnimationFrame(s),e=!0}(t.type==="window"?window:t._el).addEventListener("scroll",n);function o(){window.addEventListener("touchmove",n),window.addEventListener("touchend",a)}function a(){window.removeEventListener("touchmove",n),window.removeEventListener("touchend",a)}t._el.addEventListener("touchstart",function(h){h.handled||o()})}function jt(t,e){let i=e.$clickTarget||t,s=0,n=!1,r=!1,o=!1;function a(){n||(e.enter&&e.enter(),n=!0)}function h(){!n||(clearTimeout(s),e.exit&&e.exit(),n=!1)}t.on("mouseover",()=>{e.preventMouseover&&e.preventMouseover()||(clearTimeout(s),s=$t(()=>{a(),r=!0},e.delay))}),t.on("mouseout",()=>{!r||(clearTimeout(s),s=$t(h,e.exitDelay||e.delay))}),i.on("focus",()=>{n||e.preventMouseover&&e.preventMouseover()||(clearTimeout(s),a(),o=!0)});let c=()=>{!o||(e.canFocusWithin?setTimeout(()=>{let p=m.getActiveInput();p&&p.hasParent(t)?p.one("blur",c):h()}):h())};i.on("blur",c),i.on("click",()=>{n&&!r?h():n||(a(),r=!1)}),t.on("clickOutside",h)}var Ri;function ch(t){for(let e of t){let i=e.isIntersecting?"enterViewport":"exitViewport";setTimeout(()=>C(e.target).trigger(i))}}function Un(t){if(!t._data.intersectionEvents){if(t._data.intersectionEvents=!0,!window.IntersectionObserver){let e=!1;P.on("scroll",()=>{let i=t.isInViewport;e&&!i?(t.trigger("exitViewport"),e=!1):i&&!e&&(t.trigger("enterViewport"),e=!0)});return}Ri||(Ri=new IntersectionObserver(ch)),Ri.observe(t._el)}}function lh(t,e=!1){if(e&&(t._data.resizeObserver&&t._data.resizeObserver.disconnect(),t._data.resizeObserver=void 0),!t._data.resizeObserver){if(window.ResizeObserver){let i=new window.ResizeObserver(()=>t.trigger("resize"));i.observe(t._el),t._data.resizeObserver=i}else if(window.MutationObserver){let i=new MutationObserver(()=>t.trigger("resize"));i.observe(t._el,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),t._data.resizeObserver=i}}}function zn(t){if(t._data.pointerPositionEvents)return;t._data.pointerPositionEvents=!0;let e=t.parent,i;e.on("pointerend",()=>i=void 0),e.on("pointermove",s=>{let n=i,r=rh(s);i=r.equals(t)||r.hasParent(t),n!==void 0&&i&&!n&&t.trigger("pointerenter",s),!i&&n&&t.trigger("pointerleave",s)})}function Di(t,e){e._data[`_${t}`]||(e._data[`_${t}`]=!0,zt?e.on(t.replace("mouse","pointer"),i=>{i.pointerType==="mouse"&&e.trigger(t,i)}):fe||e._el.addEventListener(t,i=>e.trigger(t,i)))}function uh(t){t.on("keydown",e=>{if(e.metaKey||e.ctrlKey||m.isAndroid&&e.keyCode===229)return;let i=e.key||String.fromCharCode(e.which),s=i.toLowerCase(),n=!!e.shiftKey;t.trigger("key",{code:e.keyCode,key:s,char:i,shift:n})}),m.isAndroid&&t.type==="input"&&t.on("input",e=>{let i=e.data[e.data.length-1],s=i.toLowerCase();t.trigger("key",{code:void 0,key:s,char:i}),t.value=""})}var Re={scrollwheel:"DOMMouseScroll mousewheel",pointerdown:zt?"pointerdown":fe?"touchstart":"mousedown",pointermove:zt?"pointermove":fe?"touchmove":"mousemove",pointerup:zt?"pointerup":fe?"touchend":"mouseup",pointercancel:zt?"pointercancel":"touchcancel",pointerstop:zt?"pointerup pointercancel":fe?"touchend touchcancel":"mouseup"},De={scroll:hh,tap:oh,clickOutside:ah,key:uh,mousedown:Di.bind(void 0,"mousedown"),mousemove:Di.bind(void 0,"mousemove"),mouseup:Di.bind(void 0,"mouseup"),pointerenter:zn,pointerleave:zn,enterViewport:Un,exitViewport:Un,resize:lh};function fh(t,e,i,s){if(e in De)De[e](t,!1);else if(e in Re){let n=V(Re[e]);for(let r of n)t._el.addEventListener(r,i,s)}else t._el.addEventListener(e,i,s)}function dh(t,e,i){if(e in De)(!t._events[e]||!t._events[e].length)&&De[e](t,!0);else if(i&&e in Re){let s=V(Re[e]);for(let n of s)t._el.removeEventListener(n,i)}else i&&t._el.removeEventListener(e,i)}var Fe=0,Fi=new Map;function jn(t,e){Fi.set(t,e)}function ph(t){if(Fe++,t(),Fe--,Fe===0){for(let[e,i]of Fi.entries())e(i);Fi.clear()}}function Hi(t,e){let i=new Map,s=new Map,n=new Set,r,o=0;function a(v){r=v;let b=v(y,!0);return r=void 0,b}function h(v){for(let b of i.values())b.has(v)&&b.delete(v);n.delete(v)}function c(v,b){return n.add(v),b?void 0:v(y,!0)}function p(v,b){s.has(v)&&h(s.get(v));let L=()=>{t[v]=b(y),r===L&&(r=void 0),f(v)};s.set(v,L),a(L)}function f(v){if(Fe>0){for(let b of i.get(v)||[])jn(b,t);for(let b of n)jn(b,t)}else{for(let b of i.get(v)||[])b(t);for(let b of n)b(t)}}function d(){for(let v of i.values())for(let b of v)b(t);for(let v of n)v(t)}function x(v,b){b&&(t={}),ph(()=>{for(let[L,K]of Object.entries(v))y[L]=K})}function A(){for(o+=1;`_x${o}`in t;)o+=1;return`_x${o}`}function l(){t={},i.clear(),s.clear(),o=0}function g(){return Object.assign({},t)}function w(v){!e||e.watch(()=>y[v]=e[v])}let y=new Proxy(t,{get(v,b){return b==="watch"?a:b==="unwatch"?h:b==="watchAll"?c:b==="setComputed"?p:b==="forceUpdate"?d:b==="assign"?x:b==="getKey"?A:b==="clear"?l:b==="copy"?g:b==="_internal"?[t,i]:(r&&(i.has(b)||i.set(b,new Set),i.get(b).add(r)),b in t||w(b),t[b])},set(v,b,L){return t[b]===L||(t[b]=L,s.has(b)&&(h(s.get(b)),s.delete(b)),f(b)),!0},deleteProperty(v,b){return delete t[b],i.delete(b),s.delete(b),!0}});return y}var mh={A:7,C:6,H:1,L:2,M:2,Q:4,S:4,T:2,V:1,Z:0},gh=/[astvzqmhlc]([^astvzqmhlc]*)/ig,vh=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function wh(t){let e=[],i;for(let s of t.match(gh)||[]){let n=s[0].toUpperCase();if(n==="Z"){e.push({type:"Z",points:[]});continue}let r=(s.slice(1).match(vh)||[]).map(a=>+a),o=n===s[0];for(let[a,h]of Mi(r,mh[n]).entries()){let c=[],p=n==="M"&&a>0?"L":n,f;n==="H"?(p="L",c=[new u(h[0],o&&(i==null?void 0:i.y)||0)]):n==="V"?(p="L",c=[new u(o&&(i==null?void 0:i.x)||0,h[0])]):n==="A"?(p="A",c=[new u(h[5],h[6])],f=h.slice(0,5)):"MLCSQT".includes(n)&&(c=Mi(h,2).map(d=>new u(d[0],d[1]))),!o&&i&&(c=c.map(d=>d.translate(i))),i=z(c),e.push({type:p,points:c,options:f})}}return e}function yh(t){return t?wh(t).map(i=>z(i.points)).filter(i=>!!i):[]}var bh=["font-family","font-size","font-style","font-weight","letter-spacing","text-decoration","color","display","visibility","alignment-baseline","baseline-shift","opacity","text-anchor","clip","clip-path","clip-rule","mask","filter","transform","transform-origin","white-space","line-height"],xh=["fill","fill-rule","marker","marker-start","marker-mid","marker-end","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-width","text-rendering","dominant-baseline","transform-box","paint-order"],$h=["padding","min-width","max-width","height","border-width","border-style","border-color","box-sizing","background","width","grid-template-columns","text-align"],Mh=["class","tabindex","contenteditable"],Ch=new Set(["opacity","transform-box","transform-origin","border-width","border-style","border-color"]),Eh={"font-style":"normal","font-weight":"400","letter-spacing":"normal","text-decoration":"none",display:"block",visibility:"visible","alignment-baseline":"auto","baseline-shift":"0px","text-anchor":"start",clip:"auto","clip-path":"none","clip-rule":"nonzero",mask:"none",opacity:"1",filter:"none",fill:"rgb(0, 0, 0)","fill-rule":"nonzero",marker:"none",stroke:"none","stroke-dasharray":"none","stroke-dashoffset":"0px","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-width":"1px","text-rendering":"auto",transform:"none","dominant-baseline":"auto","transform-origin":"0px 0px","transform-box":"view-box","paint-order":"normal"};function Xn(t){var e,i;if(t.getAttribute("hidden")||t.style.opacity==="0"||t.style.display==="none")(e=t.parentNode)==null||e.removeChild(t);else{for(let s of Array.from(t.children))Xn(s);if(t.tagName==="g"&&t.childElementCount===0)(i=t.parentNode)==null||i.removeChild(t);else for(let s of Mh)t.hasAttribute(s)&&t.removeAttribute(s)}}function Sh(t,e){let i=t.parentElement;for(;i;){let s=i.style.getPropertyValue(e);if(s)return s;i=i.parentElement}}function Gn(t,e,i=!1){let s=window.getComputedStyle(t);e.removeAttribute("style");let n=i||t.tagName==="foreignObject",r=[...bh,...n?$h:xh];for(let h of r){let c=s.getPropertyValue(h),p=Sh(e,h);c===Eh[h]&&!p||!Ch.has(h)&&c===p||e.style.setProperty(h,c)}let o=t.children,a=e.children;for(let h=0;h<a.length;++h)Gn(o[h],a[h],n)}var Kn=class{constructor(t){this._el=t,this._data={},this._events={},this.type="default",t._view=this}get id(){return this._el.id}get data(){return this._el.dataset}get tagName(){return this._el.tagName.toUpperCase()}equals(t){return this._el===t._el}addClass(t){for(let e of V(t))this._el.classList.add(e)}removeClass(t){for(let e of V(t))this._el.classList.remove(e)}hasClass(t){return this._el.classList.contains(t)}toggleClass(t){return this._el.classList.toggle(t)}setClass(t,e){e?this.addClass(t):this.removeClass(t)}attr(t){return this._el.getAttribute(t)||""}hasAttr(t){return this._el.hasAttribute(t)}setAttr(t,e){e===void 0?this.removeAttr(t):this._el.setAttribute(t,e.toString())}removeAttr(t){this._el.removeAttribute(t)}get attributes(){return Array.from(this._el.attributes||[])}get html(){return this._el.innerHTML||""}set html(t){this._el.innerHTML=t}get text(){return this._el.textContent||""}set text(t){this._el.textContent=t}set textStr(t){this._el.textContent=`${t}`}blur(){this._el.blur()}focus(){this._el.focus()}getParentModel(){let t=this.parent;return t?t.model||t.getParentModel():void 0}bindModel(t,e=!0){var i;if(!this.model){if(this.model=t,this.hasAttr(":for"))return this.makeDynamicList(t);for(let{name:s,value:n}of this.attributes)this.makeDynamicAttribute(s,n,t);for(let s of this.childNodes)if(s instanceof Text){if((i=s.textContent)==null?void 0:i.includes("${")){let n=Wn(s.textContent);t.watch(()=>s.textContent=n(t)||"")}}else e&&s.bindModel(t)}}bindVariable(t,e){}toggleDOM(t=!0){t!==!!this._el.parentNode&&(this.$placeholder||(this.$placeholder=C(document.createComment("")),this.insertBefore(this.$placeholder)),t?this.$placeholder.insertBefore(this):this.detach())}makeDynamicAttribute(t,e,i){if(t.startsWith("@")){let s=t.slice(1),n=at(e);this.on(s,r=>n(i,{$event:r}))}else if(t===":show"){let s=at(e);i.watch(()=>this.toggle(!!s(i)))}else if(t===":if"){let s=at(e);i.watch(()=>this.toggleDOM(!!s(i)))}else if(t===":html"){let s=at(e);i.watch(()=>this.html=s(i)||"")}else if(t===":draw"){let s=at(e);i.watch(()=>this.draw(s(i)))}else if(t===":class"){let s=at(e),n=`${this.attr("class")} `;i.watch(()=>this.setAttr("class",n+s(i)))}else if(t===":bind")this.bindVariable(i,e);else if(t.startsWith(":")){let s=at(e),n=t.slice(1);i.watch(()=>this.setAttr(n,s(i)))}else if(e.includes("${")){let s=Wn(e);i.watch(()=>this.setAttr(t,s(i)||""))}(t.startsWith("@")||t.startsWith(":"))&&this.removeAttr(t)}makeDynamicList(t){let[e,i]=this.attr(":for").split(" in ");this.removeAttr(":for");let s=at(i),n=C(document.createComment(""));this.insertBefore(n),this.detach();let r=[],o=0;t.watch(()=>{let a=s(t);Array.isArray(a)||(a=[]);for(let h=a.length;h<o;++h)r[h].detach();for(let h=o;h<r.length;++h)n.insertBefore(r[h]);for(let h=r.length;h<a.length;++h){let c=this.copy(!0);c.bindModel(Hi({[e]:void 0},t)),n.insertBefore(c),r.push(c)}o=a.length;for(let h=0;h<o;++h)r[h].model[e]=a[h]})}get bounds(){return this._el.getBoundingClientRect()}get boundsRect(){let t=this.bounds;return new et(new u(t.x,t.y),t.width,t.height)}contains(t){return this.boundsRect.contains(t)}get isInViewport(){if(this.height===0)return!1;let t=this.bounds;return B(t.top,-t.height,m.height)}get topLeftPosition(){let t=this.bounds;return new u(t.left,t.top)}get boxCenter(){let t=this.bounds;return new u(t.left+t.width/2,t.top+t.height/2)}get scrollWidth(){return this._el.scrollWidth}get scrollHeight(){return this._el.scrollHeight}get scrollTop(){return this._el.scrollTop}set scrollTop(t){this._el.scrollTop=t,this.trigger("scroll",{top:t,left:this.scrollLeft})}get scrollLeft(){return this._el.scrollLeft}set scrollLeft(t){this._el.scrollLeft=t,this.trigger("scroll",{top:this.scrollTop,left:t})}scrollTo(t,e=1e3,i="cubic"){t<0&&(t=0);let s=this.scrollTop,n=t-s;this._data.scrollAnimation&&this._data.scrollAnimation.cancel(),this._data.scrollAnimation=ht(r=>{let o=s+n*kt(i,r);this.scrollTop=o,this.trigger("scroll",{top:o})},e)}scrollBy(t,e=1e3,i="cubic"){!t||this.scrollTo(this.scrollTop+t,e,i)}css(t,e){if(e===void 0){if(typeof t=="string")return window.getComputedStyle(this._el).getPropertyValue(t);{let i=Object.keys(t);for(let s of i)this._el.style.setProperty(s,`${t[s]}`)}}else typeof t=="string"&&this._el.style.setProperty(t,`${e}`)}get transform(){return this.css("transform").replace("none","")}get transformMatrix(){let t=this.transform;if(!t)return[[1,0,0],[0,1,0]];let e=t.match(/matrix\(([0-9,.\s-]*)\)/);if(!e||!e[1])return[[1,0,0],[0,1,0]];let i=e[1].split(",");return[[+i[0],+i[2],+i[4]],[+i[1],+i[3],+i[5]]]}get scale(){let t=this.transformMatrix;return[t[0][0],t[1][1]]}setTransform(t,e=0,i=1){let s="";t&&(s+=`translate(${ft(t.x,.1)}px,${ft(t.y,.1)}px)`),e&&(s+=` rotate(${e}rad)`),i&&(s+=` scale(${i})`),this._el.style.transform=s}translate(t,e){this.setTransform(new u(t,e))}show(){this.hasAttr("hidden")&&this.removeAttr("hidden"),this.data.display==="visibility"?this._el.style.visibility="visible":this._el.style.display=this.data.display||"block"}hide(){this.data.display==="visibility"?this._el.style.visibility="hidden":this._el.style.display="none"}toggle(t){t?this.show():this.hide()}is(t){return this._el.matches?this._el.matches(t):Array.from(document.querySelectorAll(t)).includes(this._el)}index(){let t=0,e=this._el;for(;(e=e.previousSibling||void 0)!==void 0;)++t;return t}prepend(t){let e=this._el.childNodes;e.length?this._el.insertBefore(t._el,e[0]):this._el.appendChild(t._el)}append(t){this._el.appendChild(t instanceof Text?t:t._el)}insertBefore(t){this.parent._el.insertBefore(t._el,this._el)}insertAfter(t){let e=this._el.nextSibling;e?this.parent._el.insertBefore(t._el,e):this.parent._el.appendChild(t._el)}get next(){return C(this._el.nextSibling)}get prev(){return C(this._el.previousSibling)}$(t){return C(t,this)}$$(t){return gt(t,this)}get parent(){return C(this._el.parentElement||void 0)}parents(t){let e=[],i=this.parent;for(;i;)(!t||i.is(t))&&e.push(i),i=i.parent;return e}hasParent(...t){let e=t.map(s=>s._el),i=this._el.parentNode;for(;i;){if(D(i,...e))return!0;i=i.parentNode}return!1}get children(){return Array.from(this._el.children||[],t=>C(t))}get childNodes(){return Array.from(this._el.childNodes,t=>{if(!(t instanceof Comment))return t instanceof Text?t:C(t)}).filter(t=>t)}restartAnimation(){let t=this.next,e=this.parent;this.detach(),t?t.insertBefore(this):e.append(this)}detach(){this._el&&this._el.parentNode&&this._el.parentNode.removeChild(this._el)}remove(){this.detach()}removeChildren(){for(;this._el.firstChild;)this._el.removeChild(this._el.firstChild)}copy(t=!0){return C(this._el.cloneNode(t))}on(t,e,i){for(let s of V(t))s in this._events?this._events[s].includes(e)||this._events[s].push(e):this._events[s]=[e],fh(this,s,e,i)}one(t,e,i){let s=n=>{this.off(t,s),e(n)};this.on(t,s,i)}off(t,e){for(let i of V(t))i in this._events&&(this._events[i]=e?this._events[i].filter(s=>s!==e):[]),dh(this,i,e)}trigger(t,e={}){for(let i of V(t)){if(!this._events[i])return;for(let s of this._events[i])s.call(this,e)}}onKeyDown(t,e){let i=V(t).map(s=>He[s]||s);this._el.addEventListener("keydown",s=>{i.indexOf(s.keyCode)>=0&&e(s)})}onAttr(t,e){new MutationObserver(s=>{for(let n of s)n.type==="attributes"&&n.attributeName===t&&e(this.attr(t))}).observe(this._el,{attributes:!0}),e(this.attr(t),!0)}onPromise(t,e=!1){return e?Promise.resolve():new Promise(i=>this.one("solve",()=>i()))}animate(t,e=400,i=0,s="ease-in-out"){return R(this,t,e,i,s)}enter(t="fade",e=500,i=0){return kh(this,t,e,i)}exit(t="fade",e=500,i=0,s=!1){return Ah(this,t,e,i,s)}effect(t){this.one("animationend",()=>this.removeClass(`effects-${t}`)),this.addClass(`effects-${t}`)}},At=class extends Kn{get offsetTop(){return this._el.offsetTop}get offsetLeft(){return this._el.offsetLeft}get offsetParent(){return C(this._el.offsetParent||void 0)}get width(){return this._el.offsetWidth}get height(){return this._el.offsetHeight}get innerWidth(){let t=parseFloat(this.css("padding-left")),e=parseFloat(this.css("padding-right"));return this._el.clientWidth-t-e}get innerHeight(){let t=parseFloat(this.css("padding-bottom")),e=parseFloat(this.css("padding-top"));return this._el.clientHeight-t-e}get outerWidth(){let t=parseFloat(this.css("margin-left")),e=parseFloat(this.css("margin-right"));return this.width+t+e||0}get outerHeight(){let t=parseFloat(this.css("margin-bottom")),e=parseFloat(this.css("margin-top"));return this.height+t+e||0}get positionTop(){let t=this._el,e=0;for(;t;)e+=t.offsetTop,t=t.offsetParent;return e}get positionLeft(){let t=this._el,e=0;for(;t;)e+=t.offsetLeft,t=t.offsetParent;return e}offset(t){if(t._el===this._el.offsetParent){let e=this.offsetTop+t._el.clientTop,i=this.offsetLeft+t._el.clientLeft,s=e+this.height,n=i+this.width;return{top:e,left:i,bottom:s,right:n}}else{let e=t._el.getBoundingClientRect(),i=this._el.getBoundingClientRect();return{top:i.top-e.top,left:i.left-e.left,bottom:i.bottom-e.top,right:i.right-e.left}}}},Yn=class extends Kn{constructor(){super(...arguments);this.type="svg"}get $ownerSVG(){return C(this._el.ownerSVGElement||void 0)}get width(){return this.bounds.width}get height(){return this.bounds.height}get positionLeft(){let t=this._el.getBBox().x+this._el.getCTM().e;return this.$ownerSVG.positionLeft+t}get positionTop(){let t=this._el.getBBox().y+this._el.getCTM().f;return this.$ownerSVG.positionTop+t}get inverseTransformMatrix(){let t=this._el.getScreenCTM().inverse(),e=[[t.a,t.c,t.e],[t.b,t.d,t.f]];if(m.isFirefox){let i=this.transformMatrix;e[0][2]-=i[0][2],e[1][2]-=i[1][2]}return e}setTransform(t,e=0,i=1){let s=t?`translate(${ft(t.x,.1)} ${ft(t.y,.1)})`:"",n=k(e,0)?"":`rotate(${e*180/Math.PI})`,r=k(i,1)?"":`scale(${i})`;this.setAttr("transform",[s,n,r].join(" "))}get strokeLength(){if(this._el instanceof SVGGeometryElement)return this._el.getTotalLength();{let t=this.bounds;return 2*t.height+2*t.width}}getPointAtLength(t){if(this._el instanceof SVGGeometryElement){let e=this._el.getPointAtLength(t);return new u(e.x,e.y)}else return new u(0,0)}getPointAt(t){return this.getPointAtLength(t*this.strokeLength)}get points(){return yh(this.attr("d"))}set points(t){let e=t.length?`M${t.map(i=>`${i.x},${i.y}`).join("L")}`:"";this.setAttr("d",e)}addPoint(t){let e=`${this.attr("d")} L ${t.x},${t.y}`;this.setAttr("d",e)}get center(){let t=+this.attr(this.tagName==="TEXT"?"x":"cx"),e=+this.attr(this.tagName==="TEXT"?"y":"cy");return new u(t,e)}setCenter(t){this.setAttr(this.tagName==="TEXT"?"x":"cx",t.x),this.setAttr(this.tagName==="TEXT"?"y":"cy",t.y)}setLine(t,e){this.setAttr("x1",t.x),this.setAttr("y1",t.y),this.setAttr("x2",e.x),this.setAttr("y2",e.y)}setRect(t){this.setAttr("x",t.p.x),this.setAttr("y",t.p.y),this.setAttr("width",t.w),this.setAttr("height",t.h)}draw(t,e={}){if(!t)return this.setAttr("d","");let i={mark:this.attr("mark"),arrows:this.attr("arrows"),size:+this.attr("size")||void 0,fill:this.hasClass("fill"),round:this.hasAttr("round")};this.setAttr("d",Be(t,Object.assign(e,i)))}},Th=class extends Yn{get viewBox(){return this._el.viewBox.baseVal||{width:0,height:0}}get $ownerSVG(){return this}get positionLeft(){return parseInt(this.css("margin-left"))+this.parent.positionLeft}get positionTop(){return parseInt(this.css("margin-top"))+this.parent.positionTop}get svgWidth(){return this.viewBox.width||this.width}get svgHeight(){return this.viewBox.height||this.height}drawPath(t,e={},i={}){let s=S("path",e,this);return s.draw(t,i),s}image(t,e,i,s){return Z(this,null,function*(){let n=this.copy(!0);if(Gn(this._el,n._el),t==="svg"&&Xn(n._el),i||(i=e||this.svgHeight),e||(e=this.svgWidth),n.setAttr("width",e),n.setAttr("height",i),n.setAttr("viewBox",s||this.attr("viewBox")||`0 0 ${this.svgWidth} ${this.svgHeight}`),n.setAttr("xmlns","http://www.w3.org/2000/svg"),t==="svg"){let c=n.$$('image[href^="/"]');for(let p of c)p.setAttr("href",`${location.protocol}//${location.host}${p.attr("href")}`)}else{let c=n.$$('image[href^="http"]');yield Promise.all(c.map(p=>Z(this,null,function*(){let f=yield Ln(p.attr("href")),d=S("canvas",{width:f.width,height:f.height});d.ctx.drawImage(f,0,0,f.width,f.height);let x=yield d.image("png");p.setAttr("href",x)})))}let r=new XMLSerializer().serializeToString(n._el),o=`data:image/svg+xml;utf8,${encodeURIComponent(r)}`;if(t==="svg")return o;let a=S("canvas",{width:e,height:i});t==="jpg"&&(a.ctx.fillStyle="white",a.ctx.fillRect(0,0,e,i));let h=yield Ln(o);return a.ctx.drawImage(h,0,0,e,i),a.image(t)})}downloadImage(t,e,i,s){let n=m.isIOS?window.open("","_blank"):void 0,r=m.theme.isDark;r&&m.setTheme("light");let o=t.endsWith(".jpg")?"jpg":t.endsWith(".svg")?"svg":"png",a=this.image(o,e,i,s);r&&m.setTheme("dark"),a.then(h=>{if(n)return n.location.href=h;S("a",{download:t,href:h,target:"_blank"})._el.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!1,cancelable:!0}))})}},Jn=class extends At{constructor(){super(...arguments);this.type="window"}get width(){return window.innerWidth}get height(){return window.innerHeight}get innerWidth(){return window.innerWidth}get innerHeight(){return window.innerHeight}get outerWidth(){return window.outerWidth}get outerHeight(){return window.outerHeight}get scrollWidth(){return document.body.scrollWidth}get scrollHeight(){return document.body.scrollHeight}get scrollTop(){return window.pageYOffset}set scrollTop(t){document.body.scrollTop=document.documentElement.scrollTop=t,this.trigger("scroll",{top:t,left:this.scrollLeft})}get scrollLeft(){return window.pageXOffset}set scrollLeft(t){document.body.scrollLeft=document.documentElement.scrollLeft=t,this.trigger("scroll",{top:this.scrollTop,left:t})}},_h=class extends At{constructor(){super(...arguments);this.type="form"}get action(){return this._el.action}get formData(){let t={};for(let e of Array.from(this._el.elements)){let i=e.name||e.id;i&&(t[i]=e.value)}return t}get isValid(){return this._el.checkValidity()}},Ph=class extends At{constructor(){super(...arguments);this.type="input"}get checked(){return this._el.checked||!1}set checked(t){this._el.checked=t}get value(){return this._el.value}set value(t){this._el.value=t}bindVariable(t,e){let i=this._el.type==="number",s=this._el.type==="checkbox";if(e in t?s?this.checked=t[e]:this.value=t[e]:this.value&&(s?t[e]=this.checked:t[e]=this.value),i){let n=this.hasAttr("min")?+this.attr("min"):-Infinity,r=this.hasAttr("max")?+this.attr("max"):Infinity;this.change(o=>t[e]=q(+o,n,r)),this.on("blur",()=>this.value=t[e])}else s?this.on("change",()=>t[e]=this.checked):this.change(n=>t[e]=n);t.watch(()=>{s?this.checked=t[e]:this.value=t[e],this.trigger("model-change",{defaultPrevented:!0})})}setInputPattern(t){if(isNaN(+t))return;let e=t.match(/^[0-9]+$/);this.setAttr("inputmode",e?"numeric":"decimal"),e&&this.setAttr("pattern","[0-9]*")}change(t){let e=this.value||"";this.on("change keyup input paste model-change",i=>{this.value!==e&&(e=this.value.trim(),i.defaultPrevented||t(e))})}validate(t){this.change(e=>this.setValidity(t(e)))}setValidity(t){this._el.setCustomValidity(t)}get isValid(){return this._el.checkValidity()}},Ih=class extends At{constructor(){super(...arguments);this.type="canvas"}getContext(t="2d",e={}){return this._el.getContext(t,e)}image(t="png"){return this._el.toDataURL(t==="png"?"image/png":"image/jpeg")}get canvasWidth(){return this._el.width}get canvasHeight(){return this._el.height}get ctx(){return this._ctx||(this._ctx=this.getContext()),this._ctx}draw(t,e={}){this.ctx.save(),Ni(this.ctx,t,e),this.ctx.restore()}clear(){this.ctx.clearRect(0,0,this.canvasWidth,this.canvasHeight)}fill(t){this.ctx.save(),this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.canvasWidth,this.canvasHeight),this.ctx.restore()}clearCircle(t,e){this.ctx.save(),this.ctx.globalCompositeOperation="destination-out",this.ctx.beginPath(),this.ctx.arc(t.x,t.y,e,0,2*Math.PI,!1),this.ctx.fill(),this.ctx.restore()}downloadImage(t){let e=this.image(t.endsWith(".jpg")?"jpg":"png");S("a",{download:t,href:e,target:"_blank"})._el.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!1,cancelable:!0}))}},Oh=class extends At{play(){return this._el.play()||Promise.resolve()}pause(){return this._el.pause()}},Zn=["path","rect","circle","ellipse","polygon","polyline","g","defs","marker","line","text","tspan","pattern","mask","svg","foreignObject","image","use"];function C(t,e){if(!t)return;let i=e?e._el:document.documentElement,s=typeof t=="string"?i.querySelector(t):t;if(!s)return;if(s._view)return s._view;let n=(s.tagName||"").toLowerCase();return n==="svg"?new Th(s):n==="canvas"?new Ih(s):n==="form"?new _h(s):n==="input"||n==="select"||n==="textarea"?new Ph(s):n==="video"||n==="audio"?new Oh(s):Zn.includes(n)?new Yn(s):new At(s)}function gt(t,e){let i=e?e._el:document.documentElement,s=t?i.querySelectorAll(t):[];return Array.from(s,n=>C(n))}function S(t,e={},i){let s=Zn.includes(t)?document.createElementNS("http://www.w3.org/2000/svg",t):document.createElement(t);for(let[r,o]of Object.entries(e))o!==void 0&&(r==="id"?s.id=o:r==="html"?s.innerHTML=o:r==="text"?s.textContent=o:r==="path"?s.setAttribute("d",Be(o)):s.setAttribute(r,o));let n=C(s);return i&&i.append(n),n}var P=new Jn(document.body),G=new Jn(document.documentElement),He={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,escape:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46},We="_M",Xt=window.navigator.userAgent.toLowerCase(),Qn={};for(let[t,e]of Object.entries(He))Qn[e]=t;var Lh=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i,tr=/iphone|ipad|ipod/i,Vh=/^((?!chrome|android).)*safari/i,er,Nh=class{constructor(){this.isMobile=Lh.test(Xt),this.isRetina=(window.devicePixelRatio||1)>1,this.isTouch=!!window.Touch||"ontouchstart"in window,this.isChrome=!!window.chrome,this.isFirefox=Xt.indexOf("firefox")>=0,this.isAndroid=Xt.indexOf("android")>=0,this.isIOS=tr.test(Xt),this.isSafari=tr.test(Xt)||Vh.test(Xt),this.loadQueue=[],this.loaded=!1,this.width=window.innerWidth,this.height=window.innerHeight,this.resizeCallbacks=[],this.theme={name:"light",isDark:!1},this.themeChangedCallbacks=[],this.themeOverride="",this.darkQuery=(er=window.matchMedia)==null?void 0:er.call(window,"(prefers-color-scheme: dark)");var t,e;window.onload=()=>this.afterLoad(),document.addEventListener("DOMContentLoaded",()=>this.afterLoad());let i=Dt(()=>this.applyResize());window.addEventListener("resize",i);try{(t=this.darkQuery)==null||t.addEventListener("change",()=>this.applyThemeChange())}catch(n){(e=this.darkQuery)==null||e.addListener(()=>this.applyThemeChange())}let s=this.getCookie("theme");s&&this.setTheme(s);try{this.localStorage=window.localStorage}catch(n){console.warn("Unable to access Local Storage in this context.")}}afterLoad(){if(!this.loaded){this.loaded=!0;for(let t of this.loadQueue)t();setTimeout(()=>this.resize())}}ready(t){this.loaded?t():this.loadQueue.push(t)}redraw(){document.body.offsetHeight}applyResize(){let t=window.innerWidth,e=window.innerHeight;if(!(this.width===t&&this.height===e)){this.width=t,this.height=e;for(let i of this.resizeCallbacks)i({width:this.width,height:this.height});P.trigger("scroll",{top:P.scrollTop})}}onResize(t){t({width:this.width,height:this.height}),this.resizeCallbacks.push(t)}offResize(t){let e=this.resizeCallbacks.indexOf(t);e>=0&&this.resizeCallbacks.splice(e,1)}resize(){this.applyResize()}applyThemeChange(){let t=this.theme.name,e=t==="dark"||t==="auto"&&this.darkQuery.matches;if(e!==this.theme.isDark){this.theme.isDark=e,G.setAttr("theme",this.themeOverride||(e?"dark":"light"));for(let i of this.themeChangedCallbacks)i(this.theme)}}setTheme(t){t!==this.theme.name&&(this.theme.name=t,this.setCookie("theme",t),this.applyThemeChange())}onThemeChange(t){this.themeChangedCallbacks.push(t)}getHash(){return window.location.hash.slice(1)}setHash(t){let e=document.body.scrollTop;window.location.hash=t,document.body.scrollTop=e}setURL(t,e=""){window.history.replaceState({},e,t),e&&(window.document.title=e)}getCookies(){let t=document.cookie.split(";"),e={};for(let i=0,s=t.length;i<s;++i){let n=t[i].split("=");e[decodeURIComponent(n[0]).trim()]=decodeURIComponent(n[1])}return e}getCookie(t){let e=document.cookie.match(new RegExp(`(^|;) ?${t}=([^;]*)(;|$)`));return e?e[2]:void 0}setCookie(t,e,i=60*60*24*365){let s=window.location.hostname.replace(/^[a-z]{2}\./,"");document.cookie=`${t}=${e};path=/;max-age=${i};domain=${s}`}deleteCookie(t){this.setCookie(t,"",-1)}setStorage(t,e){var i,s;let n=(t||"").split("."),r=yi(((i=this.localStorage)==null?void 0:i.getItem(We))||void 0,{}),o=r;for(let a=0;a<n.length-1;++a)o[n[a]]===void 0&&(o[n[a]]={}),o=o[n[a]];o[n[n.length-1]]=e,(s=this.localStorage)==null||s.setItem(We,JSON.stringify(r))}getStorage(t){var e;let i=yi((e=this.localStorage)==null?void 0:e.getItem(We),{});if(!t)return i;let s=(t||"").split("."),n=s.pop();for(let r of s){if(!(r in i))return;i=i[r]}return i[n]}deleteStorage(t){var e;t?this.setStorage(t,void 0):(e=this.localStorage)==null||e.setItem(We,"")}getActiveInput(){let t=document.activeElement;return(t==null?void 0:t.shadowRoot)&&(t=t.shadowRoot.activeElement),t===document.body?void 0:C(t)}onKey(t,e,i=!1){let s=V(t),n=i?"keyup":"keydown";document.addEventListener(n,r=>{let o=Qn[r.keyCode]||r.key;if(!s.includes(o))return;let a=this.getActiveInput();a&&a.is("input, textarea, [contenteditable]")||a&&["space","enter","tab"].includes(o)&&a.is("button, a, [tabindex]")||e(r,o)})}},m=window.BoostBrowser||new Nh;window.BoostBrowser=m;var Bh=/\bTrident\/[567]\b|\bMSIE (?:9|10)\.0\b/,qh=/\bAppleWebKit\/(\d+)\b/,Rh=/\bEdge\/12\.(\d+)\b/,Dh=Bh.test(navigator.userAgent)||+(navigator.userAgent.match(Rh)||[])[1]<10547||+(navigator.userAgent.match(qh)||[])[1]<537,Wi={};function Fh(){if(!Dh)return;Array.from(document.querySelectorAll("svg > use")).forEach(function(e){let i=e.getAttribute("xlink:href"),[s,n]=i.split("#");if(!s.length||!n)return;let r=e.parentNode;r.removeChild(e),s in Wi||(Wi[s]=fetch(s).then(a=>a.text())),Wi[s].then(a=>{let h=document.implementation.createHTMLDocument("");h.documentElement.innerHTML=a;let p=h.getElementById(n).cloneNode(!0),f=document.createDocumentFragment();for(;p.childNodes.length;)f.appendChild(p.firstChild);r.appendChild(f)})})}function ir(){document.addEventListener("keydown",t=>{if(t.keyCode===He.enter||t.keyCode===He.space){let e=m.getActiveInput();e&&e.hasAttr("tabindex")&&e.tagName!=="TEXTAREA"&&(t.preventDefault(),e.trigger("pointerdown",t),e.trigger("pointerstop",t),P.trigger("pointerstop",t),e.trigger("click",t))}})}var Ue=!1;setTimeout(()=>Ue=!0);var Hh="cubic-bezier(0.175, 0.885, 0.32, 1.275)",Wh="cubic-bezier(0.68, -0.275, 0.825, 0.115)",Tt={cancel:()=>{},promise:Promise.resolve()};function ht(t,e){if(e===0)return t(1,0,()=>{}),Tt;let i=Date.now(),s=Rt(),n=0,r=!0,o=()=>{r=!1,s.reject()};function a(){r&&(!e||n<=e)&&window.requestAnimationFrame(a);let h=Date.now()-i;t(e?Math.min(1,h/e):h,h-n,o),e&&h>=e&&s.resolve(),n=h}return a(),{cancel:o,promise:s.promise}}function ze(t,e=0,i=0){switch(t){case"quad":return e**2;case"cubic":return e**3;case"quart":return e**4;case"quint":return e**5;case"circ":return 1-Math.sqrt(1-e**2);case"sine":return 1-Math.cos(e*Math.PI/2);case"exp":return e<=0?0:Math.pow(2,10*(e-1));case"back":return i||(i=1.70158),e*e*((i+1)*e-i);case"elastic":return i||(i=.3),-Math.pow(2,10*(e-1))*Math.sin(((e-1)*2/i-.5)*Math.PI);case"swing":return .5-Math.cos(e*Math.PI)/2;case"spring":return 1-Math.cos(e*4.5*Math.PI)*Math.exp(-e*6);case"bounce":return e<1/11?1/64-7.5625*(.5/11-e)*(.5/11-e):e<3/11?1/16-7.5625*(2/11-e)*(2/11-e):e<7/11?1/4-7.5625*(5/11-e)*(5/11-e):1-7.5625*(1-e)*(1-e);default:return e}}function kt(t,e=0,i=0){if(e===0)return 0;if(e===1)return 1;let[s,n]=t.split("-");return n==="in"?ze(s,e,i):n==="out"?1-ze(s,1-e,i):e<=.5?ze(s,2*e,i)/2:1-ze(s,2*(1-e),i)/2}function R(t,e,i=400,s=0,n="ease-in-out"){if(!Ue)return Object.keys(e).forEach(l=>{let g=e[l];t.css(l,Array.isArray(g)?g[1]:g)}),Tt;n==="bounce-in"&&(n=Hh),n==="bounce-out"&&(n=Wh);let r="";m.isSafari&&(r=t._el.style.transition,t.css("transition","none"),m.redraw());let o=t._data.animation;o&&o.cancel();let a={},h={},c=Rt(),p=window.getComputedStyle(t._el);Object.keys(e).forEach(l=>{let g=e[l],w=Ae(l);h[w]=Array.isArray(g)?g[0]:p.getPropertyValue(l),a[w]=Array.isArray(g)?g[1]:g,s&&t.css(l,h[w])});let f=a.height;if(a.height==="auto"){let l=t.children.filter(g=>g.css("position")!=="absolute");a.height=`${H(l.map(g=>g.outerHeight))}px`}let d,x=!1;$t(()=>{x||(d=t._el.animate([h,a],{duration:i,easing:n,fill:"forwards"}),d.onfinish=()=>{t._el&&Object.keys(e).forEach(l=>t.css(l,l==="height"?f:a[l])),m.isSafari&&t.css("transition",r),c.resolve(),d.cancel()})},s);let A={cancel(){x=!0,t._el&&Object.keys(e).forEach(l=>t.css(l,t.css(l))),d&&d.cancel()},promise:c.promise};return setTimeout(()=>t._data.animation=A),A}var Uh=/matrix\([0-9.\-\s]+,[0-9.\-\s]+,[0-9.\-\s]+,[0-9.\-\s]+,([0-9.\-\s]+),([0-9.\-\s]+)\)/;function kh(t,e="fade",i=500,s=0){if(t.show(),!Ue)return Tt;let n=+t.css("opacity")||1;if(e==="fade")return R(t,{opacity:[0,n]},i,s);if(e==="pop"){let r=t.transform.replace(/scale\([0-9.]*\)/,"").replace(Uh,"translate($1px,$2px)");return R(t,{opacity:[0,n]},i,s),R(t,{transform:[`${r} scale(0.5)`,`${r} scale(1)`]},i,s,"bounce-in")}else{if(e==="descend")return R(t,{opacity:[0,1],transform:["translateY(-50%)","none"]},i,s);if(e.startsWith("draw")){let r=t.strokeLength;t.css("stroke-dasharray",`${r}px`),t.css("opacity")||t.css("opacity",1);let o=e==="draw-reverse"?`${2*r}px`:0,a={"stroke-dashoffset":[`${r}px`,o]},h=R(t,a,i,s,"linear");return h.promise.then(()=>t.css("stroke-dasharray","")),h}else if(e.startsWith("slide")){let r={opacity:[0,n],transform:["translateY(50px)","none"]};return e.includes("down")&&(r.transform[0]="translateY(-50px)"),e.includes("right")&&(r.transform[0]="translateX(-50px)"),e.includes("left")&&(r.transform[0]="translateX(50px)"),R(t,r,i,s)}else if(e.startsWith("reveal")){let r={opacity:[0,n],height:[0,"auto"]};return e.includes("left")&&(r.transform=["translateX(-50%)","none"]),e.includes("right")&&(r.transform=["translateX(50%)","none"]),R(t,r,i,s)}}return Tt}function Ah(t,e="fade",i=400,s=0,n=!1){if(!t._el)return Tt;if(!Ue)return t.hide(),Tt;if(t.css("display")==="none")return Tt;let r;if(e==="fade")r=R(t,{opacity:[1,0]},i,s);else if(e==="pop"){let o=t.transform.replace(/scale\([0-9.]*\)/,"");R(t,{opacity:[1,0]},i,s),r=R(t,{transform:[`${o} scale(1)`,`${o} scale(0.5)`]},i,s,"bounce-out")}else if(e==="ascend")r=R(t,{opacity:[1,0],transform:["none","translateY(-50%)"]},i,s);else if(e.startsWith("draw")){let o=t.strokeLength;t.css("stroke-dasharray",o);let h={"stroke-dashoffset":[e==="draw-reverse"?`${2*o}px`:0,`${o}px`]};r=R(t,h,i,s,"linear")}else if(e.startsWith("slide")){let o={opacity:0,transform:"translateY(50px)"};e.includes("up")&&(o.transform="translateY(-50px)"),r=R(t,o,i,s)}else if(e.startsWith("reveal")){let o={opacity:0,height:0};e.includes("left")&&(o.transform="translateX(-50%)"),e.includes("right")&&(o.transform="translateX(50%)"),r=R(t,o,i,s)}return r.promise.then(()=>n?t.remove():t.hide()),r}var Ru=Mt(["#cd0e66","#0f82f2","#22ab24","#fd8c00"]);var Gt=class extends Ct{constructor(t,e={}){super();this.$el=t,this.startPos=new u(0,0),this.position=new u(0,0),this.disabled=!1,this.options=Object.assign({moveX:!0,moveY:!0,withinBounds:!0},e),m.onResize(()=>this.updateBounds()),de(t,{start:()=>{this.disabled||(this.startPos=this.position,this.trigger("start"),G.addClass("grabbing"))},move:(i,s)=>{this.disabled||(this.setPosition(this.startPos.x+i.x-s.x,this.startPos.y+i.y-s.y),this.trigger("drag",{posn:this.position,pointerPosn:i}),this.checkTarget(i))},end:(i,s)=>{this.disabled||(this.trigger(i.equals(s)?"click":"end",{$target:this.$over}),this.options.$targets&&!this.$over&&this.options.resetOnMiss&&this.resetPosition(),this.$over=void 0,G.removeClass("grabbing"))},click:()=>this.trigger("click"),accessible:!0})}addTarget(t){var e;this.options.$targets||(this.options.$targets=[]),(e=this.options.$targets)==null||e.push(t)}removeTarget(t){var e,i;this.options.$targets=(e=this.options.$targets)==null?void 0:e.filter(s=>s!==t),((i=this.options.$targets)==null?void 0:i.length)||(this.options.$targets=void 0)}checkTarget(t){if(!this.options.$targets)return;let e=this.options.$targets.find(i=>i.boundsRect.contains(t));e!==this.$over&&(this.$over&&this.trigger("exit-target",{$target:this.$over}),e&&this.trigger("enter-target",{$target:e}),this.$over=e)}updateBounds(){if(!this.options.withinBounds)return this.bounds=void 0;if(this.options.bounds)return this.bounds=this.options.bounds;let t=this.bounds,e=this.options.$parent||this.$el.parent,i=e.type==="svg"?e.svgWidth:e.width,s=e.type==="svg"?e.svgHeight:e.height;this.bounds=new Ut(0,i,0,s),!i&&!s&&setTimeout(()=>this.updateBounds()),t&&this.setPosition(this.position.x*this.bounds.dx/t.dx||0,this.position.y*this.bounds.dy/t.dy||0)}setPosition(t,e){var i;let s=new u(this.options.moveX?t:0,this.options.moveY?e:0);this.bounds&&(s=s.clamp(this.bounds,(i=this.options.margin)!=null?i:0)),s=s.round(this.options.snap||1),this.options.round&&(s=this.options.round(s)),!s.equals(this.position)&&(this.position=s,this.options.useTransform?this.$el.translate(s.x,s.y):(this.options.moveX&&this.$el.css("left",`${s.x}px`),this.options.moveY&&this.$el.css("top",`${s.y}px`)),this.trigger("move",{posn:s}))}resetPosition(t=250){return Z(this,null,function*(){let e=this.position;this.$el.css({"pointer-events":"none"}),yield ht(i=>{let s=u.interpolate(e,this.startPos,i);this.setPosition(s.x,s.y)},t).promise,this.$el.css({"pointer-events":"initial"})})}},zh="position: fixed; top: 0; left: 0; width: 100%; height: 4px; background: #0f82f2; pointer-events: none; z-index: 9999; will-change: transform;";function sr(t,e){let i=e.regex.exec(t);if(i){i.shift();let s={};for(let[n,r]of e.params.entries())s[r]=i[n];return s}else return}function jh(t,e,i){return Z(this,null,function*(){return t.template?typeof t.template=="string"?t.template:t.template(e):(yield fetch(i+(i.indexOf("?")>=0?"&xhr=1":"?xhr=1"))).text()})}var nr=document.readyState==="complete";window.addEventListener("load",()=>setTimeout(()=>nr=!0));"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual");var Xh=class extends Ct{constructor(){super(...arguments);this.$viewport=P,this.views=[],this.active={path:"",hash:""},this.preloaded=!1,this.transition=!1,this.noLoad=!1,this.initialise=()=>{}}setup(t={}){t.$viewport&&(this.$viewport=t.$viewport),t.initialise&&(this.initialise=t.initialise),t.preloaded&&(this.preloaded=t.preloaded),t.transition&&(this.transition=t.transition),t.noLoad&&(this.noLoad=t.noLoad),t.click&&P.on("click",e=>this.onLinkClick(e)),t.history&&window.addEventListener("popstate",e=>Z(this,null,function*(){var i;if(!nr||!((i=e.state)==null?void 0:i.path))return;(yield this.load(e.state.path,e.state.hash))||window.history.pushState(this.active,"",this.active.path+this.active.hash)}))}view(t,{enter:e,exit:i,template:s}={}){let n=(t.match(/:\w+/g)||[]).map(f=>f.substr(1)),r=`${t.replace(/:\w+/g,"([\\w-]+)").replace("/","\\/")}\\/?`,o=t.includes("?")?"":"(\\?.*)?",h={regex:new RegExp(`^${r}${o}$`,"i"),params:n,enter:e,exit:i,template:s};this.views.push(h);let c=window.location.pathname+window.location.search,p=sr(c,h);!p||(this.active={path:c,hash:window.location.hash},window.history.replaceState(this.active,"",this.active.path+this.active.hash),m.ready(()=>{setTimeout(()=>{this.preloaded?(this.initialise(this.$viewport,p),h.enter&&h.enter(this.$viewport,p)):this.loadView(h,p)})}))}paths(...t){for(let e of t)this.view(e)}getView(t){for(let e of this.views){let i=sr(t,e);if(i)return{view:e,params:i}}}load(t,e){return Z(this,null,function*(){if(t===this.active.path&&e!==this.active.hash)return this.trigger("hashChange",e.slice(1)),this.trigger("change",t+e),this.active={path:t,hash:e},!0;let i=this.getView(t);return!i||this.beforeChange&&!(yield this.beforeChange())?!1:(this.active={path:t,hash:e},this.trigger("change",t+e),window.ga&&window.ga("send","pageview",t+e),this.noLoad?i.view.enter&&i.view.enter(this.$viewport,i.params):this.loadView(i.view,i.params),!0)})}loadView(t){return Z(this,arguments,function*(e,i={}){this.showLoadingBar();let s=this.active.path,n=yield jh(e,i,s);if(this.active.path!==s)return;yield this.$viewport.animate({opacity:0},200).promise,this.$viewport.removeChildren(),P.scrollTop=0,this.$viewport.html=n,m.resize(),Fh(),this.$viewport.animate({opacity:1},200),this.hideLoadingBar();let r=this.$viewport.$("title");r&&(document.title=r.text),this.initialise(this.$viewport,i),e.enter&&e.enter(this.$viewport,i),this.trigger("afterChange",{$viewport:this.$viewport})})}onLinkClick(t){if(t.metaKey||t.ctrlKey||t.shiftKey||t.defaultPrevented)return;let e=t.target;for(;e&&e.nodeName!=="A";)e=e.parentNode;if(!e||e.nodeName!=="A")return;let i=e;if(i.target||i.origin!==window.location.origin||i.hasAttribute("download")||i.getAttribute("rel")==="external")return;let s=i.getAttribute("href");s&&s.indexOf("mailto:")>-1||this.getView(i.pathname+i.search)&&(t.preventDefault(),this.goTo(i.pathname+i.search,i.hash))}goTo(t,e=""){return Z(this,null,function*(){let i=this.active.path+this.active.hash;(yield this.load(t,e))&&i!==this.active.path+this.active.hash&&window.history.pushState(this.active,"",t+e)})}replace(t,e=""){this.active={path:t,hash:e},window.history.replaceState(this.active,"",t+e)}back(){window.history.back()}forward(){window.history.forward()}showLoadingBar(){this.$loadingBar||(this.$loadingBar=S("div",{style:zh},P)),this.$loadingBar.css({transform:"translateX(-100%)",opacity:1}),this.$loadingBar.show(),this.animation=ht(t=>{this.$loadingBar.css("transform",`translateX(-${10+90*Math.exp(-4*t)}%)`)},3e3)}hideLoadingBar(){return Z(this,null,function*(){var t,e,i;(t=this.animation)==null||t.cancel(),yield(e=this.$loadingBar)==null?void 0:e.animate({transform:"none",opacity:0}).promise,(i=this.$loadingBar)==null||i.hide()})}},pe=new Xh;function Gh(t,e){let i=Array.from(t.childNodes);t.innerHTML=e;let s={};for(let n of Array.from(t.querySelectorAll("slot")))s[n.getAttribute("name")||""]=n;for(let n of i){let r=n.getAttribute&&n.getAttribute("slot")||"",o=s[r]||s[""];o&&o.parentNode.insertBefore(n,o)}for(let n of Object.values(s))n.parentNode.removeChild(n)}function rr(t){let e=[];for(let i of Array.from(t.children))i.tagName.startsWith("X-")?e.push(i):e.push(...rr(i));return e}var or=new Map,Kh=class extends HTMLElement{constructor(){super(...arguments);this.wasConnected=!1,this.isReady=!1}connectedCallback(){return Z(this,null,function*(){if(this.wasConnected){this._view.trigger("connected");return}this.wasConnected=!0,this.isReady=!1,this._view.created();let t=or.get(this._view.tagName)||{};t.template&&Gh(this,t.template);let e=rr(this).filter(i=>!i.isReady).map(i=>new Promise(s=>i.addEventListener("ready",s)));yield Promise.all(e),this._view.ready(),this.dispatchEvent(new CustomEvent("ready")),this.isReady=!0})}disconnectedCallback(){this._view.trigger("disconnected")}},M=class extends At{created(){}ready(){}};function $(t,e={}){return function(i){if(window.customElements.get(t)){console.warn(`Trying to declare the custom element ${t} twice!`);return}class s extends Kh{constructor(){super();this._view=new i(this)}}or.set(t.toUpperCase(),e),window.customElements.define(t,s)}}var Ui=class{constructor(e){this.clipEndTime=0;this.player=new Audio(e),this.player.preload="true",this.player.addEventListener("timeupdate",()=>{this.player.currentTime>=this.clipEndTime&&this.triggerCallback(!0)}),window.addEventListener("beforeunload",()=>this.player.pause())}playClip(e,i,s){this.triggerCallback(!1),this.player.currentTime=e,this.clipEndTime=i,this.clipCallback=s,this.player.play()}triggerCallback(e){if(!this.clipCallback)return;let i=this.clipCallback;this.clipCallback=void 0,this.player.pause(),i({ended:e})}pause(){this.triggerCallback(!1)}get isPlaying(){return!!this.clipCallback}},zi=!1,ji,Xi=class{constructor(e,i){this.audio=e;this.paragraphs=[];this.paragraphs=i.$$(".voice").map(s=>new ar(s,e));for(let[s,n]of this.paragraphs.entries())n.on("end",()=>{var r;if(this.paragraphs[s+1])this.paragraphs[s+1].play();else{let o=i.nextStep;o&&o.isShown&&((r=o.narration)==null||r.play())}})}play(){var e;this.audio.isPlaying||!zi||(e=this.paragraphs[0])==null||e.play()}},ar=class extends Ct{constructor(e,i){super();this.$p=e;this.audio=i;this.playing=void 0;this.sentences=e.$$(".sentence[data-timings]").map(s=>new hr(s,i)),this.$button=S("button",{class:"playback-btn",title:"Play Narration"}),this.$button.on("click",()=>{this.playing?this.audio.pause():this.play(),zi=!zi,ji=void 0}),e.prepend(this.$button),e.addClass("sentence-wrap");for(let[s,n]of this.sentences.entries())n.on("end",r=>{this.playing=void 0,r&&this.sentences[s+1]?setTimeout(()=>this.play(this.sentences[s+1]),200):(this.$button.removeClass("active"),r&&setTimeout(()=>this.trigger("end"),400))})}play(e){let i=e||this.sentences[0],s=i.$reveal;if(s&&s.css("visibility")==="hidden"){this.$button.removeClass("active"),ji=s,s.one("reveal",()=>{ji===s&&!this.audio.isPlaying&&this.play(i)});return}this.playing=i,this.playing.play(),this.$button.addClass("active");let n=this.$p.parents("x-tabbox .tab")[0];if(n){let a=n.parents("x-tabbox")[0];a.makeActive(n.index());let h=a.active;a.one("change",c=>{this.playing&&c!==h&&this.audio.pause()})}let r=this.$p.bounds,o=r.top+r.height-m.height+20;o>0&&P.scrollBy(o+100),setTimeout(()=>this.$button.focus(),800)}},hr=class extends Ct{constructor(e,i){super();this.$el=e;this.audio=i;let s=e.attr("data-timings").split("-");this.start=+s[0]/1e3,this.end=(+s[1]-200)/1e3}play(){this.$el.addClass("playing"),this.audio.playClip(this.start,this.end,({ended:e})=>{this.$el.removeClass("playing"),this.trigger("end",e)})}get $reveal(){return this.$el.parents(".reveal")[0]}};var Yh=Object.defineProperty,Jh=Object.getOwnPropertyDescriptor,me=(t,e,i,s)=>{for(var n=s>1?void 0:s?Jh(e,i):e,r=t.length-1,o;r>=0;r--)(o=t[r])&&(n=(s?o(e,i,n):o(n))||n);return s&&n&&Yh(e,i,n),n},cr=(t,e,i)=>new Promise((s,n)=>{var r=h=>{try{a(i.next(h))}catch(c){n(c)}},o=h=>{try{a(i.throw(h))}catch(c){n(c)}},a=h=>h.done?s(h.value):Promise.resolve(h.value).then(r,o);a((i=i.apply(t,e)).next())}),Kt,Zh=S("div",{class:"snackbar"},P),lr=class extends M{ready(){var t;Zh.append(this),(t=this.$("button"))==null||t.on("click",()=>this.close())}open(t=2e3){return cr(this,null,function*(){Kt!==this&&(Kt&&(yield Kt.close()),Kt=this,yield this.enter("pop",300).promise,this.setAttr("role","alert"),t&&setTimeout(()=>this.close(),t))})}close(){return cr(this,null,function*(){Kt===this&&(Kt=void 0,this.removeAttr("role"),yield this.exit("pop",300).promise)})}};lr=me([$("x-alert")],lr);var ur=undefined,fr=class extends M{ready(){if(this.children.length)return;let t=+this.attr("size")||24;this.css({width:`${t}px`,height:`${t}px`});let e=S("svg",{viewBox:"0 0 24 24"},this);if(e.css({width:`${t}px`,height:`${t}px`}),ur)this.onAttr("name",i=>e.html=ur[i]);else{let i=S("use",{},e);this.onAttr("name",s=>i.setAttr("href",`/icons.ec50cc2c.svg#${s}`))}}};fr=me([$("x-icon")],fr);var _t=S("div",{class:"modal-background"},P),Gi,ct=void 0,Ki=void 0;function Yi(){ct&&ct.canClose&&ct.close()}_t.on("click",Yi);m.onKey("escape",Yi);pe.on("change",Yi);_t.on("scrollwheel touchmove",t=>{t.preventDefault(),t.stopPropagation()});m.onKey("space up down pagedown pageup",t=>{ct&&(t.preventDefault(),t.stopPropagation())});var dr=class extends M{constructor(){super(...arguments);this.isOpen=!1,this.canClose=!0}ready(){this.canClose=!this.hasAttr("no-close"),this.$iframe=this.$("iframe[data-src]"),this.$video=this.$("video");let t=gt(`[data-modal=${this.id}]`);for(let i of t)i.on("click",()=>this.open());pe.on("afterChange",({$viewport:i})=>{let s=i.$$(`[data-modal=${this.id}]`);for(let n of s)n.on("click",()=>this.open())}),(this.hasClass("open")||m.getHash()===this.id)&&!ct&&this.open(!0),this.$("input")&&this.addClass("interactive");let e=this.$(".close");e&&e.on("click",()=>this.close());for(let i of this.$$(".btn"))i.on("click",()=>this.trigger("btn-click",i))}open(t=!1){if(this.isOpen)return;_t.setClass("light",this.hasClass("light")),ct?ct.close(!0):t?_t.show():_t.css("display")==="block"?Gi==null||Gi.cancel():_t.enter("fade",250),this.isOpen=!0,ct=this,this.$iframe&&this.$iframe.setAttr("src",this.$iframe.data.src),this.$video&&this.$video.play(),t?this.show():this.enter("pop",250).promise.then(()=>this.css("transform","")),this.setAttr("role","dialog"),this.trigger("open"),Ki=document.activeElement;let e=this.$('input, a, button, textarea, [tabindex="0"]');e&&e.focus()}close(t=!1,e=!1){!this.isOpen||(this.isOpen=!1,this.removeAttr("role"),ct=void 0,this.$iframe&&this.$iframe.setAttr("src",""),this.$video&&this.$video.pause(),t||(Gi=_t.exit("fade",250)),this.exit("pop",250).promise.then(()=>this.css("transform","")),e||this.trigger("close"),Ki&&Ki.focus())}};dr=me([$("x-modal")],dr);var pr=class extends M{constructor(){super(...arguments);this.isOpen=!1}ready(){this.animation=this.attr("animation")||"pop",this.$bubble=this.$(".popup-body"),this.$bubble.hide(),this.$(".popup-target").on("click",()=>this.toggle()),this.on("clickOutside",()=>this.close());for(let e of this.$bubble.$$("a"))e.on("click",()=>this.close());m.onKey("escape",()=>this.close())}toggle(){this.isOpen?this.close():this.open()}open(){this.isOpen||(this.isOpen=!0,this.addClass("active"),this.$bubble.enter(this.animation,150),this.$bubble.setAttr("role","dialog"),this.$bubble.focus())}close(){!this.isOpen||(this.isOpen=!1,this.removeClass("active"),this.$bubble.exit(this.animation,150),this.$bubble.removeAttr("role"))}};pr=me([$("x-popup")],pr);var mr=class extends M{constructor(){super(...arguments);this.$options={}}ready(){let t=this.children;this.$active=this.$(".active")||t[0],this.$active.addClass("active");for(let[e,i]of t.entries())!D(i.tagName,"A","BUTTON")&&!i.hasAttr("tabindex")&&i.setAttr("tabindex",0),i.on("click",()=>this.makeActive(i)),this.$options[i.attr("value")||e]=i;this.trigger("change",this.$active)}makeActive(t){t!==this.$active&&(this.$active.removeClass("active"),this.$active=t,t.addClass("active"),this.trigger("change",t))}bindVariable(t,e){t[e]===void 0&&(t[e]=this.$active.attr("value")),this.on("change",i=>t[e]=i.attr("value")),t.watch(()=>{let i=this.$options[t[e]];i&&this.makeActive(i)})}};mr=me([$("x-select")],mr);var Ji=12;function Qh(t){return`M${t},${t/2}a${t/2},${t/2},0,0,1,0,${t}A${t/2},${t/2},0,0,1,${t},${t/2}`}function tc(t){return`M ${t},0 C ${t/2},0,0,${t/2},0,${t}  s ${t/2},${t},${t},${t} s ${t}-${t/2},${t}-${t}     S ${t*1.5},0,${t},0 z M ${t*44.6/50},${t*76.1/50} L ${t*19.2/50},${t*48.8/50} l ${t*4/50}-${t*4.2/50}     l ${t*19.8/50},${t*11.9/50} l ${t*34.2/50}-${t*32.6/50} l ${t*3.5/50},${t*3.5/50} L ${t*44.6/50},${t*76.1/50} z`}var Zi=class extends M{constructor(){super(...arguments);this.completed=!1}ready(){this.r=+this.attr("r")||10,this.r1=this.r+Ji,this.$svg=S("svg",{width:2*this.r1,height:2*this.r1},this),this.$progress=S("path",{class:"pie",d:Qh(this.r),"stroke-width":this.r},this.$svg),this.onAttr("p",e=>this.setProgress(+e,!1))}setProgress(e,i=!0){if(e>.99)return this.complete(i);let s=Math.PI*this.r;this.$progress.css("stroke",e?"currentColor":"none"),this.$progress.css("stroke-dasharray",`${e*s} ${s}`)}complete(e=!0){if(this.completed||(this.completed=!0,this.$progress.css("stroke","none"),this.$progress.css("fill","currentColor"),this.$progress.setAttr("d",tc(this.r)),!e))return;let i=`translate(${this.r1} ${this.r1})`,s=S("g",{transform:i},this.$svg),n=ae(()=>S("line",{},s),18);ht(r=>{let o=this.r+Ji*kt("quint-out",r),a=this.r+Ji*r;for(let h=0;h<18;++h){let c=Math.cos(Math.PI*2*h/18),p=Math.sin(Math.PI*2*h/18);n[h].setLine({x:c*o,y:p*o},{x:c*a,y:p*a})}},800).promise.then(()=>s.remove())}};Zi=E([$("x-progress")],Zi);var gr="2.4.1",Qi="i5iSjo",vr="_av",ts="_au",es="(not set)";var je=[],Xe=class{static add(e,i,s){wr(e,i).add(s)}static remove(e,i,s){wr(e,i).remove(s)}constructor(e,i){this.context=e,this.methodName=i,this.isTask=/Task$/.test(i),this.originalMethodReference=this.isTask?e.get(i):e[i],this.methodChain=[],this.boundMethodChain=[],this.wrappedMethod=(...s)=>this.boundMethodChain[this.boundMethodChain.length-1](...s),this.isTask?e.set(i,this.wrappedMethod):e[i]=this.wrappedMethod}add(e){this.methodChain.push(e),this.rebindMethodChain()}remove(e){let i=this.methodChain.indexOf(e);i>-1&&(this.methodChain.splice(i,1),this.methodChain.length>0?this.rebindMethodChain():this.destroy())}rebindMethodChain(){this.boundMethodChain=[];for(let e,i=0;e=this.methodChain[i];i++){let s=this.boundMethodChain[i-1]||this.originalMethodReference.bind(this.context);this.boundMethodChain.push(e(s))}}destroy(){let e=je.indexOf(this);e>-1&&(je.splice(e,1),this.isTask?this.context.set(this.methodName,this.originalMethodReference):this.context[this.methodName]=this.originalMethodReference)}},lt=Xe;function wr(t,e){let i=je.filter(s=>s.context==t&&s.methodName==e)[0];return i||(i=new Xe(t,e),je.push(i)),i}var Yt=window.Element.prototype,pf=Yt.matches||Yt.matchesSelector||Yt.webkitMatchesSelector||Yt.mozMatchesSelector||Yt.msMatchesSelector||Yt.oMatchesSelector;var sc="80",nc="443",Ef=RegExp(":("+sc+"|"+nc+")$"),Sf=document.createElement("a");function Ge(t,e,i=void 0,s=void 0,n=void 0,r=void 0){if(typeof s=="function"){let o=i.get("buildHitTask");return{buildHitTask:a=>{a.set(t,null,!0),a.set(e,null,!0),s(a,n,r),o(a)}}}else return vt({},t,e)}var is={};function br(t,e){let i=t.get("trackingId"),s=is[i]=is[i]||{},n=()=>{clearTimeout(s.timeout),s.send&&lt.remove(t,"send",s.send),delete is[i],s.queue.forEach(r=>r())};clearTimeout(s.timeout),s.timeout=setTimeout(n,0),s.queue=s.queue||[],s.queue.push(e),s.send||(s.send=r=>(...o)=>{n(),r(...o)},lt.add(t,"send",s.send))}var vt=Object.assign||function(t,...e){for(let i=0,s=e.length;i<s;i++){let n=Object(e[i]);for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};function xr(t){return t.charAt(0).toUpperCase()+t.slice(1)}function $r(t){return typeof t=="object"&&t!==null}function wt(){return+new Date}var ge=function t(e){return e?(e^Math.random()*16>>e/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t)};function ss(t,e){let i=window.GoogleAnalyticsObject||"ga";window[i]=window[i]||function(...s){(window[i].q=window[i].q||[]).push(s)},window.gaDevIds=window.gaDevIds||[],window.gaDevIds.indexOf(Qi)<0&&window.gaDevIds.push(Qi),window[i]("provide",t,e),window.gaplugins=window.gaplugins||{},window.gaplugins[xr(t)]=e}var ns=class{constructor(){this.registry_={}}on(e,i){this.getRegistry_(e).push(i)}off(e=void 0,i=void 0){if(e&&i){let s=this.getRegistry_(e),n=s.indexOf(i);n>-1&&s.splice(n,1)}else this.registry_={}}emit(e,...i){this.getRegistry_(e).forEach(s=>s(...i))}getEventCount(){let e=0;return Object.keys(this.registry_).forEach(i=>{e+=this.getRegistry_(i).length}),e}getRegistry_(e){return this.registry_[e]=this.registry_[e]||[]}},Mr=ns;var Ke="autotrack",Jt={},rs=!1,ve,Q=class extends Mr{static getOrCreate(e,i,s){let n=[Ke,e,i].join(":");return Jt[n]||(Jt[n]=new Q(n,s),rs||oc()),Jt[n]}static isSupported_(){if(ve!=null)return ve;try{window.localStorage.setItem(Ke,Ke),window.localStorage.removeItem(Ke),ve=!0}catch(e){ve=!1}return ve}static get_(e){return window.localStorage.getItem(e)}static set_(e,i){window.localStorage.setItem(e,i)}static clear_(e){window.localStorage.removeItem(e)}constructor(e,i={}){super();this.key_=e,this.defaults_=i,this.cache_=null}get(){if(this.cache_)return this.cache_;if(Q.isSupported_())try{this.cache_=os(Q.get_(this.key_))}catch(e){}return this.cache_=vt({},this.defaults_,this.cache_)}set(e){if(this.cache_=vt({},this.defaults_,this.cache_,e),Q.isSupported_())try{Q.set_(this.key_,JSON.stringify(this.cache_))}catch(i){}}clear(){if(this.cache_={},Q.isSupported_())try{Q.clear_(this.key_)}catch(e){}}destroy(){delete Jt[this.key_],Object.keys(Jt).length||ac()}},Ye=Q;function oc(){window.addEventListener("storage",Cr),rs=!0}function ac(){window.removeEventListener("storage",Cr),rs=!1}function Cr(t){let e=Jt[t.key];if(e){let i=vt({},e.defaults_,os(t.oldValue)),s=vt({},e.defaults_,os(t.newValue));e.cache_=s,e.emit("externalSet",s,i)}}function os(t){let e={};if(t)try{e=JSON.parse(t)}catch(i){}return e}var hc=1e3,cc=60*hc,Je={},Pt=class{static getOrCreate(e,i,s){let n=e.get("trackingId");return Je[n]?Je[n]:Je[n]=new Pt(e,i,s)}constructor(e,i,s){this.tracker=e,this.timeout=i||Pt.DEFAULT_TIMEOUT,this.timeZone=s,this.sendHitTaskOverride=this.sendHitTaskOverride.bind(this),lt.add(e,"sendHitTask",this.sendHitTaskOverride);try{this.dateTimeFormatter=new Intl.DateTimeFormat("en-US",{timeZone:this.timeZone})}catch(r){}let n={hitTime:0,isExpired:!1};this.store=Ye.getOrCreate(e.get("trackingId"),"session",n),this.store.get().id||this.store.set({id:ge()})}getId(){return this.store.get().id}isExpired(e=this.getId()){if(e!=this.getId())return!0;let i=this.store.get();if(i.isExpired)return!0;let s=i.hitTime;if(s){let n=new Date,r=new Date(s);if(n-r>this.timeout*cc||this.datesAreDifferentInTimezone(n,r))return!0}return!1}datesAreDifferentInTimezone(e,i){return this.dateTimeFormatter?this.dateTimeFormatter.format(e)!=this.dateTimeFormatter.format(i):!1}sendHitTaskOverride(e){return i=>{e(i);let s=i.get("sessionControl"),n=s=="start"||this.isExpired(),r=s=="end",o=this.store.get();o.hitTime=wt(),n&&(o.isExpired=!1,o.id=ge()),r&&(o.isExpired=!0),this.store.set(o)}}destroy(){lt.remove(this.tracker,"sendHitTask",this.sendHitTaskOverride),this.store.destroy(),delete Je[this.tracker.get("trackingId")]}},as=Pt;Pt.DEFAULT_TIMEOUT=30;var hs={CLEAN_URL_TRACKER:1,EVENT_TRACKER:2,IMPRESSION_TRACKER:3,MEDIA_QUERY_TRACKER:4,OUTBOUND_FORM_TRACKER:5,OUTBOUND_LINK_TRACKER:6,PAGE_VISIBILITY_TRACKER:7,SOCIAL_WIDGET_TRACKER:8,URL_CHANGE_TRACKER:9,MAX_SCROLL_TRACKER:10},Er=Object.keys(hs).length;function Sr(t,e){uc(t),lc(t,e)}function fc(t){return parseInt(t||"0",16).toString(2)}function dc(t){return parseInt(t||"0",2).toString(16)}function pc(t,e){if(t.length<e){let i=e-t.length;for(;i;)t="0"+t,i--}return t}function mc(t,e){return t.substr(0,e)+1+t.substr(e+1)}function lc(t,e){let i=t.get("&"+ts),s=pc(fc(i),Er);s=mc(s,Er-e),t.set("&"+ts,dc(s))}function uc(t){t.set("&"+vr,gr)}var we="hidden",it="visible",Zt=ge(),kr=1e3,Ar=class{constructor(e,i){if(Sr(e,hs.PAGE_VISIBILITY_TRACKER),!document.visibilityState)return;let s={sessionTimeout:as.DEFAULT_TIMEOUT,visibleThreshold:5*kr,sendInitialPageview:!1,fieldsObj:{}};this.opts=vt(s,i),this.tracker=e,this.lastPageState=document.visibilityState,this.visibleThresholdTimeout_=null,this.isInitialPageviewSent_=!1,this.trackerSetOverride=this.trackerSetOverride.bind(this),this.handleChange=this.handleChange.bind(this),this.handleWindowUnload=this.handleWindowUnload.bind(this),this.handleExternalStoreSet=this.handleExternalStoreSet.bind(this),this.store=Ye.getOrCreate(e.get("trackingId"),"plugins/page-visibility-tracker"),this.store.on("externalSet",this.handleExternalStoreSet),this.session=as.getOrCreate(e,this.opts.sessionTimeout,this.opts.timeZone),lt.add(e,"set",this.trackerSetOverride),window.addEventListener("unload",this.handleWindowUnload),document.addEventListener("visibilitychange",this.handleChange),br(this.tracker,()=>{document.visibilityState==it?(this.opts.sendInitialPageview&&(this.sendPageview({isPageLoad:!0}),this.isInitialPageviewSent_=!0),this.store.set({time:wt(),state:it,pageId:Zt,sessionId:this.session.getId()})):this.opts.sendInitialPageview&&this.opts.pageLoadsMetricIndex&&this.sendPageLoad()})}handleChange(){if(!(document.visibilityState==it||document.visibilityState==we))return;let e=this.getAndValidateChangeData(),i={time:wt(),state:document.visibilityState,pageId:Zt,sessionId:this.session.getId()};document.visibilityState==it&&this.opts.sendInitialPageview&&!this.isInitialPageviewSent_&&(this.sendPageview(),this.isInitialPageviewSent_=!0),document.visibilityState==we&&this.visibleThresholdTimeout_&&clearTimeout(this.visibleThresholdTimeout_),this.session.isExpired(e.sessionId)?(this.store.clear(),this.lastPageState==we&&document.visibilityState==it&&(clearTimeout(this.visibleThresholdTimeout_),this.visibleThresholdTimeout_=setTimeout(()=>{this.store.set(i),this.sendPageview({hitTime:i.time})},this.opts.visibleThreshold))):(e.pageId==Zt&&e.state==it&&this.sendPageVisibilityEvent(e),this.store.set(i)),this.lastPageState=document.visibilityState}getAndValidateChangeData(){let e=this.store.get();return this.lastPageState==it&&e.state==we&&e.pageId!=Zt&&(e.state=it,e.pageId=Zt,this.store.set(e)),e}sendPageVisibilityEvent(e,{hitTime:i}={}){let s=this.getTimeSinceLastStoredChange(e,{hitTime:i});if(s&&s>=this.opts.visibleThreshold){let n=Math.round(s/kr),r={transport:"beacon",nonInteraction:!0,eventCategory:"Page Visibility",eventAction:"track",eventValue:n,eventLabel:es};i&&(r.queueTime=wt()-i),this.opts.visibleMetricIndex&&(r["metric"+this.opts.visibleMetricIndex]=n),this.tracker.send("event",Ge(r,this.opts.fieldsObj,this.tracker,this.opts.hitFilter))}}sendPageLoad(){let e={transport:"beacon",eventCategory:"Page Visibility",eventAction:"page load",eventLabel:es,["metric"+this.opts.pageLoadsMetricIndex]:1,nonInteraction:!0};this.tracker.send("event",Ge(e,this.opts.fieldsObj,this.tracker,this.opts.hitFilter))}sendPageview({hitTime:e,isPageLoad:i}={}){let s={transport:"beacon"};e&&(s.queueTime=wt()-e),i&&this.opts.pageLoadsMetricIndex&&(s["metric"+this.opts.pageLoadsMetricIndex]=1),this.tracker.send("pageview",Ge(s,this.opts.fieldsObj,this.tracker,this.opts.hitFilter))}trackerSetOverride(e){return(i,s)=>{let n=$r(i)?i:{[i]:s};n.page&&n.page!==this.tracker.get("page")&&this.lastPageState==it&&this.handleChange(),e(i,s)}}getTimeSinceLastStoredChange(e,{hitTime:i}={}){return e.time?(i||wt())-e.time:0}handleExternalStoreSet(e,i){e.time!=i.time&&i.pageId==Zt&&i.state==it&&!this.session.isExpired(i.sessionId)&&this.sendPageVisibilityEvent(i,{hitTime:e.time})}handleWindowUnload(){this.lastPageState!=we&&this.handleChange()}remove(){this.store.destroy(),this.session.destroy(),lt.remove(this.tracker,"set",this.trackerSetOverride),window.removeEventListener("unload",this.handleWindowUnload),document.removeEventListener("visibilitychange",this.handleChange)}};ss("pageVisibilityTracker",Ar);ir();G.addClass((m.isMobile?"is":"not")+"-mobile");m.isSafari&&G.addClass("is-safari");setTimeout(()=>G.addClass("ready"));window.addEventListener("keydown",t=>{t.keyCode===9&&G.addClass("is-tabbing")});window.addEventListener("mousedown",()=>{G.removeClass("is-tabbing")});var Tr=C(".cookie-warning");Tr&&C("#yes-to-cookies").on("click",function(){Tr.exit("pop",300),m.setCookie("cookie_consent",1)});var cs=C("x-modal#privacy");cs&&cs.$("form").on("submit",t=>{t.preventDefault(),fetch("/profile/accept-policies",{method:"POST"}),cs.close()});var _r;(_r=navigator.serviceWorker)==null||_r.register("/service_worker.js",{scope:"/"}).catch(()=>console.warn("Unable to register Service Worker."));window.addEventListener("beforeinstallprompt",t=>{t.prompt()});var Pr;(Pr=C("#skip-nav"))==null||Pr.on("click",()=>{var e;(e=(C("article")||C(".panel.active")||C(".body")||P).$("input, button, a, textarea, [contenteditable], [tabindex]"))==null||e.focus()});var ls=C("nav x-popup");if(ls){let t=ls.$$(".popup-body a, .popup-body button");for(let e of t)e.on("click",()=>ls.close())}var gc=gt("#language .locale-link");pe.on("change",t=>{for(let e of gc)e.setAttr("href",e.data.host+t)});var Ze=C("#dark-mode");Ze&&(Ze.checked=m.theme.isDark,Ze.on("change",()=>m.setTheme(Ze.checked?"dark":"light")));var ye={},It=C("#search"),yt=It==null?void 0:It.$(".form-field input"),Qe=It==null?void 0:It.$(".search-body");ye[""]=(Qe==null?void 0:Qe.html)||"";function vc(t){return t=t.trim().replace(/\s+/," ").toLowerCase().slice(0,50),t==="pi"||t.length>=3?t:""}function wc(t){return Y(this,null,function*(){if(t=encodeURIComponent(vc(t)),t in ye)return ye[t];let e=yield fetch(`/api/search?q=${t}`);return e.ok?ye[t]=yield e.text():ye[t]=""})}var yc=0,Ir=0;function Or(t){return Y(this,null,function*(){let e=yc+=1,i=yield wc(t);e<=Ir||(Ir=e,Qe.html=i)})}yt==null||yt.change(t=>{m.setCookie("search",t,60*60*24),setTimeout(()=>{yt.value===t&&Or(t)},300)});(yt==null?void 0:yt.value)&&It.one("open",()=>Or(yt.value));var Lr='<label class="target"><input maxlength="15" autocomplete="off" aria-label="Fill in this blank"></label>';function Vr(t){if(t.match("^[0-9]+/[0-9]+$")){let e=t.split("/");return+e[0]/+e[1]}else return nn(t)}var us=class extends M{constructor(){super(...arguments);this.solution="";this.solutionNum=NaN;this.solutionDisplay="";this.range=0;this.input="";this.hint="";this.attempts=0;this.placeholder="???";this.done=!1}ready(){if(this.$input=this.$("input"),this.$target=this.$(".target"),this.solution=this.attr("solution"),this.solution.indexOf("\xB1")>=0){let e=this.solution.split("\xB1");this.solution=e[0].trim(),this.range=+e[1]}this.solutionNum=Vr(this.solution),this.solutionDisplay=this.solution,this.hint=this.attr("hint"),this.removeAttr("solution"),this.removeAttr("hint"),this.$input.setInputPattern(this.solution),this.hasAttr("placeholder")&&(this.placeholder=this.attr("placeholder")),this.$input.setAttr("placeholder",this.placeholder),this.removeAttr("placeholder"),this.$input.change(e=>{this.input=e,this.isCorrect&&(this.solve(),this.trigger("valid",e),this.moveCursor())}),this.$input.onKeyDown("enter",()=>this.$input.blur()),this.$input.on("focus",()=>{this.addClass("on"),this.removeClass("invalid"),this.$input.setAttr("placeholder"," ")}),this.$input.on("blur",()=>{if(this.removeClass("on"),this.setClass("invalid",!!this.input&&!this.done),this.$input.setAttr("placeholder",this.placeholder),this.input&&!this.done){this.attempts+=1;let e=this.attempts>=(this.hint?4:3)?`Hmmm\u2026 maybe try ${this.solution}?`:this.attempts>=2?this.hint:void 0;this.trigger("invalid",{hint:e})}})}setup(e,i,s){var n;this.goal=i,this.$step=e,((n=s==null?void 0:s.scores)==null?void 0:n.includes(i))&&this.solve(!0),this.one("valid",()=>{e.addHint("correct"),e.score(this.solvedBlank?this.solvedBlank.goal:i)}),this.on("invalid",r=>e.addHint(r.hint||"incorrect",{class:"incorrect"}))}get isCorrect(){if(this.done)return!0;if(this.linkedBlanks){let e=this.linkedBlanks.map(i=>i.solvedBlank);return this.solvedBlank=this.linkedBlanks.find(i=>{if(i.done&&!i.solvedBlank||e.includes(i))return!1;if(i.checkAnswer(this.input))return!0}),this.solvedBlank&&(this.solutionDisplay=this.solvedBlank.solution),!!this.solvedBlank}return this.checkAnswer(this.input)}checkAnswer(e){let i=Vr(e);return e.toLowerCase()===this.solution.toLowerCase()?!0:this.range&&Math.abs(i-this.solutionNum)<=this.range?(this.solutionDisplay=e,!0):k(i,this.solutionNum)||Si(i)===this.solution||e===Si(this.solutionNum)}moveCursor(){if(!this.$step)return;let e=this.$step.$blanks[this.$step.$blanks.indexOf(this)+1];!e||e.done||e.tagName==="X-BLANK-MC"||e.css("visibility")==="hidden"||!e.bounds.width||e.focus()}solve(e=!1){this.done=!0,this.$input.remove(),this.$target.html=this.solutionDisplay,this.addClass("done"),this.trigger("solve",{solution:this.solutionDisplay,restore:e})}focus(){this.$input.focus()}blur(){this.$input.blur()}};us=E([$("x-blank",{template:Lr})],us);var Nr='<span class="target" slot="target" tabindex="0" aria-label="Fill in this blank">???</span><div class="popup"><slot></slot></div>';var fs=class extends M{constructor(){super(...arguments);this.done=!1}ready(){this.$target=this.$(".target"),this.$popup=this.$(".popup");let e=this.$popup.$$(".choice");this.solution=e[0].html,j.shuffle(ke(e.length)).forEach(n=>{this.$popup.append(e[n]),e[n].on("click",()=>{this.removeClass("on"),e[n].blur(),n?(this.$target.html=e[n].html,this.addClass("invalid"),this.trigger("invalid")):(this.solve(),this.trigger("valid",this.solution))})});let s=this.$target.bounds.left+this.$popup.width>m.width-15;this.setClass("left",s),jt(this,{enter:()=>{if(this.done)return;this.addClass("on");let n=this.$target.bounds,r=this.$popup.width,o=this.$popup.height,a=m.width-10-n.left,h=r<a,c=n.right-r>10,p=n.top+n.height+o>m.height-10;this.setClass("left",c&&!h),this.setClass("top",p),this.$popup.css("max-width",!c&&!h?`${a}px`:"none")},exit:()=>{this.removeClass("on")},delay:100,exitDelay:400,$clickTarget:this.$target})}setup(e,i,s){var n;((n=s==null?void 0:s.scores)==null?void 0:n.includes(i))&&this.solve(!0),this.one("valid",()=>{e.addHint("correct"),e.score(i)}),this.on("invalid",r=>e.addHint(r.hint||"incorrect",{class:"incorrect"}))}solve(e=!1){this.done=!0,this.$target.html=this.solution,this.removeClass("on invalid"),this.addClass("done"),this.trigger("solve",{solution:this.solution,restore:e}),setTimeout(()=>this.$popup.remove(),250),this.$target.removeAttr("tabindex")}};fs=E([$("x-blank-mc",{template:Nr})],fs);var Br='<div class="text-area" contenteditable="true"></div><div class="toolbar"><button class="command" data-command="bold"><x-icon name="bold" size="20"></x-icon></button><button class="command" data-command="italic"><x-icon name="italic" size="20"></x-icon></button><button class="command" data-command="underline"><x-icon name="underline" size="20"></x-icon></button><div class="space"></div><button class="btn btn-green submit"><x-icon name="check"></x-icon> Done</button></div>';var qr=40,Rr="free-text",ds=class extends M{setup(e,i,s){var c,p;let n=this.$(".text-area"),r=this.$(".toolbar .submit"),o=((c=s==null?void 0:s.data)==null?void 0:c[Rr])||"";o&&(n.html=o);for(let f of this.$$(".toolbar .command")){let d=f.data.command.split(":");f.on("click",()=>document.execCommand(d[0],!1,d[1]))}let a=o,h=Dt(()=>{a!==o&&e.storeData(Rr,o),a=o},5e3);n.on("change keyup input paste",()=>{o=n.html.replace(/&nbsp;/g," ").trim().slice(0,500).trim(),r.setClass("invisible",o.length<qr),h()}),((p=s==null?void 0:s.scores)==null?void 0:p.includes(i))?r.remove():(r.setClass("invisible",o.length<qr),r.on("click",()=>{h(),e.score(i),r.exit("pop"),this.trigger("submit")}))}};ds=E([$("x-free-text",{template:Br})],ds);var Dr='<div class="wrapper"><div class="panel"><slot></slot></div></div><div class="nav"><button class="btn back" aria-label="Previous Step"><x-icon name="left"></x-icon></button><button class="btn next" aria-label="Next Step"><x-icon name="right"></x-icon></button><div class="dots"></div></div>';var ps=class extends M{ready(){let e=this.$(".wrapper"),i=this.$(".panel"),s=i.children,n=this.$(".next"),r=this.$(".back"),o=this.$(".dots"),a=s.map(()=>S("div",{class:"dot"},o)),h=s.length,c=+this.attr("slide-width")||void 0,p=this.width,f=1,d=p,x=0,A=0,l=O=>{A=O,i.translate(O,0),this.trigger("move",O)},g=O=>{x=O;for(let[tt,oe]of a.entries())oe.setClass("on",tt>=O&&tt<O+f);n.setClass("disabled",O===h-f),r.setClass("disabled",O===0),this.trigger("change",O)};m.onResize(()=>{p=this.width,f=c?Math.ceil(p/c):1,d=p/f;for(let O of s)O.css("width",d+"px");i.css("width",h*d+"px"),l(-x*d),g(x)});let w="quad",y=500,v,b,L,K,pi=!1,Gs=()=>{v=Date.now()-K,l(b+L*kt(w,v/y)),!pi&&v<y?requestAnimationFrame(Gs):this.trigger("slide-end")},mi=O=>{pi=!1,v=0,b=A,L=-O*d-A,K=Date.now(),g(O),Gs()};n.on("click",()=>{w="quad",x<h-f&&mi(x+1)}),r.on("click",()=>{w="quad",x>0&&mi(x-1)});let Ks,gi,vi,Se;de(e,{start:O=>{pi=!0,Ks=A,gi=O.x,Se=vi=gi},move:O=>{vi=Se,Se=O.x;let tt=Ks-gi+O.x,oe=-(h-f)*d,Fo=tt>0?tt/4:tt<oe?oe+(tt-oe)/4:tt;l(Fo),this.css("pointer-events","none")},end:()=>{let O=Se-vi,tt=O>12?1:O<-12?-1:0;w="quad-out",mi(q(Math.round(-A/d-tt),0,h-f)),setTimeout(()=>this.css("pointer-events","auto"))}})}};ps=E([$("x-gallery",{template:Dr})],ps);var Fr='<svg width="70" height="80"><path d="M20.5,7.4,27.2,24c-1.9-4.7,6-7.1,8-2.3l1.4,3.6c-1.9-4.8,6.1-7.1,8-2.3l1.3,3.1c-2-4.7,5.7-6.5,7.7-1.8,3.3,7.8,5.8,13.6,9,21.3S60.8,56.2,65,66.7L44.9,75A13.9,13.9,0,0,0,36,66.9c-7.7-2.2-11.4-8.3-18.4-14.3a44.2,44.2,0,0,0-9.5-6.5c-2.6-1.5-4.2-3.4-2.2-5.7,3.5-4.1,9.3-1.3,13.1,1.5,1.6,1.2,4.4,4.1,5.9,3.8s1.7-.8,1-2.6L12.8,10.5c-1.9-4.7,5.8-7.9,7.7-3.1Z"></path></svg>';function ms(t,e){let i=e.positionLeft-t.positionLeft+e.width/2,s=e.positionTop-t.positionTop+e.height/2;return new u(i,s)}function Hr(t){return t?new u(...t.split(",").map(e=>+e)):void 0}var gs=class extends M{constructor(){super(...arguments);this.doAnimation=!1}created(){this.slide=Hr(this.attr("slide")),this.shift=Hr(this.attr("offset"))}ready(){this.$target=C(this.attr("target")),this.$target&&(this.$target.on("click pointerdown focus",()=>this.stop()),this.hasAttr("start")&&this.start())}setTarget(e,i,s){this.$target=typeof e=="string"?C(e):e,i&&(this.slide=i),s&&(this.slide=s)}start(e){this.doAnimation||!this.from&&!this.$target||(this.doAnimation=!0,e&&(this.slide=e),this.slide||this.$end?this.runSlideAnimation():this.runClickAnimation())}startSlide(e,i){this.$target=e,this.$end=i,this.start()}stop(){this.doAnimation=!1}runSlideAnimation(){return Y(this,null,function*(){this.show();let e=this.from||ms(this,this.$target);this.shift&&(e=e.add(this.shift));let i=this.slide?e.add(this.slide):ms(this,this.$end),s=`translate(${e.x-15}px,${e.y-10}px)`,n=`translate(${i.x-15}px,${i.y-10}px)`;yield this.animate({transform:[s+" scale(2)",s],opacity:[0,1]},300).promise,yield this.animate({transform:[s,n]},1e3).promise,yield this.animate({transform:[n,n+" scale(2)"],opacity:[1,0]},300).promise,this.hide(),setTimeout(()=>{this.doAnimation&&this.runSlideAnimation()},1e3)})}runClickAnimation(){return Y(this,null,function*(){this.show();let e=this.from||ms(this,this.$target);this.shift&&(e=e.add(this.shift));let i=`translate(${e.x-15}px,${e.y-10}px)`;yield this.animate({transform:[i+" scale(2)",i],opacity:[0,1]},500).promise,yield this.animate({transform:[i,i+" scale(2)"],opacity:[1,0]},500,200).promise,this.hide(),setTimeout(()=>{this.doAnimation&&this.runClickAnimation()},1e3)})}};gs=E([$("x-gesture",{template:Fr})],gs);var vs='<span class="target" tabindex="0"><slot></slot></span><div class="popup"></div>';var bc=JSON.parse(C("#glossary").text),xc=JSON.parse(C("#bios").text),ws=600,ti;m.onResize(()=>{ti&&ti.hide()});var ei=class extends M{ready(){this.xid=this.attr("xid"),this.$target=this.$(".target"),this.$popup=this.$(".popup"),this.$popup.html=this.body()||"",this.setClass("left",m.width>ws&&this.$target.bounds.left+this.$popup.width>m.width-15),jt(this,{enter:()=>this.show(),exit:()=>this.hide(),delay:100,exitDelay:200,$clickTarget:this.$target,canFocusWithin:!0,preventMouseover:()=>m.width<=ws})}show(){if(ti=this,this.addClass("on"),m.width<=ws){let o=C("#glossary-modal");return o.$(".modal-body").html=this.body(),o.open()}let e=this.$target.bounds,i=this.$popup.width,s=this.$popup.height,n=e.top+e.height+s<m.height-10,r=e.top-s>54;this.setClass("top",r&&!n),this.setClass("left",e.left+i>m.width-15)}hide(){ti=void 0,this.removeClass("on")}body(){let e=bc[this.xid];if(!e)return console.warn("missing gloss:",this.xid);let i=e.text;return e.image&&(i+=`<img class="gloss-img" alt="" src="/content/shared/glossary/${e.image}"/>`),e.link&&(location.pathname===e.link.split("#")[0]||(i+=`<p><a href="${e.link}" class="btn btn-white btn-small">Learn more\u2026</a></p>`)),i}};ei=E([$("x-gloss",{template:vs})],ei);var ys=class extends ei{body(){let e=xc[this.xid];if(!e)return console.warn("missing bio:",this.xid);let i=`<img class="bio-img" alt="" src="/content/shared/bios/${this.xid}.jpg"/>`,s=e.born?`<p><a href="/timeline/${this.xid}" class="btn btn-white btn-small" target="_blank">Timeline</a></p>`:"";return(e.image===!1?"":i)+e.bio+s}};ys=E([$("x-bio",{template:vs})],ys);var Wr='<div class="wrap"><img alt=""><div class="credit"></div><button class="zoom"><x-icon name="fullscreen" size="24"></x-icon></button><slot></slot></div>';var $c=document.createElement("a").relList.supports("ar"),ii=!1,bs={x:0,y:0,s:1},Ur,Ot=S("div",{class:"lightbox-overlay"},P),ut=S("div",{class:"lightbox-img"},Ot);function Mc(t,e,i){ii=!0,Ur=t,Ot.show(),ut.show();let s=t.bounds,n=ut.bounds,r=s.left+s.width/2-n.left-n.width/2,o=s.top+s.height/2-n.top-n.height/2,a=Math.max(s.width/n.width,s.height/n.height);bs={x:r,y:o,s:a},ut.css("background-image",`url(${i}), url(${e})`),ut.css("transform",`translate(${r}px, ${o}px) scale(${a})`),m.redraw(),ut.addClass("transitions"),m.redraw(),t.css("visibility","hidden"),Ot.addClass("on"),ut.css("transform","scale(1) translate(0,0)")}function zr(){!ii||(ii=!1,Ot.removeClass("on"),ut.setTransform(bs,0,bs.s),setTimeout(()=>{Ur.css("visibility","visible"),Ot.css("display","none"),ut.css("transform","none"),ut.removeClass("transitions")},400))}Ot.on("click touchmove",zr);m.onKey("escape",zr);Ot.on("scrollwheel touchmove",t=>{t.preventDefault(),t.stopPropagation()});m.onKey("space up down left right pagedown pageup",t=>{ii&&(t.preventDefault(),t.stopPropagation())});var xs=class extends M{ready(){let e=this.attr("src"),i=this.$(".wrap"),s=this.attr("width"),n=this.attr("height");this.css("width",s+"px"),i.css("padding-bottom",+n/+s*100+"%");let r=i.$("img");r.setAttr("src",e),r.setAttr("alt",this.attr("alt")||""),r.setAttr("width",s),r.setAttr("height",n),e.endsWith(".gif")&&r.on("click",()=>r.setAttr("src",e));let o=i.$(".credit"),a=this.attr("credit");a?o.text=a:o.remove();let h=i.$(".zoom");if(this.hasAttr("lightbox")){this.addClass("interactive");let c=e.replace(/\.(?=[^.]*$)/,"-large.");this.on("click",()=>Mc(this,e,c))}else h.remove();if($c&&this.hasAttr("ar")){let c=S("a",{href:this.attr("ar"),rel:"ar"});i.prepend(c),c.append(r)}}};xs=E([$("x-img",{template:Wr})],xs);var $s=class extends M{constructor(){super(...arguments);this.correctCount=0;this.solvedCount=0;this.isSolved=!1}setup(e,i,s){var a;let n=this.children,r=n.map(()=>!1);for(let[h,c]of n.entries()){let p=c.data.error,f=p?"incorrect":"correct";p||(this.correctCount+=1),c.one("click",()=>{r[h]||this.isSolved||(e.addHint(p||"correct",{class:f}),c.addClass(f),p||(this.solvedCount+=1,e.score("picker-"+h),this.checkSolved()))})}let o=((a=s==null?void 0:s.scores)==null?void 0:a.filter(h=>h.startsWith("picker-")))||[];for(let h of o){let c=+h.slice(7);r[c]=!0,n[c].addClass("correct")}this.solvedCount=o.length,this.checkSolved()}checkSolved(){this.solvedCount<this.correctCount||(this.addClass("solved"),this.isSolved=!0)}};$s=E([$("x-picker")],$s);var jr='<button class="play" aria-label="Play Slider"><x-icon name="play" size="32"></x-icon></button><div class="bar"><div class="knob"></div></div>';var Ms=class extends M{constructor(){super(...arguments);this.current=0}ready(){this.onAttr("steps",o=>this.steps=+o),this.speed=+this.attr("speed")||1;let e=this.$(".bar"),i=this.$(".knob"),s=this.$(".play");this.hasAttr("no-play")?s.remove():s.on("click",()=>this.play());let n=this.hasAttr("continuous"),r=this.hasAttr("snap")?e.width/this.steps:.001;this.drag=new Gt(i,{moveY:!1,snap:r}),this.drag.on("start",()=>{this.animation&&this.animation.cancel(),this.animation=void 0}),this.drag.on("move",({posn:o})=>{let a=o.x/this.drag.bounds.dx*this.steps;n||(a=Math.round(a)),!k(a,this.current)&&(this.current=a,this.trigger("move",a))}),this.drag.on("end",()=>this.trigger("slide-end"))}setup(e,i){this.bindModel(e.model),this.one("slide-end",()=>e.score(i))}set(e){k(e,this.current)||this.drag.setPosition(e*this.drag.bounds.dx/this.steps,0)}play(){return Y(this,null,function*(){this.current>=this.steps&&this.set(0);let e=(1-this.current/this.steps)*3e3/this.speed;this.moveTo(this.steps,e)})}moveTo(e,i=600){return Y(this,null,function*(){if(this.animation||e===this.current)return;let s=this.current;this.animation=ht(n=>{this.set(s+(e-s)*kt("quad",n))},i),yield this.animation.promise,this.animation=void 0,this.trigger("slide-end")})}bindVariable(e,i){e[i]=0,this.on("move",s=>e[i]=s),e.watch(()=>this.set(e[i]))}};Ms=E([$("x-slider",{template:jr})],Ms);var Xr='<slot name="stage"></slot><div class="nav"><button class="btn back disabled" aria-label="Previous Step"><x-icon name="left" size="24"></x-icon></button><button class="btn next" aria-label="Next Step"><x-icon name="right" size="24"></x-icon></button><div class="dots"></div></div><div class="legend-box"><slot></slot></div>';function Cc(t){let e=t.$$("x-blank, x-blank-mc");if(!e.length)return Promise.resolve();let i=0;return new Promise(s=>{for(let n of e)n.on("solve",()=>{i+=1,i>=e.length&&s()})})}var Cs=class extends M{constructor(){super(...arguments);this.length=0;this.current=0;this.locked=!1}ready(){this.$legend=this.$(".legend-box"),this.$steps=this.$legend.children,this.$back=this.$(".back"),this.$next=this.$(".next");let e=this.$(".dots");this.$dots=this.$steps.map(()=>S("div",{class:"dot"},e)),this.length=this.$steps.length,this.current=0,this.$back.on("click",()=>this.goBack()),this.$next.on("click",()=>this.goNext()),this.blanks=this.$steps.map(i=>Cc(i)),this.reveals=this.$$("[slide]").map(i=>{let s=i.attr("slide").split("-"),n=s.length>1?[+s[0]||0,+s[1]||this.length]:[+s[0],+s[0]],r=[i.data.animation||"fade",+i.data.duration||400];return i.data.display="visibility",n[0]>=0&&!i.hasClass("reveal")&&i.hide(),[i,n,r]}),this.autoAdvance=this.attr("step")==="auto",this.$steps[0].show(),this.$dots[0].addClass("on"),this.setupSlide(0)}setup(e,i,s){var r;let n=(r=s==null?void 0:s.scores)==null?void 0:r.filter(o=>o.startsWith("slide-")).length;if(n&&n<this.$steps.length-1){this.go(n);for(let o=1;o<=n;++o)this.trigger("next",o)}this.on("next",o=>e.score("slide-"+(o-1)))}go(e){if(this.locked||e<0||e>this.length-1||e===this.current)return;this.locked=!0,setTimeout(()=>this.locked=!1,600),this.$back.setClass("disabled",e===0),this.$next.setClass("disabled",e===this.length-1),this.$dots[this.current].removeClass("on"),this.$dots[e].addClass("on"),this.$steps[e].show();let i=this.$steps[e].height+"px";this.$steps[e].hide(),this.$steps[this.current].exit("fade",300).promise.then(()=>this.$steps[e].enter("fade",300)),this.$legend.animate({height:i},600).promise.then(()=>this.$legend.css("height","auto")),this.setupSlide(e),this.current=e,this.trigger("step",e)}setupSlide(e){this.$next.setAttr("disabled","true"),this.blanks[e].then(()=>this.$next.removeAttr("disabled"));for(let[i,s,n]of this.reveals){if(i.hasClass("reveal"))continue;let r=i.css("visibility")!=="hidden",o=e>=s[0]&&e<=s[1];o&&!r&&i.enter(...n,300),!o&&r&&i.exit(...n)}}goNext(){this.locked||(this.go(this.current+1),this.trigger("next",this.current))}goBack(){this.locked||(this.go(this.current-1),this.trigger("back",this.current))}};Cs=E([$("x-slideshow",{template:Xr})],Cs);var Es=class extends M{ready(){var x,A;(x=C(".sidebar-toggle"))==null||x.on("click",()=>this.addClass("open")),(A=C(".sidebar-shadow"))==null||A.on("pointerdown",()=>this.removeClass("open"));let e=C("#feedback form"),i=C("#feedback button"),s=C("#feedback .error"),n=C("#feedback-success"),r=C('#feedback textarea[name="message"]'),o=C("x-course").id;e==null||e.on("submit",l=>{l.preventDefault(),i.setAttr("disabled","true"),s.hide(),le(`/course/${o}/feedback`,e.formData).then(()=>{n.open(),r.value=""}).catch(()=>s.show()).then(()=>i.removeAttr("disabled"))});let a=JSON.parse(C("#glossary").text),h=C("#glossary-search"),c=h.$(".gloss-body"),p=h.$(".gloss-list"),f=h.$(".gloss-search input"),d;for(let l of Object.keys(a).sort()){let g=a[l],w=S("div",{class:"gloss-item",html:g.title,tabindex:0},p);w.on("click",()=>{d&&d.removeClass("on"),d=w,w.addClass("on"),c.html=g.text});let y=g.title.toLowerCase();f.change(v=>w.setClass("hidden",!!v&&y.indexOf(v.toLowerCase())<0))}}};Es=E([$("x-course-sidebar")],Es);function Ss(t,e){let i=en(t.map(s=>s.h+10));for(let[s,n]of t.entries())n.drag.bounds=new Ut(0,0,0,z(i)),n!==e&&n.drag.setPosition(0,i[s-1]||0)}function Ec(t){return t.every((e,i)=>e.index===i)||t.every((e,i)=>e.index===t.length-i-1)}var ks=class extends M{ready(){this.items=this.children.map(e=>({drag:new Gt(e,{moveX:!1,useTransform:!0}),index:+e.data.index,h:0}));for(let e of this.children)e.removeAttr("data-index");for(let e of this.items)e.drag.on("drag",()=>{this.items=tn(this.items,i=>i.drag.position.y-(i===e?10:0)),Ss(this.items,e)}),e.drag.on("end",()=>{Ss(this.items),Ec(this.items)&&this.solve()});m.onResize(()=>{for(let i of this.items)i.h=i.drag.$el.height;let e=H(this.items.map(i=>i.h));this.css("height",e+this.items.length*10-10+"px"),Ss(this.items)})}setup(e,i,s){var n;((n=s==null?void 0:s.scores)==null?void 0:n.includes(i))&&this.solve(),this.one("solve",()=>{e.addHint("correct"),e.score(i)})}solve(){this.trigger("solve"),this.addClass("solved");for(let e of this.items)e.drag.disabled=!0}};ks=E([$("x-sortable")],ks);function Gr(t,e=!1){return Y(this,null,function*(){if(t.css("visibility")==="visible")return;t.data.display="visibility";let i=+t.data.duration||400,s=(e?0:600)+(+t.data.delay||0);yield t.enter(t.data.animation||"fade",i,s).promise,t.css({opacity:"",transform:""}),t.trigger("reveal"),t.removeClass("reveal")})}var As=class extends M{constructor(){super(...arguments);this.model=Hi({});this.isShown=!1;this.isCompleted=!1;this.scores=new Set}ready(){var i,s,n,r;this.$course=this.parents("x-course")[0],this.$blanks=this.$$("x-blank, x-blank-mc"),this.$components=this.$$("[goal]"),this.userData=(n=(s=(i=this.$course)==null?void 0:i.userData)==null?void 0:s.steps)==null?void 0:n[this.id],this.goals=V(this.attr("goals")),this.$reveals=this.$$(".reveal");let e=this.$$(".check[data-when]");for(let o of[...this.$reveals,...e])this.onScore(o.data.when,()=>Gr(o));this.$nextBtn=this.$$(".next-step");for(let[o,a]of this.$nextBtn.entries())this.onScore("next-"+o,()=>a.exit("pop")),a.one("click",()=>this.score("next-"+o));for(let o of this.$$(".step-target"))o.tagName!=="X-TARGET"&&jt(o,{enter:()=>{let a=this.$$('[target~="'+o.data.to+'"]');for(let h of a)h.addClass("focus");this.addClass("focus"),this.trigger("target-focus",{$targets:a})},exit:()=>{for(let a of this.$$(".focus"))a.removeClass("focus");this.removeClass("focus")}});for(let o of this.$$(".var, .var-action"))o.bindModel(this.model);((r=this.$course)==null?void 0:r.audio)&&(this.narration=new Xi(this.$course.audio,this))}show(){var s,n,r;if(this.isShown)return;this.isShown=!0,(s=StepFunctions==null?void 0:StepFunctions[Ae(this.id)])==null||s.call(StepFunctions,this);for(let o of this.$components)o.setup(this,o.attr("goal"),this.userData);let e=((n=this.userData)==null?void 0:n.scores)||[];for(let o of e)this.score(o,!1);let i=this.$$("x-gesture[target]");setTimeout(()=>{if(!this.isReady)for(let o of i)o.start()},2e3),(r=this.$course)==null||r.log("Step","show",this.id),this.trigger("show"),this.addClass("on"),this.narration&&setTimeout(()=>this.narration.play(),400)}complete(){if(!this.isCompleted){this.isShown||this.show(),this.isCompleted=!0;for(let e=0;e<this.$nextBtn.length;++e)this.score("next-"+e);for(let e of this.$reveals)e.parents("svg").length||Gr(e,!0);this.trigger("complete")}}get isReady(){return this.goals.every(e=>this.scores.has(e))}get isPageLoaded(){return this.$course?this.$course.isReady:!0}score(e,i=!0){this.scores.has(e)||(this.scores.add(e),this.trigger("score-"+e),this.trigger("score"),this.$course&&(this.$course.trigger("score"),this.$course.saveProgress({steps:{[this.id]:{scores:[e]}}}),this.$course.log("Step","score",this.id+"/"+e)),i&&this.isReady&&this.$course&&this.$course.isReady&&setTimeout(()=>{this.$course.$activeStep===this&&this.$course.nextStep()},1200))}storeData(e,i){var s;(s=this.$course)==null||s.saveProgress({steps:{[this.id]:{data:{[e]:i}}}})}onScore(e,i){let s=V(e);if(s.every(o=>this.scores.has(o)))return i&&i(),Promise.resolve();let n=Rt(),r=()=>{!s.every(o=>this.scores.has(o))||(i&&i(),n.resolve(),this.off("score",r))};return this.on("score",r),n.promise}addHint(e,i={}){var s,n,r;return this.trigger("hint",e),((s=this.$course)==null?void 0:s.isReady)?this.isInViewport?(n=this.$course.$tutor)==null?void 0:n.showHint(e,i):(this.one("enterViewport",()=>{var o;return(o=this.$course.$tutor)==null?void 0:o.showHint(e,i)}),{text:((r=this.$course.$tutor)==null?void 0:r.hints[e])||e}):{text:e}}delayedHint(e,i=1e4){let s=setTimeout(e,i);this.on("score",()=>{clearTimeout(s),this.isCompleted||(s=setTimeout(e,i))}),this.on("complete",()=>clearTimeout(s))}get nextStep(){if(!this.$course)return;let e=this.$course.$steps.indexOf(this);return this.$course.$steps[e+1]}groupBlanks(...e){let i=e.map(s=>this.$blanks[s]);for(let s of i)s.linkedBlanks=i}};As=E([$("x-step")],As);var Sc='<div class="titles"></div><div class="body"><slot></slot></div>',Ts=class extends M{constructor(){super(...arguments);this.$titles=[];this.active=0}ready(){let e=this.$(".titles");this.$body=this.$(".body"),this.$tabs=this.$$(".tab");for(let i=0;i<this.$tabs.length;++i){let s=this.$tabs[i].$("h3")||S("h3");s.setAttr("tabindex","0"),e.append(s),this.$titles.push(s),s.on("click",()=>this.makeActive(i))}this.$titles[0].addClass("active"),this.$tabs[0].show()}makeActive(e){if(this.active===e)return;this.$titles[this.active].removeClass("active"),this.$titles[e].addClass("active"),this.$tabs[e].show();let i=this.$tabs[e].outerHeight+"px";this.$tabs[e].hide(),this.$tabs[this.active].exit("fade",300).promise.then(()=>this.$tabs[e].enter("fade",300)),this.$body.animate({height:i},600).promise.then(()=>this.$body.css("height","auto")),this.active=e,this.trigger("change",e)}};Ts=E([$("x-tabbox",{template:Sc})],Ts);var Kr='<defs><mask id="masking"><rect width="100%" height="100%" fill="white"></rect></mask></defs><marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="4" markerHeight="4" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z"></path></marker><rect x="0" y="0" width="100%" height="100%" mask="url(#masking)" opacity="0.8"></rect><path class="target-arrow" stroke-width="5" marker-end="url(#arrow)" opacity="0.4" stroke-linecap="round"></path>';function kc(t,e,i,s){let n=new u(t.left-15,t.top+i-15),r=new et(n,t.width+30,t.height+30),o=new u(e.left-15,e.top+s-15),a=new et(o,e.width+30,e.height+30),h=new he(r.center,a.center);return[pt(h,r)[0],pt(h,a)[0]]}function Ac(t,e){return Math.abs(t[0]-e[0])+Math.abs(t[1]-e[1])}var Yr=gt("header, x-tutor, .sidebar"),Qt=S("svg",{class:"target-body",html:Kr},P),Tc=Qt.$("mask"),_c=Qt.$(".target-arrow"),te=!1,Jr=[],_s=class extends M{ready(){this.setAttr("tabindex",0);let e=this.attr("to").replace(/_/g," "),i=this.hasClass("no-margins"),s,n,r,o,a=()=>{te=!0;let f=gt(e);if(!f.length)return;let d=f[0].hasParent(...Yr);s===void 0&&(s=this.hasParent(...Yr));let x=this.bounds,A=f.map(l=>l.bounds).filter(l=>l.width||l.height);if(r=0,!d){let l=Math.min(...A.map(v=>v.top)),g=Math.max(...A.map(v=>v.top+v.height)),w=m.height-12-g,y=56-l;r=w<0?w:y>0?y:0}for(let l of Jr)l.remove();Jr=[x,...A].map((l,g)=>{let w=!g||i?4:10;return S("rect",{x:l.left-w,y:l.top-w+(g||!s?r:0),width:l.width+2*w,height:l.height+2*w,rx:g?4:18,ry:g?4:18},Tc)}),_c.points=kc(x,A[0],s?0:r,d?0:r)},h=()=>{r&&P.scrollBy(-r,300),Qt.css("display","block"),m.redraw(),$t(function(){Qt.css("opacity",1)},r?300:0)},c=f=>{!te||f&&D(f.type,"mousemove","pointermove")&&Ac(n,[f.clientX,f.clientY])<40||(clearTimeout(o),te=!1,Qt.css("opacity",0),setTimeout(()=>{te||Qt.css("display","none")},300),P.off("mousewheel mousemove touchend touchmove",c),this.off("mouseleave blur",c))},p=()=>{r&&!s?P.on("mousemove",c):this.on("mouseleave",c),P.on("mousewheel touchend touchmove",c),this.on("blur",c)};this.on("mouseenter touchstart focus",f=>{n=[f.clientX,f.clientY],a(),o=window.setTimeout(h,r?50:30),p()}),this.on("click",f=>{te?(f.handled=!0,c(),setTimeout(()=>C(e).trigger("click mousedown"))):(te=!0,r=0,h(),p())})}};_s=E([$("x-target")],_s);function Zr(t=10){return Math.random().toString(36).substr(2,t)}function st(t,...e){return e.includes(t)}var Qr=class extends Error{constructor(t){super("[Cache Error]");this.data=t}};function to(t){let e=new Map;return function(...i){let s=i.join("--");if(!e.has(s))try{e.set(s,t(...i))}catch(r){e.set(s,new Qr(r))}let n=e.get(s);if(n instanceof Qr)throw n.data;return n}}function be(t,e){return new Array(e).fill(t)}function eo(t,e,i){let s=[];for(let n=0;n<e;++n)s.push(be(t,i));return s}function io(t,e,i){let s=[];for(let n=0;n<e;++n){let r=[];for(let o=0;o<i;++o)r.push(t(n,o));s.push(r)}return s}function so(t,e,i=1){let s=[];if(e===void 0&&t>=0)for(let n=0;n<t;n+=i)s.push(n);else if(e===void 0)for(let n=0;n>t;n-=i)s.push(n);else if(t<=e)for(let n=t;n<=e;n+=i)s.push(n);else for(let n=t;n>=e;n-=i)s.push(n);return s}function nt(t,e=0){return t[t.length-1-e]}function Lt(t){return t.reduce((e,i)=>e+i,0)}function Vt(t){return t.filter((e,i)=>t.indexOf(e)===i)}function si(t){return t.reduce((e,i)=>e.concat(Array.isArray(i)?si(i):i),[])}function no(...t){return t.reduce((e,i)=>e.concat(i),[])}function ee(t,e=/\s+/){return t?t.trim().split(e):[]}var ni=class{constructor(...t){this.values=t}map(t){let e=this.values;return new ni(function*(){let i=0;for(let s of e)for(let n of s)yield t(n,i),i+=1}())}every(t){let e=0;for(let i of this.values)for(let s of i){if(!t(s,e))return!1;e+=1}return!0}some(t){let e=0;for(let i of this.values)for(let s of i){if(t(s,e))return!0;e+=1}return!1}slice(t,e){let i=this.values;return new ni(function*(){let s=0;for(let n of i)for(let r of n)s<t||e!==void 0&&s>t+e||(yield r,s+=1)}())}filter(t){let e=this.values;return new ni(function*(){let i=0;for(let s of e)for(let n of s)t(n,i)&&(yield n),i+=1}())}concat(t){this.values.push(t)}[Symbol.iterator](){let t=this.values;return function*(){for(let e of t)for(let i of e)yield i}()}static make(t,e){return new ni(function*(){let i=0;for(;e===void 0||i<e;)yield t(i),i+=1}())}};var Pc=Object.defineProperty,Ps=(t,e)=>{for(var i in e)Pc(t,i,{get:e[i],enumerable:!0})},ro=1e-6;function ri(t,e,i=ro){return isNaN(t)||isNaN(e)?!1:Math.abs(t-e)<i}function oo(t,e,i,s=ro){return e>i&&([e,i]=[i,e]),t>e+s&&t<i-s}function Nt(...t){let[e,...i]=t;if(i.length>1)return Nt(e,Nt(...i));let s=Math.abs(e),n=Math.abs(i[0]);for(;n;)[s,n]=[n,s%n];return s}function xe(...t){let[e,...i]=t;return i.length>1?xe(e,xe(...i)):Math.abs(e*i[0])/Nt(e,i[0])}var Ic={};Ps(Ic,{determinant:()=>Bc,fill:()=>ao,identity:()=>ho,inverse:()=>uo,product:()=>oi,reflection:()=>Vc,rotation:()=>Oc,scalarProduct:()=>Nc,shear:()=>Lc,sum:()=>co,transpose:()=>lo});function ao(t,e,i){return eo(t,e,i)}function ho(t=2){let e=ao(0,t,t);for(let i=0;i<t;++i)e[i][i]=1;return e}function Oc(t){let e=Math.sin(t),i=Math.cos(t);return[[i,-e],[e,i]]}function Lc(t){return[[1,t],[0,1]]}function Vc(t){let e=Math.sin(2*t),i=Math.cos(2*t);return[[i,e],[e,-i]]}function co(...t){let[e,...i]=t,s=i.length>1?co(...i):i[0];if(e.length!==s.length||e[0].length!==s[0].length)throw new Error("Matrix sizes don\u2019t match");let n=[];for(let r=0;r<e.length;++r){let o=[];for(let a=0;a<e[r].length;++a)o.push(e[r][a]+s[r][a]);n.push(o)}return n}function Nc(t,e){return t.map(i=>i.map(s=>s*e))}function oi(...t){let[e,...i]=t,s=i.length>1?oi(...i):i[0];if(e[0].length!==s.length)throw new Error("Matrix sizes don\u2019t match.");let n=[];for(let r=0;r<e.length;++r){let o=[];for(let a=0;a<s[0].length;++a){let h=0;for(let c=0;c<s.length;++c)h+=e[r][c]*s[c][a];o.push(h)}n.push(o)}return n}function lo(t){let e=[];for(let i=0;i<t[0].length;++i){let s=[];for(let n=0;n<t.length;++n)s.push(t[n][i]);e.push(s)}return e}function Bc(t){if(t.length!==t[0].length)throw new Error("Not a square matrix.");let e=t.length;if(e===1)return t[0][0];if(e===2)return t[0][0]*t[1][1]-t[0][1]*t[1][0];let i=0;for(let s=0;s<e;++s){let n=t[0][s],r=t[0][s];for(let o=1;o<e;++o)r*=t[o][(s+o)%e],n*=t[o][(s-o+e)%e];i+=r-n}return i}function uo(t){let e=t.length;if(e!==t[0].length)throw new Error("Not a square matrix.");let i=ho(e),s=io((n,r)=>t[n][r],e,e);for(let n=0;n<e;++n){let r=s[n][n];if(ri(r,0)){for(let o=n+1;o<e;++o)if(s[o][n]!==0){for(let a=0;a<e;++a)[s[o][a],s[n][a]]=[s[n][a],s[o][a]],[i[o][a],i[n][a]]=[i[n][a],i[o][a]];break}if(r=s[n][n],ri(r,0))throw new Error("Matrix not invertible.")}for(let o=0;o<e;++o)s[n][o]=s[n][o]/r,i[n][o]=i[n][o]/r;for(let o=0;o<e;++o){if(o===n)continue;let a=s[o][n];for(let h=0;h<e;++h)s[o][h]-=a*s[n][h],i[o][h]-=a*i[n][h]}}return i}var qc={};Ps(qc,{bernoulli:()=>po,binomial:()=>Wc,cauchy:()=>Kc,chiCDF:()=>Jc,exponential:()=>Xc,find:()=>Fc,geometric:()=>Gc,integer:()=>Dc,integrate:()=>mo,normal:()=>jc,normalPDF:()=>Yc,poisson:()=>Uc,shuffle:()=>Rc,smart:()=>Hc,uniform:()=>zc,weighted:()=>fo});function Rc(t){t=t.slice(0);for(let e=t.length-1;e>0;--e){let i=Math.floor(Math.random()*(e+1));[t[e],t[i]]=[t[i],t[e]]}return t}function Dc(t,e){let i=e===void 0?0:t,s=e===void 0?t:e-t+1;return i+Math.floor(s*Math.random())}function fo(t){let e=Math.random()*Lt(t),i=0;return t.findIndex(s=>(i+=s)>=e)}function Fc(t){return t[Math.floor(t.length*Math.random())]}var ai=new Map;function Hc(t,e){e||(e=Zr()),ai.has(e)||ai.set(e,be(1,t));let i=ai.get(e),s=fo(i.map(n=>n*n));return i[s]-=1,i[s]<=0&&ai.set(e,i.map(n=>n+1)),s}function po(t=.5){return Math.random()<t?1:0}function Wc(t=1,e=.5){let i=0;for(let s=0;s<t;++s)i+=po(e);return i}function Uc(t=1){if(t<=0)return 0;let e=Math.exp(-t),i=1,s=0;for(;i>e;++s)i*=Math.random();return s-1}function zc(t=0,e=1){return t+(e-t)*Math.random()}function jc(t=0,e=1){let i=Math.random(),s=Math.random();return Math.sqrt(-2*Math.log(i))*Math.cos(2*Math.PI*s)*Math.sqrt(e)+t}function Xc(t=1){return t<=0?0:-Math.log(Math.random())/t}function Gc(t=.5){if(!(t<=0||t>1))return Math.floor(Math.log(Math.random())/Math.log(1-t))}function Kc(){let t,e,i;do e=2*Math.random()-1,i=2*Math.random()-1,t=e*e+i*i;while(t>=1);return e/i}function Yc(t,e=1,i=0){return Math.exp(-((t-e)**2)/(2*i))/Math.sqrt(2*Math.PI*i)}var go=7,vo=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23];function wo(t){if(t<.5)return Math.PI/(Math.sin(Math.PI*t)*wo(1-t));t-=1;let e=vo[0];for(let s=1;s<go+2;s++)e+=vo[s]/(t+s);let i=t+go+.5;return Math.sqrt(2*Math.PI)*Math.pow(i,t+.5)*Math.exp(-i)*e}function mo(t,e,i,s=1){let n=0;for(let r=e;r<i;r+=s)n+=t(r)*s||0;return n}function Jc(t,e){let i=mo(s=>Math.pow(s,(e-2)/2)*Math.exp(-s/2),0,t);return 1-i/Math.pow(2,e/2)/wo(e/2)}var Zc={};Ps(Zc,{bestPolynomial:()=>sl,coefficient:()=>bo,exponential:()=>tl,linear:()=>Qc,logarithmic:()=>el,polynomial:()=>yo,power:()=>il});function nl(t,e){let i=1,s=t[0];for(let n=1;n<t.length;++n)i*=e,s+=i*t[n];return s}function Qc(t,e=!1){let i=0,s=0,n=0,r=0,o=t.length;for(let c=0;c<o;c++)i+=t[c][0],s+=t[c][1],n+=t[c][0]*t[c][0],r+=t[c][0]*t[c][1];if(e){let c=r/n;return[0,c]}let a=(o*r-i*s)/(o*n-i*i);return[s/o-a*i/o,a]}function tl(t){let e=[0,0,0,0,0,0];for(let r of t)e[0]+=r[0],e[1]+=r[1],e[2]+=r[0]*r[0]*r[1],e[3]+=r[1]*Math.log(r[1]),e[4]+=r[0]*r[1]*Math.log(r[1]),e[5]+=r[0]*r[1];let i=e[1]*e[2]-e[5]*e[5],s=Math.exp((e[2]*e[3]-e[5]*e[4])/i),n=(e[1]*e[4]-e[5]*e[3])/i;return[s,n]}function el(t){let e=[0,0,0,0],i=t.length;for(let r of t)e[0]+=Math.log(r[0]),e[1]+=r[1]*Math.log(r[0]),e[2]+=r[1],e[3]+=Math.pow(Math.log(r[0]),2);let s=(i*e[1]-e[2]*e[0])/(i*e[3]-e[0]*e[0]);return[(e[2]-s*e[0])/i,s]}function il(t){let e=[0,0,0,0],i=t.length;for(let r of t)e[0]+=Math.log(r[0]),e[1]+=Math.log(r[1])*Math.log(r[0]),e[2]+=Math.log(r[1]),e[3]+=Math.pow(Math.log(r[0]),2);let s=(i*e[1]-e[2]*e[0])/(i*e[3]-e[0]*e[0]);return[Math.exp((e[2]-s*e[0])/i),s]}function yo(t,e=2){let i=t.map(h=>so(e+1).map(c=>Math.pow(h[0],c))),s=lo(i),n=t.map(h=>[h[1]]),r=oi(s,i),o=uo(r);return oi(o,s,n).map(h=>h[0])}function bo(t,e){let s=t.reduce((o,a)=>o+a[1],0)/t.length,n=t.reduce((o,a)=>o+(a[1]-s)**2,0),r=t.reduce((o,a)=>o+(a[1]-e(a[0]))**2,0);return 1-r/n}function sl(t,e=.85,i=8){if(!(t.length<=1))for(let s=1;s<i;++s){let n=yo(t,s),r=a=>nl(n,a);if(bo(t,r)>=e)return{order:s,coefficients:n,fn:r}}}var _=class extends Error{constructor(t,e){super(e);this.name=t}static undefinedVariable(t){return new _("EvalError",`Undefined variable \u201C${t}\u201D.`)}static undefinedFunction(t){return new _("EvalError",`Undefined function \u201C${t}\u201D.`)}static uncallableExpression(t){return new _("EvalError",`Cannot call \u201C${t}\u201D.`)}static evalLoop(t){return new _("EvalError",`Loop in nested evaluation \u201C${t}\u201D.`)}static invalidCharacter(t){return new _("SyntaxError",`Unknown symbol \u201C${t}\u201D.`)}static conflictingBrackets(t){return new _("SyntaxError",`Conflicting brackets \u201C${t}\u201D.`)}static unclosedBracket(t){return new _("SyntaxError",`Unclosed bracket \u201C${t}\u201D.`)}static startOperator(t){return new _("SyntaxError",`A term cannot start with a \u201C${t}\u201D.`)}static endOperator(t){return new _("SyntaxError",`A term cannot end with a \u201C${t}\u201D.`)}static consecutiveOperators(t,e){return new _("SyntaxError",`A \u201C${t}\u201D cannot be followed by a \u201C${e}\u201D.`)}static invalidExpression(){return new _("SyntaxError","This expression is invalid.")}},Is={pi:Math.PI,\u03C0:Math.PI,e:Math.E},Os={"(":")","[":"]","{":"}"},ie={"*":"\xB7","**":"\u2217","//":"//","+-":"\xB1","\u2013":"\u2212","-":"\u2212",xx:"\xD7",sum:"\u2211",prod:"\u220F",int:"\u222B",del:"\u2202",grad:"\u2207",aleph:"\u2135",not:"\xAC",AA:"\u2200",EE:"\u2203","'":"\u2019","!=":"\u2260","<=":"\u2264",">=":"\u2265",in:"\u2208","!in":"\u2209","==":"\u2261","~=":"\u2245","~~":"\u2248",sub:"\u2282",sube:"\u2286",prop:"\u221D",oo:"\u221E",cap:"\u2229",cup:"\u222A","<-":"\u2190","->":"\u2192","=>":"\u21D2","<=>":"\u21D4","|->":"\u21A6",uarr:"\u2191",darr:"\u2193",lArr:"\u21D0"},$e={Gamma:"\u0393",Delta:"\u0394",Theta:"\u0398",Lambda:"\u039B",Xi:"\u039E",Pi:"\u03A0",Sigma:"\u03A3",Phi:"\u03A6",Psi:"\u03A8",Omega:"\u03A9",alpha:"\u03B1",beta:"\u03B2",gamma:"\u03B3",delta:"\u03B4",epsilon:"\u025B",zeta:"\u03B6",eta:"\u03B7",theta:"\u03B8",iota:"\u03B9",kappa:"\u03BA",lambda:"\u03BB",mu:"\u03BC",nu:"\u03BD",xi:"\u03BE",pi:"\u03C0",rho:"\u03C1",sigma:"\u03C3",tau:"\u03C4",upsilon:"\u03C5",phi:"\u03C6",chi:"\u03C7",psi:"\u03C8",omega:"\u03C9",CC:"\u2102",NN:"\u2115",QQ:"\u211A",RR:"\u211D",ZZ:"\u2124"},xo="abcdefghijklmnopqrstuvwxyz",rl=xo.split(""),ol=xo.toUpperCase().split(""),al=Object.values($e),hl=[...rl,...ol,...al,"$"],cl="|()[]{}\xF7,!<>=*/+-\u2013\u2212~^_\u2026\xB0\u2022\u2225\u22A5'\u2220:%\u223C\u25B3",ll=Object.values(ie),ul=[...cl,...ll],fl={_:"sub","^":"sup","//":"/","\xF7":"/"},$o={"<":"&lt;",">":"&gt;"};function Mo(t){return t in $o?$o[t]:t}var dl=["abs","round","floor","ceil","max","min","mod","lcm","gcd","gcf","log","exp","ln","sqrt","root","sin","cos","tan","sec","csc","cot","cosec","cotan","arcsin","arccos","arctan","sinh","cosh","tanh","sech","csch","coth","cosech"];function Me(t){return dl.includes(t)}var se={"+":"plus","\u2212":"minus","\xB7":"times","\xD7":"times","/":"over","//":"divided by","%":"percent","!":"factorial","\xB1":"plus-minus","=":"equals","\u2260":"does not equal","<":"is less than",">":"is greater than","\u2264":"is less than or equal to","\u2265":"is greater than or equal to",\u03C0:"pi","\u2245":"is congruent to","\u2225":"is parallel to","\u22A5":"is perpendicular to"};for(let t of Object.keys($e))se[$e[t]]=t;var Co=t=>typeof t=="number"?t:t[0],Eo=t=>typeof t=="number"?[t,t]:t,bt=class{evaluate(t={},e){return NaN}interval(t={},e){return Eo(this.evaluate(t))}substitute(t={}){return this}recursiveSubstitute(t){let e=Object.keys(t);return this.unknowns.filter(i=>e.includes(i)).length?this.substitute(t).recursiveSubstitute(t):this}get simplified(){return this}get unknowns(){return this.variables.filter(t=>!Object.prototype.hasOwnProperty.call(Is,t))}get variables(){return[]}get functions(){return[]}collapse(){return this}toString(){return""}toVoice(t={}){return""}toMathML(t={}){return""}},Ls=new Set;function Vs(t,e,i=!1){var s;let n=(s=e[t])!=null?s:Is[t];if(n===void 0)throw _.undefinedVariable(t);if(typeof n=="string"||n instanceof bt){if(i||Ls.clear(),Ls.has(t))throw _.evalLoop(t);return Ls.add(t),typeof n=="string"&&(n=hi.parse(n)),n.evaluate(e,!0)}else return typeof n=="function"?n():n}var Ce=class extends bt{constructor(t){super();this.n=t}evaluate(){return this.n}toString(){return`${this.n}`}toVoice(){return`${this.n}`}toMathML(){return`<mn>${this.n}</mn>`}},Ns=class extends bt{constructor(t){super();this.i=t}evaluate(t={},e){return Co(Vs(this.i,t,e))}interval(t={},e){return Eo(Vs(this.i,t,e))}toMathML(){return`<mi${Me(this.i)?' mathvariant="normal"':""}>${this.i}</mi>`}substitute(t={}){return t[this.i]||this}get variables(){return[this.i]}toString(){return this.i}toVoice(){return this.i in se?se[this.i]:this.i.length===1?`_${this.i}_`:this.i}},pl=class extends bt{constructor(t){super();this.s=t}evaluate(t={},e){return Co(Vs(this.s,t,e))}toString(){return`"${this.s}"`}toVoice(){return this.s}toMathML(){return`<mtext>${this.s}</mtext>`}},So=class extends bt{toString(){return" "}toMathML(){return"<mspace></mspace>"}},rt=class extends bt{constructor(t){super();this.o=t}toString(){return this.o.replace("//","/")}toVoice(){return se[this.o]||this.o}get functions(){return[this.o]}toMathML(){let t=Mo(this.toString());return`<mo value="${t}">${t}</mo>`}},ko=[-Infinity,Infinity],ne=[NaN,NaN],Bt=Math.PI/2,Bs=Math.PI*2,I=(t,e)=>[t-Number.EPSILON,e+Number.EPSILON],qt=(...t)=>I(Math.min(...t),Math.max(...t)),ml=t=>Math.abs(t[1]-t[0]);var re=t=>isNaN(t[0])||isNaN(t[1]),Ao=t=>!isFinite(t[0])&&t[0]===t[1],gl=(t,e)=>oo(e,t[0]-Number.EPSILON,t[1]+Number.EPSILON),ci=t=>gl(t,0),ot={add:(...t)=>t.reduce((e,i)=>e+i,0),sub:(...t)=>t.length>1?t[0]-t[1]:-t[0],mul:(...t)=>t.reduce((e,i)=>e*i,1),div:(t,e)=>t/e,abs:t=>Math.abs(t),round:t=>Math.round(t),floor:t=>Math.floor(t),ceil:t=>Math.ceil(t),max:(...t)=>Math.max(...t),min:(...t)=>Math.min(...t),mod:(t,e)=>t%e,lcm:(...t)=>xe(...t),gcd:(...t)=>Nt(...t),gcf:(...t)=>Nt(...t),sup:(t,e)=>Math.pow(t,e),log:(t,e)=>Math.log(t)/(e===void 0?1:Math.log(e)),exp:t=>Math.exp(t),ln:t=>Math.log(t),sqrt:t=>Math.sqrt(t),root:(t,e)=>Math.pow(t,1/e),sin:t=>Math.sin(t),cos:t=>Math.cos(t),tan:t=>Math.tan(t),sec:t=>1/Math.cos(t),csc:t=>1/Math.sin(t),cot:t=>1/Math.tan(t),cosec:t=>ot.csc(t),cotan:t=>ot.cot(t),arcsin:t=>Math.asin(t),arccos:t=>Math.acos(t),arctan:t=>Math.atan(t),sinh:t=>Math.sinh(t),cosh:t=>Math.cosh(t),tanh:t=>Math.tanh(t),sech:t=>1/Math.cosh(t),csch:t=>1/Math.sinh(t),coth:t=>1/Math.tanh(t),cosech:t=>ot.csch(t)};function li(t,e){if(t[0]>0)return e[0]>=0?I(t[0]**e[0],t[1]**e[1]):qt(t[0]**e[0],t[0]**e[1],t[1]**e[0],t[1]**e[1]);let i=e[0];return Number.isInteger(i)&&i===e[1]?i===0?[ci(t)?0:1,1]:i%2?I(t[0]**i,t[1]**i):ci(t)?[0,Math.max(t[0]**i,t[1]**i)]:qt(t[1]**i,t[0]**i):ne}function To(t,e=Bs){let i=Math.floor(t[0]/e)*e;return[t[0]-i,t[1]-i]}var T={add:(...t)=>I(Lt(t.map(e=>e[0])),Lt(t.map(e=>e[1]))),sub:(t,e)=>e!==void 0?I(t[0]-e[1],t[1]-e[0]):I(-t[1],-t[0]),mul:(t,...e)=>(e.length>1&&(e=[T.mul(...e)]),qt(t[0]*e[0][0],t[0]*e[0][1],t[1]*e[0][0],t[1]*e[0][1])),div:(t,e)=>ci(e)?ko:qt(t[0]/e[0],t[0]/e[1],t[1]/e[0],t[1]/e[1]),abs:t=>ci(t)?I(0,Math.max(-t[0],t[1])):qt(Math.abs(t[0]),Math.abs(t[1])),round:t=>I(Math.round(t[0]),Math.round(t[1])),floor:t=>I(Math.floor(t[0]),Math.floor(t[1])),ceil:t=>I(Math.ceil(t[0]),Math.ceil(t[1])),max:(...t)=>I(Math.max(...t.map(e=>e[0])),Math.max(...t.map(e=>e[1]))),min:(...t)=>I(Math.min(...t.map(e=>e[0])),Math.min(...t.map(e=>e[1]))),mod:(t,e)=>{if(re(t)||re(e))return ne;let i=t[0]/(t[0]<0?e[0]:e[1]);return i=i<0?Math.ceil(i):Math.floor(i),T.sub(t,T.mul(e,[i,i]))},lcm:(...t)=>qt(xe(...t.map(e=>e[0]))),gcd:(...t)=>qt(Nt(...t.map(e=>e[0]))),gcf:(...t)=>T.gcd(...t),sup:(t,e)=>li(t,e),log:(t,e)=>(e!==void 0&&T.div(T.log(t),T.log(e)),I(t[0]<=0?-Infinity:Math.log(t[0]),Math.log(t[1]))),exp:t=>li([Math.E,Math.E],t),ln:t=>T.log(t),sqrt:t=>li(t,[.5,.5]),root:(t,e)=>li(t,T.div([1,1],e)),sin:t=>T.cos(T.sub(t,[Bt,Bt])),cos:t=>re(t)||Ao(t)?ne:ml(t)>=Bs-Number.EPSILON?[-1,1]:(t=To(t),t[0]>=Math.PI?T.sub(T.cos(T.sub(t,[Math.PI,Math.PI]))):t[1]<=Math.PI?I(Math.cos(t[1]),Math.cos(t[0])):t[1]<=Bs?I(-1,Math.max(Math.cos(t[1]),Math.cos(t[0]))):I(-1,1)),tan:t=>re(t)||Ao(t)?ne:(t=To(t,Math.PI),t[0]>=Bt&&(t=T.sub(t,[Math.PI,Math.PI])),t[0]<=-Bt||t[1]>=Bt?ko:I(Math.tan(t[0]),Math.tan(t[1]))),sec:t=>T.div([1,1],T.cos(t)),csc:t=>T.div([1,1],T.sin(t)),cot:t=>T.div([1,1],T.tan(t)),cosec:t=>T.csc(t),cotan:t=>T.cot(t),arcsin:t=>re(t)||t[1]<-1||t[0]>1?ne:I(t[0]<=-1?-Bt:Math.asin(t[0]),t[1]>=1?Bt:Math.asin(t[1])),arccos:t=>re(t)||t[1]<-1||t[0]>1?ne:I(t[1]>=1?0:Math.acos(t[1]),t[0]<=-1?Math.PI:Math.acos(t[0])),arctan:t=>I(Math.atan(t[0]),Math.atan(t[1])),sinh:t=>I(Math.sinh(t[0]),Math.sinh(t[1])),cosh:t=>t[1]<0?I(Math.cosh(t[1]),Math.cosh(t[0])):t[0]>0?I(Math.cosh(t[0]),Math.cosh(t[1])):I(1,Math.cosh(Math.max(-t[0],t[1]))),tanh:t=>I(Math.tanh(t[0]),Math.tanh(t[1])),sech:t=>T.div([1,1],T.cosh(t)),csch:t=>T.div([1,1],T.sinh(t)),coth:t=>T.div([1,1],T.tanh(t)),cosech:t=>T.csch(t)},ui=ee("+ \u2212 * \xD7 \xB7 / \xF7 // sup sub subsup"),_o=ee("sub sup subsup"),qs='<mo value="," lspace="0">,</mo>';function Po(t,e){return ui.includes(e)?t instanceof fi?!0:!(t instanceof F)||!ui.includes(t.fn)?!1:_o.includes(t.fn)&&_o.includes(e)?!0:ui.indexOf(e)>ui.indexOf(t.fn):!1}function vl(t,e,i){return Po(t,e)?`<mfenced>${i}</mfenced>`:i}function xt(t,e){return t instanceof fi||t instanceof F?`<mrow>${e}</mrow>`:e}function Io(t){return t==="2"?"squared":t==="3"?"cubed":`to the power of ${t}`}var F=class extends bt{constructor(t,e=[]){super();this.fn=t,this.args=e}evaluate(t={}){let e=this.args.map(i=>i.evaluate(t));if(this.fn in t){let i=t[this.fn];if(typeof i=="function")return i(...e);if(typeof i=="number"&&e.length===1)return ot.mul(i,e[0]);throw _.uncallableExpression(this.fn)}if(this.fn==="+")return ot.add(...e);if(this.fn==="\u2212")return ot.sub(...e);if(["*","\xB7","\xD7"].includes(this.fn))return ot.mul(...e);if(this.fn==="/")return ot.div(...e);if(this.fn==="sup")return ot.sup(...e);if(Me(this.fn))return ot[this.fn](...e);if(this.fn==="(")return e[0];throw _.undefinedFunction(this.fn)}interval(t={}){let e=this.args.map(i=>i.interval(t));if(this.fn in t){let i=t[this.fn];if(typeof i=="function")return be(i(...e.map(s=>s[0])),2);if(typeof i=="number"&&e.length===1)return T.mul([i,i],e[0]);if(Array.isArray(i)&&e.length===1)return T.mul(i,e[0]);throw _.uncallableExpression(this.fn)}if(this.fn==="+")return T.add(...e);if(this.fn==="\u2212")return T.sub(...e);if(["*","\xB7","\xD7"].includes(this.fn))return T.mul(...e);if(this.fn==="/")return T.div(...e);if(this.fn==="sup")return T.sup(...e);if(Me(this.fn))return T[this.fn](...e);if(this.fn==="(")return e[0];throw _.undefinedFunction(this.fn)}substitute(t={}){return new F(this.fn,this.args.map(e=>e.substitute(t)))}collapse(){return this.fn==="("?this.args[0].collapse():new F(this.fn,this.args.map(t=>t.collapse()))}get simplified(){return this}get variables(){return Vt(si(this.args.map(t=>t.variables)))}get functions(){return Vt([this.fn,...si(this.args.map(t=>t.functions))])}toString(){let t=this.args.map(e=>Po(e,this.fn)?`(${e.toString()})`:e.toString());return this.fn==="\u2212"?t.length>1?t.join(" \u2212 "):`\u2212${t[0]}`:this.fn==="sup"?t.join("^"):this.fn==="sub"?t.join("_"):this.fn==="subsup"?`${t[0]}_${t[1]}^${t[2]}`:ee("+ * \xD7 \xB7 / = < > \u2264 \u2265 \u2248").includes(this.fn)?t.join(` ${this.fn} `):st(this.fn,"(","[","{")?this.fn+this.args.join(", ")+Os[this.fn]:st(this.fn,"!","%")?t[0]+this.fn:`${this.fn}(${t.join(", ")})`}toMathML(t={}){let e=this.args.map(n=>n.toMathML(t)),i=this.args.map((n,r)=>vl(n,this.fn,e[r]));if(this.fn in t){let n=e.map((r,o)=>({toString:()=>r,val:this.args[o]}));return t[this.fn](...n)}if(this.fn==="\u2212")return i.length>1?i.join('<mo value="\u2212">\u2212</mo>'):`<mo rspace="0" value="\u2212">\u2212</mo>${i[0]}`;if(st(this.fn,"+","=","<",">","\u2264","\u2265","\u2248")){let n=Mo(this.fn);return i.join(`<mo value="${n}">${n}</mo>`)}if(st(this.fn,"*","\xD7","\xB7")){let n=i[0];for(let r=1;r<i.length-1;++r)n+=(this.args[0]instanceof Ce&&this.args[1]instanceof Ce?'<mo value="\xD7">\xD7</mo>':"")+i[1];return n}if(this.fn==="//")return i.join('<mo value="/">/</mo>');if(this.fn==="sqrt")return`<msqrt>${i[0]}</msqrt>`;if(st(this.fn,"/","root")){let n=this.fn==="/"?"mfrac":"mroot",r=this.args.map((o,a)=>xt(o,e[a]));return`<${n}>${r.join("")}</${n}>`}if(st(this.fn,"sup","sub")){let n=[xt(this.args[0],i[0]),xt(this.args[1],e[1])];return`<m${this.fn}>${n.join("")}</m${this.fn}>`}return this.fn==="subsup"?`<msubsup>${[xt(this.args[0],i[0]),xt(this.args[1],e[1]),xt(this.args[2],e[2])].join("")}</msubsup>`:st(this.fn,"(","[","{")?`<mfenced open="${this.fn}" close="${Os[this.fn]}">${i.join(qs)}</mfenced>`:st(this.fn,"!","%")?`${i[0]}<mo value="${this.fn}" lspace="0">${this.fn}</mo>`:this.fn==="abs"?`<mfenced open="|" close="|">${i.join(qs)}</mfenced>`:this.fn==="bar"?`<mover>${xt(this.args[0],i[0])}<mo value="\u203E">\u203E</mo></mover>`:this.fn==="vec"?`<mover>${xt(this.args[0],i[0])}<mo value="\u2192">\u2192</mo></mover>`:`<mi${Me(this.fn)?' mathvariant="normal"':""}>${this.fn}</mi><mfenced>${i.join(qs)}</mfenced>`}toVoice(t={}){let e=this.args.map(s=>s.toVoice(t)),i=e.join(" ");if(this.fn in t){let s=e.map((n,r)=>({toString:()=>n,val:this.args[r]}));return t[this.fn](...s)}return st(this.fn,"(","[","{")?i:this.fn==="sqrt"?`square root of ${i}`:this.fn==="%"?`${i} percent`:this.fn==="!"?`${i} factorial`:this.fn==="/"?`${e[0]} over ${e[1]}`:this.fn==="//"?`${e[0]} divided by ${e[1]}`:this.fn==="sub"?i:this.fn==="subsup"?`${e[0]} ${e[1]} ${Io(e[2])}`:this.fn==="sup"?`${e[0]} ${Io(e[1])}`:se[this.fn]?e.join(` ${se[this.fn]} `):Me(this.fn)?`${this.fn} ${i}`:`${this.fn} of ${i}`}},fi=class extends bt{constructor(t){super();this.items=t}evaluate(t={}){return this.collapse().evaluate(t)}interval(t={}){return this.collapse().interval(t)}substitute(t={}){return this.collapse().substitute(t)}get simplified(){return this.collapse().simplified}get variables(){return Vt(no(...this.items.map(t=>t.variables)))}get functions(){return this.collapse().functions}toString(){return this.items.map(t=>t.toString()).join(" ")}toMathML(t={}){return this.items.map(e=>e.toMathML(t)).join("")}toVoice(t={}){return this.items.map(e=>e.toVoice(t)).join(" ")}collapse(){return Rs(this.items).collapse()}};function Ds(t,e){if(e===2)return new pl(t);if(!(!t||!e)){if(e===1&&t.length>1)return new So;if(e===3){if(isNaN(+t))throw _.invalidExpression();return new Ce(+t)}if(e===4)return t in $e?new Ns($e[t]):t in ie?new rt(ie[t]):new Ns(t);if(e===5)return t in ie?new rt(ie[t]):new rt(t)}}function wl(t){let e=[],i="",s=0;for(let r of t){if(r==='"'){let a=s===2?0:2,h=Ds(i,s);h&&e.push(h),i="",s=a;continue}else if(s===2){i+=r;continue}let o=r.match(/[0-9.]/)?3:hl.includes(r)?4:ul.includes(r)?5:r.match(/\s/)?1:0;if(!o)throw _.invalidCharacter(r);if(!s||s===3&&o!==3||s===4&&o!==4&&o!==3||s===5&&!(i+r in ie)||s===1&&o!==1){let a=Ds(i,s);a&&e.push(a),i="",s=o}i+=r}let n=Ds(i,s);return n&&e.push(n),e}function yl(t){return t.length>1?new fi(t):t[0]instanceof rt?new fi(t):t[0]}function bl(t,e){let i=[[]];for(let s of t)e(s)?i.push([]):nt(i).push(s);return i}function N(t,e){return t instanceof rt&&ee(e).includes(t.o)}function Ee(t){return t instanceof F&&t.fn==="("?t.args[0]:t}function di(t,e){if(N(t[0],e))throw _.startOperator(t[0]);if(N(nt(t),e))throw _.endOperator(nt(t));for(let i=1;i<t.length-1;++i){if(!N(t[i],e))continue;let s=t[i],n=t[i-1],r=t[i+1];if(n instanceof rt)throw _.consecutiveOperators(n.o,s.o);if(r instanceof rt)throw _.consecutiveOperators(s.o,r.o);let o=t[i+2];if(e==="^ _"&&N(s,"_ ^")&&N(o,"_ ^")&&s.o!==o.o){let a=t[i+3];if(a instanceof rt)throw _.consecutiveOperators(o.o,a.o);let h=[Ee(n),Ee(r),Ee(a)];s.o==="^"&&([h[1],h[2]]=[h[2],h[1]]),t.splice(i-1,5,new F("subsup",h)),i-=4}else{let a=fl[s.o]||s.o,h=[Ee(n),Ee(r)];t.splice(i-1,3,new F(a,h)),i-=2}}}function Oo(t){return di(t,"^ _"),di(t,"/"),yl(t)}function xl(t,e){let i=[[]],s=["\u03C0",...(e==null?void 0:e.variables)||[]];for(let n of t){let r=nt(i).length?nt(i)[0].o:void 0;if(N(n,") ] }")){if(!N(n,Os[r]))throw _.conflictingBrackets(n.o);let o=i.pop(),a=nt(i),h=nt(a),p=N(n,")")&&h instanceof Ns&&!s.includes(h.i)?a.pop().i:o[0].o,f=bl(o.slice(1),d=>N(d,","));a.push(new F(p,f.map(Oo)))}else N(n,"( [ {")?i.push([n]):nt(i).push(n)}if(i.length>1)throw _.unclosedBracket(nt(i)[0].o);return Oo(i[0])}function Lo(t,e,i=!1){let s=[],n=[],r=!1;function o(){if(r)throw _.invalidExpression();!n.length||(s.push(n.length>1?new F(e[0],n):n[0]),n=[])}for(let a of t)if(N(a,e)){if(r||!n.length)throw _.invalidExpression();r=!0}else if(a instanceof rt)o(),s.push(a),r=!1;else{let h=!i||a instanceof Ce;if(n.length&&!r&&h)throw _.invalidExpression();n.push(a),r=!1}return o(),s}function Rs(t){if(t=t.filter(i=>!(i instanceof So)),!t.length)throw _.invalidExpression();let e=t.findIndex(i=>N(i,"= < > \u2264 \u2265"));if(e===0)throw _.startOperator(t[0]);if(e===t.length-1)throw _.endOperator(t[0]);if(e>0){let i=Rs(t.slice(0,e)),s=Rs(t.slice(e+1));return new F(t[e].o,[i,s])}if(N(t[0],"%!"))throw _.startOperator(t[0]);for(let i=0;i<t.length;++i)!N(t[i],"%!")||(t.splice(i-1,2,new F(t[i].o,[t[i-1]])),i-=1);di(t,"// \xF7");for(let i=1;i<t.length;++i){let s=t[i];if(s instanceof F&&s.fn==="/"){let n=t[i-1];if(n instanceof Ce)t.splice(i-1,2,new F("+",[n,s])),i-=1;else if(!(n instanceof rt))throw _.consecutiveOperators(n.toString(),s.toString())}}if(t=Lo(t,"\xD7 * \xB7",!0),N(t[0],"\u2212 \xB1")&&t.splice(0,2,new F(t[0].o,[t[1]])),di(t,"\u2212 \xB1"),N(t[0],"+")&&(t=t.slice(1)),t=Lo(t,"+"),t.length>1)throw _.invalidExpression();return t[0]}function $l(t,e=!1,i){let s=xl(wl(t),i);return e?s.collapse():s}function Ml(t,e){try{let i=Vt([...t.variables,...e.variables]),s=t.collapse(),n=e.collapse(),r=0;for(let o=0;o<5;++o){let a={};for(let p of i)a[p]=Is[p]||Math.random()*5;let h=s.evaluate(a),c=n.evaluate(a);if(!(isNaN(h)||isNaN(c))){if(!ri(h,c))return!1;r+=1}}return!!r}catch(i){return!1}}var hi={numEquals:Ml,parse:to($l)};var Vo='<div class="toasts"><div class="msg-wrap"><button class="msg archie" aria-label="Virtual Tutor"><slot name="icon"></slot></button></div></div><div class="chat" data-display="flex"><div class="chat-header"><slot name="header"></slot><button class="close"><x-icon name="close" size="24"></x-icon></button></div><div class="chat-body"></div><div class="chat-footer"><div class="input" contenteditable></div><button class="hint"><x-icon name="lightbulb" size="24"></x-icon></button></div></div>';var Cl=/[0-9+\-*/()^\s]+/g,El=Mt(j.shuffle(["happy","spongebob","sloth","party","robot","excited","cute","highfive1","applause","highfive2"])),Sl=Mt(j.shuffle(["minions","panther","dog","snape","what","door","horrible"]));function Fs(t,e,i={}){let s=S("div",{class:"msg-wrap","data-display":"flex"}),n=S("div",{class:"msg "+e},s);return i.class&&n.addClass(i.class),i.visible||s.hide(),D(e,"hint","question")?n.html=t:e==="img"?n.css("background-image",`url(${t})`):e==="video"&&S("iframe",{src:t,allowfullscreen:!0},n),s}var Hs=class extends M{constructor(){super(...arguments);this.recentMessages=[];this.isOpen=!1;this.queuePromise=Promise.resolve()}ready(){var n;this.$course=this.parents("x-course")[0],this.hints=this.$course?JSON.parse(this.$course.$("#hints").text):{};let e=window.user;this.correct=Mt(j.shuffle(this.hints.correct||[])),this.incorrect=Mt(j.shuffle(this.hints.incorrect||[])),this.$toasts=this.$(".toasts"),this.$chat=this.$(".chat"),this.$chatBody=this.$(".chat-body"),this.$toasts.on("click",r=>{r.handled||this.open()}),this.$(".close").on("click",()=>this.close());let i=this.$(".chat-footer");if(this.$query=i.$(".input"),this.$query.onKeyDown("enter",r=>{r.preventDefault(),this.askQuestion(this.$query.text.trim()),this.$query.text=""}),this.$query.on("focus",()=>i.addClass("focus")),this.$query.on("blur",()=>i.removeClass("focus")),this.$(".hint").on("click",()=>{this.queue(this.hints.tutorial1),this.queue(e?this.hints.tutorial2:this.hints.account)}),this.$course&&((n=this.$course.userData)==null?void 0:n.messages))for(let r of this.$course.userData.messages)this.$chatBody.append(Fs(r.content,r.kind||"hint",{visible:!0}));if(!m.getCookie("sessionWelcome")&&this.$course){m.setCookie("sessionWelcome",1,60*60*4);let r=new Date().getHours(),o=r<12?"Morning":r<18?"Afternoon":"Evening";e?setTimeout(()=>this.showHint(`welcome${o}Named`,{variables:{name:e.shortName}}),3e3):m.getCookie("welcome")?(setTimeout(()=>this.showHint(`welcome${o}`),3e3),setTimeout(()=>this.queue(this.hints.account),4500)):(m.setCookie("welcome",1),setTimeout(()=>this.queue(this.hints.welcome),3e3),setTimeout(()=>this.queue(this.hints.tutorial1),4500))}}open(){this.isOpen||(this.isOpen=!0,this.$chat.enter("slide-up",200),this.$chatBody.scrollTop=this.$chatBody.scrollHeight,this.trigger("open"))}close(){!this.isOpen||(this.isOpen=!1,this.$query.blur(),this.trigger("close"),this.$chat.exit("slide-down",200))}queue(e,i="hint",s={}){this.queuePromise=this.queuePromise.then(()=>(this.display(e,i,s),Js(500)))}display(e,i="hint",s={}){let n=s.timeout||8e3;if(m.width<640&&(n*=.7),(s.toast==null?!0:s.toast)&&!this.isOpen){let a=Fs(e,i,s);a.setAttr("role","alert"),this.$toasts.append(a),a.enter("reveal-right"),setTimeout(()=>a.exit("reveal-right",400,0,!0),n),this.on("open",()=>a.exit("reveal",200,0,!0))}let o=Fs(e,i,{class:s.class,visible:!this.isOpen});this.$chatBody.append(o),this.isOpen&&(o.enter("reveal",300),ht(()=>this.$chatBody.scrollTop=this.$chatBody.scrollHeight,200))}showHint(e,i={}){if(D(e,"correct","incorrect")){let n=e==="correct"?this.correct():this.incorrect(),r=e==="correct"?3e3:5e3;if(this.queue(n,"hint",{class:i.class||e,timeout:r}),Math.random()<.2){let o=e==="correct"?El():Sl(),a="";this.queue(`${a}/images/gifs/${o}.gif`,"img",{timeout:r})}return{text:n}}let s=this.hints[e]||e;if(i.variables)for(let[n,r]of Object.entries(i.variables))s=s.replace(new RegExp("\\$"+n,"g"),r);return!i.force&&this.recentMessages.includes(e)?{text:s}:(this.recentMessages.push(e),setTimeout(()=>this.recentMessages.shift(),1e4),i.store!==!1&&this.$course&&this.$course.saveProgress({hints:[{content:s,kind:"hint"}]}),this.queue(s,"hint",{class:i.class}),{text:s})}askQuestion(e){if(!e)return;this.queue(e,"question"),this.$course&&this.$course.log("Tutor","ask",e);let i=(e.match(Cl)||[]).filter(s=>s.length>=3&&!s.match(/^[\s0-9]+$/));if(i.length)try{let s=hi.parse(i[0],!0),n=hi.parse("="+s.evaluate());return this.queue(`<span class="math">${s.toMathML()}${n.toMathML()}</span>`)}catch(s){console.log("Parse Error:",i[0])}this.$chatBody.addClass("loading"),le(this.attr("api"),{query:e}).then(s=>{this.$chatBody.removeClass("loading");let n=JSON.parse(s);for(let r of n)this.queue(r.content,r.kind)}).catch(s=>{this.$chatBody.removeClass("loading"),this.queue(this.hints.serverError),console.error("Tutor Error:",s)})}};Hs=E([$("x-tutor",{template:Vo})],Hs);var No='<div class="left" tabindex="0"><x-icon name="left" size="14"></x-icon></div><div class="content"><slot></slot></div><div class="right" tabindex="0"><x-icon name="right" size="14"></x-icon></div><div class="bubble"><div class="bubble-box"><div class="progress"></div></div><div class="bubble-arrow"></div></div>';var Bo=S("div",{class:"var-overlay"},P),Ws=class extends M{constructor(){super(...arguments);this.valueChange=!1}ready(){let e=this.attr("bind");if(!e)return;let[i,s,n]=e.split("|");[this.min,this.max,this.step]=n.split(",").map(h=>+h),this.name=i,this.model=this.getParentModel(),this.$(".content").bindModel(this.model),this.$progress=this.$(".progress"),this.setValue(+s);let r=20*(m.isMobile?1.5:1)/q((this.max-this.min)/this.step/12,1,3),o=0,a=0;for(let h of this.$$(".left, .right")){let c=h.hasClass("left")?-this.step:this.step;h.on("click",()=>{this.setValue(this.value+c),this.trigger("slide-end")})}de(this,{start:h=>{o=h.x,a=this.value,this.addClass("on"),this.valueChange=!1,Bo.show(),G.addClass("grabbing")},move:h=>{let c=(h.x-o)/r;this.setValue(a+ki(c)*this.step)},end:()=>{this.removeClass("on"),this.valueChange&&this.trigger("slide-end"),Bo.hide(),G.removeClass("grabbing")}})}setup(e,i){this.one("slide-end",()=>e.score(i))}setValue(e){let i=ki(q(e,this.min,this.max),2);if(i===this.value)return;this.value=i,this.valueChange=!0,this.model&&(this.model[this.name]=i);let s=this.max-this.min;this.$progress.css("width",116*(i-this.min)/s+"px")}};Ws=E([$("x-var",{template:No})],Ws);var qo='<button class="play-btn-box" aria-label="Play"><x-icon name="play" size="44"></x-icon></button>';var Us=class extends M{constructor(){super(...arguments);this.visible=!0}ready(){this.on("click",()=>{this.play(),setTimeout(()=>this.trigger("play"),400)})}play(){!this.visible||(this.visible=!1,this.exit("pop",400))}reset(){this.visible||(this.visible=!0,setTimeout(()=>this.enter("pop"),400))}};Us=E([$("x-play-btn",{template:qo})],Us);var zs=class extends M{constructor(){super(...arguments);this.playing=!1}ready(){this.$icon=this.$("x-icon"),this.$("button").on("click",()=>this.toggle())}toggle(){this.playing?this.pause():this.play()}play(){this.playing||(this.playing=!0,this.$icon.setAttr("name","pause"),this.trigger("play"))}pause(){!this.playing||(this.playing=!1,this.$icon.setAttr("name","play"),this.trigger("pause"))}};zs=E([$("x-play-toggle",{template:'<button class="icon-btn"><x-icon name="play"></x-icon></button>'})],zs);var Ro='<div class="video-wrap"><video preload playsinline></video></div><div class="credit"></div><x-play-btn></x-play-btn><div class="controls"><div class="shadow"></div><div class="play-pause-btn"><div class="play-icon" tabindex="0" aria-label="Play Video"><x-icon name="play" size="32"></x-icon></div><div class="pause-icon" aria-label="Pause Video"><x-icon name="pause" size="32"></x-icon></div></div><div class="timeline"><div class="bar"><div class="background"></div><div class="buffer"></div><div class="progress"></div></div><div class="handle"></div></div><div class="timecode"></div></div>';function Do(t){let e=Math.floor(t/60),i=Math.floor(t%60);return e+":"+(i<10?"0":"")+i}var js=class extends M{ready(){let e=this.attr("src"),i=this.$(".video-wrap"),s=this.$("video"),n=this.attr("width"),r=this.attr("height");this.css("width",n+"px"),i.css("padding-bottom",+r/+n*100+"%"),s.setAttr("poster",this.attr("poster")||e.replace(/mp4$/,"jpg")),this.hasAttr("loop")&&(s._el.loop=!0),this.hasAttr("audio")||(s._el.muted=!0),S("source",{src:e,type:"video/mp4"},s),this.hasAttr("credit")&&(this.$(".credit").text=this.attr("credit"));let o=this.$(".bar"),a=this.$(".progress"),h=this.$(".buffer"),c=this.$(".timecode"),p=new Gt(this.$(".handle"),{$parent:o,moveY:!1}),f=this.video=s._el,d=this.width-110;m.onResize(()=>d=this.width-110),s.on("canplay",()=>{c.text=Do(+f.duration)}),s.on("timeupdate",()=>{let l=f.currentTime/f.duration;a.css("width",l*100+"%"),c.text=Do(+f.currentTime),p.setPosition(l*d,0),this.trigger("timeupdate",f.currentTime)}),s.on("progress",()=>{if(f.buffered.length<=0||f.duration<=0)return;let g=f.buffered.end(f.buffered.length-1)/f.duration*100;h.css("width",g+"%")}),s.on("ended",()=>{f.pause(),this.removeClass("playing"),this.trigger("end")});let x=()=>f.paused?this.play():this.pause(),A=l=>this.setTime(l/d*f.duration);this.hasAttr("hover")?(s.on("mouseover touchstart",()=>this.play()),s.on("mouseout touchend touchcancel",()=>this.pause())):s.on("click",x),this.hasAttr("controls")&&(this.$(".controls").show(),this.$(".play-pause-btn").on("click",x),p.on("start",()=>this.pause()),p.on("drag",({posn:l})=>A(l.x)),o.on("click",l=>A(l.offsetX)))}setTime(e){this.video.currentTime=e}play(){this.video.play(),this.addClass("playing"),this.trigger("play")}pause(){this.video.pause(),this.removeClass("playing")}};js=E([$("x-video",{template:Ro})],js);var Xs=class extends M{constructor(){super(...arguments);this.isCompleted=!1;this.isReady=!1}created(){this.userData=window.progressData||JSON.parse(this.$("#userdata").text)||{},this.$steps=this.$$("x-step");for(let e of this.$steps)e.on("score",()=>this.trigger("score"));this.data.audio&&(this.audio=new Ui(this.data.audio))}ready(){this.$footer=this.$("footer"),this.$skipStep=this.$footer.$(".skip-step"),this.$progress=this.$(".sidebar-row.active x-progress"),this.$tutor=this.$("x-tutor"),this.$stepsWrap=this.$(".steps");let e=this.findStep(m.getHash()),i=this.findStep(this.userData.activeStep);this.$activeStep=i||this.$steps[0];for(let n of this.$steps){if(n.show(),n===this.$activeStep)break;n.complete()}if(this.userData.completed||m.getHash()==="full"||this.data.reveal)this.complete();else for(;this.$activeStep&&this.$activeStep.isReady&&!this.isCompleted;)this.nextStep();(e||i&&!this.userData.completed)&&this.goToStep(e||i,!1),this.$(".section-dev")&&this.complete();let s=this.$(".reveal-banner");setTimeout(()=>{this.isCompleted||(s.removeClass("off"),this.on("score complete",()=>s.addClass("off")))},1500),s.$(".complete").one("click",()=>this.complete()),m.onKey("space",n=>{n.preventDefault(),this.nextStep(),s.addClass("off")}),this.$footer.$(".skip").on("click",()=>this.nextStep()),this.$footer.$(".show-all").on("click",()=>this.complete()),this.$footer.show(),this.isReady=!0,setTimeout(()=>this.addClass("ready"))}nextStep(){if(this.isCompleted)return;let e=this.$activeStep,i=this.$stepsWrap.height;do{if(e.complete(),e=this.$steps[this.$steps.indexOf(e)+1],!e)return this.complete(!0);e.show()}while(e.isReady);this.$stepsWrap.animate({height:[i+"px","auto"]},800),this.$activeStep=e,this.saveProgress({activeStep:e.id})}goToStep(e,i=!0){let s=this.$stepsWrap.height;for(let o of this.$steps){if(o.isShown||(this.$activeStep=o),o.show(),e.isShown&&!o.isReady)break;o.complete()}let n=e.positionTop-Math.max(50,(m.height-e.height)/2);i?(this.$stepsWrap.animate({height:[s+"px","auto"]},800),P.scrollTo(n)):P.scrollTop=n;let r=z(this.$steps);if(r.isShown&&r.isReady)return this.complete();this.$activeStep&&this.saveProgress({activeStep:this.$activeStep.id})}complete(e=!1){if(this.isCompleted)return;this.isCompleted=!0,this.$steps.forEach(s=>s.complete()),this.$activeStep=void 0;let i=this.$footer.$(".next-section");e?(this.$skipStep.exit("fade",200),i&&i.enter("pop")):(this.$skipStep.hide(),i&&i.show()),this.trigger("complete"),this.saveProgress({completed:!0}),this.log("Course","complete")}findStep(e){for(let i of this.$steps)if(i.id===e)return i}saveProgress(e){if(!this.isReady)return;let s=H(this.$steps.map(n=>n.scores.size))/+this.data.goals||0;this.$progress.setProgress(s),qn(`/course/${this.id}/${this.data.section}`,e)}log(e,i,s){if(window.ga&&this.isReady){let n=i+(s?":"+s:"");window.ga("send","event",e,n,this.id)}}};Xs=E([$("x-course")],Xs);})();